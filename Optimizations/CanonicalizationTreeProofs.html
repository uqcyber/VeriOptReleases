<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory CanonicalizationTreeProofs</title>
</head>


<body>
<div class="head">
<h1>Theory CanonicalizationTreeProofs</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Canonicalization Phase</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>CanonicalizationTreeProofs</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span>
    </span><a href="CanonicalizationTree.html"><span>CanonicalizationTree</span></a><span>
    </span><a href="../Proofs/StampEvalThms.html"><span>Proofs.StampEvalThms</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.neutral_rewrite_helper|fact"><span class="entity_def" id="CanonicalizationTreeProofs.neutral_rewrite_helper|thm"><span>neutral_rewrite_helper</span></span></span><span class="main"><span>:</span></span><span>
      </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟶</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_mul|const"><span>intval_mul</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_add|const"><span>intval_add</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_xor|const"><span>intval_xor</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_or|const"><span>intval_or</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Proofs/StampEvalThms.html#StampEvalThms.valid_int_stamp_gives|fact"><span>valid_int_stamp_gives</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.annihilator_rewrite_helper|fact"><span class="entity_def" id="CanonicalizationTreeProofs.annihilator_rewrite_helper(2)|thm"><span class="entity_def" id="CanonicalizationTreeProofs.annihilator_rewrite_helper(1)|thm"><span>annihilator_rewrite_helper</span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_mul|const"><span>intval_mul</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_and|const"><span>intval_and</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Proofs/StampEvalThms.html#StampEvalThms.valid_int_stamp_gives|fact"><span>valid_int_stamp_gives</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>The -1 annihilator of OR is a bit harder to prove, because the upper bits are zeroed.</span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.annihilator_rewrite_helper2|fact"><span class="entity_def" id="CanonicalizationTreeProofs.annihilator_rewrite_helper2|thm"><span>annihilator_rewrite_helper2</span></span></span><span class="main"><span>:</span></span><span>
     </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_or|const"><span>intval_or</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.neg_one|const"><span>neg_one</span></a><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.neg_one|const"><span>neg_one</span></a><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Proofs/StampEvalThms.html#StampEvalThms.valid_int_stamp_gives|fact"><span>valid_int_stamp_gives</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_or.simps|fact"><span>intval_or.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.neg_one.simps|fact"><span>neg_one.simps</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.neg_one_value|fact"><span>neg_one_value</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int_bin.simps|fact"><span>new_int_bin.simps</span></a><span> </span><span>take_bit_eq_mask</span><span> </span><span>word_ao_absorbs</span><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>



</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.idempotent_rewrite_helper|fact"><span class="entity_def" id="CanonicalizationTreeProofs.idempotent_rewrite_helper(2)|thm"><span class="entity_def" id="CanonicalizationTreeProofs.idempotent_rewrite_helper(1)|thm"><span>idempotent_rewrite_helper</span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_and|const"><span>intval_and</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_or|const"><span>intval_or</span></a><span>  </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Proofs/StampEvalThms.html#StampEvalThms.valid_int_stamp_gives|fact"><span>valid_int_stamp_gives</span></a><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>value</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>size</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span class="main"><span>::</span></span><span class="numeral"><span>32</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>experiment</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1502..1507">lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961352.CanonicalizeBinaryProof|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961352.CanonicalizeBinaryProof|thm"><span>CanonicalizeBinaryProof</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeBinaryOp|const"><span>CanonicalizeBinaryOp</span></a><span> </span><span class="free"><span>before</span></span><span> </span><span class="free"><span>after</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>before</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>after</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_1502..1507"><span>assms</span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeBinaryOp.induct|fact"><span>CanonicalizeBinaryOp.induct</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>binary_const_fold</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>val1</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>val2</span></span><span> </span><span class="skolem"><span>val</span></span><span> </span><span class="skolem"><span>op</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_1818..1838">binary_fold_yneutral</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="skolem"><span>op</span></span><span> </span><span class="skolem"><span>stampx</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>stampy</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xval</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_1883..1889">x_eval</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>xval</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_1818..1838"><span>binary_fold_yneutral.prems</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval|const"><span>bin_eval</span></a><span> </span><span class="skolem"><span>op</span></span><span> </span><span class="skolem"><span>xval</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>xval</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#CanonicalizationTreeProofs.neutral_rewrite_helper|fact"><span>neutral_rewrite_helper</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_1818..1838"><span>binary_fold_yneutral.hyps</span></a><span class="main"><span>(</span></span><span>2-3</span><span class="main"><span>,</span></span><span>6-</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.is_IntegerStamp_def|fact"><span>is_IntegerStamp_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>by (metis ConstantExpr Value.distinct(5) valid_value.simps(34))</span><span>*</span><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_1818..1838"><span>binary_fold_yneutral.hyps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_1818..1838"><span>binary_fold_yneutral.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_1818..1838"><span>binary_fold_yneutral.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_1883..1889"><span>x_eval</span></a><span>
          </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.BinaryExprE|fact"><span>BinaryExprE</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.ConstantExprE|fact"><span>ConstantExprE</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_2350..2369">binary_fold_yzero32</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="skolem"><span>op</span></span><span> </span><span class="skolem"><span>stampx</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>stampy</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xval</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_2414..2420">x_eval</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>xval</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_2350..2369"><span>binary_fold_yzero32.prems</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval|const"><span>bin_eval</span></a><span> </span><span class="skolem"><span>op</span></span><span> </span><span class="skolem"><span>xval</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>c</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#CanonicalizationTreeProofs.annihilator_rewrite_helper|fact"><span>annihilator_rewrite_helper</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_2350..2369"><span>binary_fold_yzero32.hyps</span></a><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.is_IntegerStamp_def|fact"><span>is_IntegerStamp_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.BinaryExprE|fact"><span>BinaryExprE</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.ConstantExprE|fact"><span>ConstantExprE</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_2350..2369"><span>binary_fold_yzero32.hyps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_2350..2369"><span>binary_fold_yzero32.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_2350..2369"><span>binary_fold_yzero32.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_2414..2420"><span>x_eval</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_2792..2811">binary_fold_yzero64</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="skolem"><span>op</span></span><span> </span><span class="skolem"><span>stampx</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>stampy</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xval</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_2856..2862">x_eval</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>xval</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_2792..2811"><span>binary_fold_yzero64.prems</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval|const"><span>bin_eval</span></a><span> </span><span class="skolem"><span>op</span></span><span> </span><span class="skolem"><span>xval</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>c</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#CanonicalizationTreeProofs.annihilator_rewrite_helper|fact"><span>annihilator_rewrite_helper</span></a><span>
    </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.BinaryExprE|fact"><span>BinaryExprE</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.ConstantExprE|fact"><span>ConstantExprE</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_2792..2811"><span>binary_fold_yzero64.hyps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> 
        </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_2792..2811"><span>binary_fold_yzero64.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_2792..2811"><span>binary_fold_yzero64.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_2856..2862"><span>x_eval</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_3198..3215">binary_idempotent</span><span> </span><span class="skolem"><span>op</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xval</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_3242..3248">x_eval</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>xval</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_3198..3215"><span>binary_idempotent.prems</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval|const"><span>bin_eval</span></a><span> </span><span class="skolem"><span>op</span></span><span> </span><span class="skolem"><span>xval</span></span><span> </span><span class="skolem"><span>xval</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>xval</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#CanonicalizationTreeProofs.idempotent_rewrite_helper|fact"><span>idempotent_rewrite_helper</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_3198..3215"><span>binary_idempotent.hyps</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.BinaryExprE|fact"><span>BinaryExprE</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_3198..3215"><span>binary_idempotent.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_3198..3215"><span>binary_idempotent.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_3242..3248"><span>x_eval</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3552..3557">lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.CanonicalizeUnaryProof|fact"><span class="entity_def" id="CanonicalizationTreeProofs.CanonicalizeUnaryProof|thm"><span>CanonicalizeUnaryProof</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeUnaryOp|const"><span>CanonicalizeUnaryOp</span></a><span> </span><span class="free"><span>before</span></span><span> </span><span class="free"><span>after</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>before</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>after</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_3552..3557"><span>assms</span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeUnaryOp.induct|fact"><span>CanonicalizeUnaryOp.induct</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>unary_const_fold</span><span> </span><span class="skolem"><span>val'</span></span><span> </span><span class="skolem"><span>op</span></span><span> </span><span class="skolem"><span>val</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.mul_rewrite_helper|fact"><span class="entity_def" id="CanonicalizationTreeProofs.mul_rewrite_helper|thm"><span>mul_rewrite_helper</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>64</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_mul|const"><span>intval_mul</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="numeral"><span>64</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_negate|const"><span>intval_negate</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Proofs/StampEvalThms.html#StampEvalThms.valid_int_stamp_gives|fact"><span>valid_int_stamp_gives</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>As usual, the general case is harder to prove, because upper bits are zeroed.</span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.mul_rewrite_helper32|fact"><span class="entity_def" id="CanonicalizationTreeProofs.mul_rewrite_helper32|thm"><span>mul_rewrite_helper32</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_mul|const"><span>intval_mul</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.neg_one|const"><span>neg_one</span></a><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_negate|const"><span>intval_negate</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Proofs/StampEvalThms.html#StampEvalThms.valid_int_stamp_gives|fact"><span>valid_int_stamp_gives</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_threshold</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_mul.simps|fact"><span>intval_mul.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_negate.simps|fact"><span>intval_negate.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>mult_minus1_right</span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.neg_one.simps|fact"><span>neg_one.simps</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int.simps|fact"><span>new_int.simps</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int_bin.simps|fact"><span>new_int_bin.simps</span></a><span> </span><span>take_bit_minus_one_eq_mask</span><span> </span><span>take_bit_mult</span><span> </span><span>take_bit_of_int</span><span> </span><span>unsigned_take_bit_eq</span><span> </span><span>word_mult_def</span><span class="main"><span>)</span></span><span> 

</span><span class="comment1"><span>(</span><span>*</span><span> or a more manual proof:
lemma mul_rewrite_helper32:
  shows "valid_value x (IntegerStamp b lo hi) ⟹ intval_mul x (new_int b (-1)) = intval_negate x" 
proof -
  assume v: "valid_value x (IntegerStamp b lo hi)"
  then obtain ix where ix: "x = IntVal b ix"
    by (metis valid_int_stamp_gives)
  then show "intval_mul x (new_int b (-1)) = intval_negate x"
    unfolding ix intval_mul.simps new_int_bin.simps new_int.simps
    by (simp; smt (verit, ccfv_threshold) ix mult_minus1_right of_int_mult take_bit_minus_one_eq_mask take_bit_mult take_bit_of_int uint_take_bit_eq v valid_int_fits word_of_int_uint)
qed
</span><span>*</span><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span>experiment</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5132..5137">lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961654.CanonicalizeMulProof|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961654.CanonicalizeMulProof|thm"><span>CanonicalizeMulProof</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeMul|const"><span>CanonicalizeMul</span></a><span> </span><span class="free"><span>before</span></span><span> </span><span class="free"><span>after</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>before</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>after</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_5132..5137"><span>assms</span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeMul.induct|fact"><span>CanonicalizeMul.induct</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.ConstantExprE|fact"><span>ConstantExprE</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.BinaryExprE|fact"><span>BinaryExprE</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval.simps|fact"><span>bin_eval.simps</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#CanonicalizationTreeProofs.mul_rewrite_helper|fact"><span>mul_rewrite_helper</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5462..5467">lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.valid_int_stamp_both|fact"><span class="entity_def" id="CanonicalizationTreeProofs.valid_int_stamp_both|thm"><span>valid_int_stamp_both</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lox</span></span><span> </span><span class="free"><span>hix</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>     </span><span>2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>loy</span></span><span> </span><span class="free"><span>hiy</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>obtains</span></span></span><span> </span><span class="free"><span>ix</span></span><span> </span><span class="free"><span>iy</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>ix</span></span><span>"</span></span></span><span>
     </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>take_bit</span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>ix</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>ix</span></span><span>"</span></span></span><span>
     </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>iy</span></span><span>"</span></span></span><span>
     </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>take_bit</span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>iy</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>iy</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_5462..5467"><span>assms</span></a><span> </span><a class="entity_ref" href="../Proofs/StampEvalThms.html#StampEvalThms.valid_int_stamp_gives|fact"><span>valid_int_stamp_gives</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>


</span><span class="comment1"><span>(</span><span>*</span><span> (x - y) + y ⇒ x </span><span>*</span><span>)</span></span><span>
</span><span class="comment1"><span>(</span><span>*</span><span>  x + (y - x) ⇒ y </span><span>*</span><span>)</span></span><span>
</span><span class="comment1"><span>(</span><span>*</span><span> (-x + y) ⇒ (y - x) </span><span>*</span><span>)</span></span><span>
</span><span class="comment1"><span>(</span><span>*</span><span> (x + (-y)) ⇒ (x - y) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.add_rewrites_helper|fact"><span class="entity_def" id="CanonicalizationTreeProofs.add_rewrites_helper|thm"><span>add_rewrites_helper</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_5906..5907">1</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lox</span></span><span> </span><span class="free"><span>hix</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>     </span><span class="entity_def" id="offset_5959..5960">2</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>loy</span></span><span> </span><span class="free"><span>hiy</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_add|const"><span>intval_add</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>∧</span></span><span>
         </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_add|const"><span>intval_add</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>∧</span></span><span>
         </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_add|const"><span>intval_add</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_negate|const"><span>intval_negate</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>∧</span></span><span>
         </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_add|const"><span>intval_add</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_negate|const"><span>intval_negate</span></a><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#CanonicalizationTreeProofs.valid_int_stamp_both|fact"><span>valid_int_stamp_both</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_5906..5907"><span>1</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_5959..5960"><span>2</span></a><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span> 



</span><span class="keyword1"><span class="command"><span>experiment</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6282..6287">lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.CanonicalizeAddProof|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.CanonicalizeAddProof|thm"><span>CanonicalizeAddProof</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeAdd|const"><span>CanonicalizeAdd</span></a><span> </span><span class="free"><span>before</span></span><span> </span><span class="free"><span>after</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>before</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>after</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_6282..6287"><span>assms</span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeAdd.induct|fact"><span>CanonicalizeAdd.induct</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>add_xsub</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>stampa</span></span><span> </span><span class="skolem"><span>stampy</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.BinaryExprE|fact"><span>BinaryExprE</span></a><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.collapse|fact"><span>Stamp.collapse</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval.simps|fact"><span>bin_eval.simps</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval.simps|fact"><span>bin_eval.simps</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> 
        </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_add_sym|fact"><span>intval_add_sym</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#CanonicalizationTreeProofs.add_rewrites_helper|fact"><span>add_rewrites_helper</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>add_ysub</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>stampa</span></span><span> </span><span class="skolem"><span>stampx</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (metis is_IntegerStamp_def add_ysub.hyps add_ysub.prems evalDet BinaryExprE Stamp.sel(1) 
        bin_eval.simps(1) bin_eval.simps(3) stamp_implies_valid_value intval_add_sym add_rewrites_helper(2))</span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>add_xnegate</span><span> </span><span class="skolem"><span>nx</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>stampx</span></span><span> </span><span class="skolem"><span>stampy</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (smt (verit, del_insts) BinaryExprE Stamp.sel(1) UnaryExprE add_rewrites_helper(4) 
        bin_eval.simps(1) bin_eval.simps(3) evalDet stamp_implies_valid_value intval_add_sym is_IntegerStamp_def unary_eval.simps(2)) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>add_ynegate</span><span> </span><span class="skolem"><span>ny</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>stampx</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>stampy</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (smt (verit) BinaryExprE Stamp.sel(1) UnaryExprE add_rewrites_helper(4) bin_eval.simps(1) 
        bin_eval.simps(3) evalDet stamp_implies_valid_value is_IntegerStamp_def unary_eval.simps(2)) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span> (x + y) - y ⇒ x </span><span>*</span><span>)</span></span><span>
</span><span class="comment1"><span>(</span><span>*</span><span> (x + y) - x ⇒ y </span><span>*</span><span>)</span></span><span>
</span><span class="comment1"><span>(</span><span>*</span><span> (x - y) - x ⇒ (-y) </span><span>*</span><span>)</span></span><span>
</span><span class="comment1"><span>(</span><span>*</span><span> x - (x + y) ⇒ (-y) </span><span>*</span><span>)</span></span><span>
</span><span class="comment1"><span>(</span><span>*</span><span> y - (x + y) ⇒ (-x) </span><span>*</span><span>)</span></span><span>
</span><span class="comment1"><span>(</span><span>*</span><span> x - (x - y) ⇒ y </span><span>*</span><span>)</span></span><span>
</span><span class="comment1"><span>(</span><span>*</span><span> x - (-y) ⇒ x + y </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.sub_rewrites_helper|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.sub_rewrites_helper(7)|thm"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.sub_rewrites_helper(6)|thm"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.sub_rewrites_helper(5)|thm"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.sub_rewrites_helper(4)|thm"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.sub_rewrites_helper(3)|thm"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.sub_rewrites_helper(2)|thm"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.sub_rewrites_helper(1)|thm"><span>sub_rewrites_helper</span></span></span></span></span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_7758..7759">1</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lox</span></span><span> </span><span class="free"><span>hix</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>     </span><span class="entity_def" id="offset_7811..7812">2</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>loy</span></span><span> </span><span class="free"><span>hiy</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_add|const"><span>intval_add</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>y</span></span><span>  </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_add|const"><span>intval_add</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span>  </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span>  </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_negate|const"><span>intval_negate</span></a><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_add|const"><span>intval_add</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_negate|const"><span>intval_negate</span></a><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_add|const"><span>intval_add</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_negate|const"><span>intval_negate</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_negate|const"><span>intval_negate</span></a><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_add|const"><span>intval_add</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#CanonicalizationTreeProofs.valid_int_stamp_both|fact"><span>valid_int_stamp_both</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_7758..7759"><span>1</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_7811..7812"><span>2</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span> x - x ⇒ 0 </span><span>*</span><span>)</span></span><span>
</span><span class="comment1"><span>(</span><span>*</span><span> 0 - x ⇒ -x </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8313..8318">lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.sub_single_rewrites_helper|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.sub_single_rewrites_helper(2)|thm"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.sub_single_rewrites_helper(1)|thm"><span>sub_single_rewrites_helper</span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lox</span></span><span> </span><span class="free"><span>hix</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>     </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_negate|const"><span>intval_negate</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_8313..8318"><span>assms</span></a><span> </span><a class="entity_ref" href="../Proofs/StampEvalThms.html#StampEvalThms.valid_int_stamp_gives|fact"><span>valid_int_stamp_gives</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8547..8552">lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.CanonicalizeSubProof|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.CanonicalizeSubProof|thm"><span>CanonicalizeSubProof</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeSub|const"><span>CanonicalizeSub</span></a><span> </span><span class="free"><span>before</span></span><span> </span><span class="free"><span>after</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>before</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>after</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_8547..8552"><span>assms</span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeSub.induct|fact"><span>CanonicalizeSub.induct</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>sub_same64</span><span> </span><span class="skolem"><span>stampx</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>lo</span></span><span> </span><span class="skolem"><span>hi</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    using ConstantExprE BinaryExprE  bin_eval.simps evalDet sub_same64.prems sub_single_rewrites_helper 
      stamp_implies_valid_value sub_same64.hyps(1) sub_same64.hyps(2)
    by (auto; metis) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>sub_left_add1</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="skolem"><span>stampa</span></span><span> </span><span class="skolem"><span>stampb</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (metis BinaryExprE Stamp.collapse(1) bin_eval.simps(1) bin_eval.simps(3) evalDet 
        stamp_implies_valid_value sub_rewrites_helper(1)) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>sub_left_add2</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="skolem"><span>stampa</span></span><span> </span><span class="skolem"><span>stampb</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (metis BinaryExprE Stamp.collapse(1) bin_eval.simps(1) bin_eval.simps(3) evalDet 
        stamp_implies_valid_value sub_rewrites_helper(2)) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>sub_left_sub</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="skolem"><span>stampa</span></span><span> </span><span class="skolem"><span>stampb</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (smt (verit) BinaryExprE Stamp.sel(1) UnaryExprE bin_eval.simps(3) evalDet
        stamp_implies_valid_value is_IntegerStamp_def sub_rewrites_helper(3) unary_eval.simps(2)) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>sub_right_add1</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="skolem"><span>stampa</span></span><span> </span><span class="skolem"><span>stampb</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (smt (verit) BinaryExprE Stamp.sel(1) UnaryExprE bin_eval.simps(1) bin_eval.simps(3) evalDet
        stamp_implies_valid_value is_IntegerStamp_def sub_rewrites_helper(4) unary_eval.simps(2)) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>sub_right_add2</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="skolem"><span>stampa</span></span><span> </span><span class="skolem"><span>stampb</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (smt (verit) BinaryExprE Stamp.sel(1) UnaryExprE bin_eval.simps(1) bin_eval.simps(3) evalDet
        stamp_implies_valid_value is_IntegerStamp_def sub_rewrites_helper(5) unary_eval.simps(2)) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>sub_right_sub</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="skolem"><span>stampa</span></span><span> </span><span class="skolem"><span>stampb</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (metis BinaryExprE Stamp.sel(1) bin_eval.simps(3) evalDet
        stamp_implies_valid_value is_IntegerStamp_def sub_rewrites_helper(6)) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>sub_xzero64</span><span> </span><span class="skolem"><span>stampx</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>lo</span></span><span> </span><span class="skolem"><span>hi</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    using ConstantExprE BinaryExprE  bin_eval.simps evalDet sub_xzero64.prems sub_single_rewrites_helper 
      stamp_implies_valid_value sub_xzero64.hyps(1) sub_xzero64.hyps(2)
    by (auto; metis) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>sub_y_negate</span><span> </span><span class="skolem"><span>nb</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="skolem"><span>stampa</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>stampb</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (smt (verit, best) BinaryExprE Stamp.sel(1) UnaryExprE bin_eval.simps(1) bin_eval.simps(3) evalDet
        stamp_implies_valid_value is_IntegerStamp_def sub_rewrites_helper(7) unary_eval.simps(2)) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span> -(x-y) = (x-y) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11079..11084">lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.negate_xsuby_helper|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.negate_xsuby_helper|thm"><span>negate_xsuby_helper</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lox</span></span><span> </span><span class="free"><span>hix</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>loy</span></span><span> </span><span class="free"><span>hiy</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_negate|const"><span>intval_negate</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#CanonicalizationTreeProofs.valid_int_stamp_both|fact"><span>valid_int_stamp_both</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_11079..11084"><span>assms</span></a><span class="main"><span>]</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_threshold</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>ab_group_add_class.ab_diff_conv_add_uminus</span><span> </span><span>add.commute</span><span> </span><span>add_diff_cancel_left'</span><span> </span><span>diff_0</span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_negate.simps|fact"><span>intval_negate.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub.simps|fact"><span>intval_sub.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int.simps|fact"><span>new_int.simps</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int_bin.simps|fact"><span>new_int_bin.simps</span></a><span> </span><a class="entity_ref" href="../Graph/ValueThms.html#ValueThms.take_bit_dist_subR|fact"><span>take_bit_dist_subR</span></a><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span> -(-x) = x </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11532..11537">lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.negate_negate_helper|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.negate_negate_helper|thm"><span>negate_negate_helper</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lox</span></span><span> </span><span class="free"><span>hix</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_negate|const"><span>intval_negate</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_negate|const"><span>intval_negate</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Proofs/StampEvalThms.html#StampEvalThms.valid_int_stamp_gives|fact"><span>valid_int_stamp_gives</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> opaque_lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>add.inverse_inverse</span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_11532..11537"><span>assms</span></a><span> </span><span>diff_0</span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_negate.simps|fact"><span>intval_negate.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int.simps|fact"><span>new_int.simps</span></a><span> </span><a class="entity_ref" href="../Graph/ValueThms.html#ValueThms.take_bit_dist_subR|fact"><span>take_bit_dist_subR</span></a><span class="main"><span>)</span></span><span> 

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11819..11824">lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.CanonicalizeNegateProof|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26961924.CanonicalizeNegateProof|thm"><span>CanonicalizeNegateProof</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeNegate|const"><span>CanonicalizeNegate</span></a><span> </span><span class="free"><span>before</span></span><span> </span><span class="free"><span>after</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>before</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>after</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_11819..11824"><span>assms</span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeNegate.induct|fact"><span>CanonicalizeNegate.induct</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>negate_negate</span><span> </span><span class="skolem"><span>nx</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (metis UnaryExprE evalDet stamp_implies_valid_value is_IntegerStamp_def negate_negate_helper unary_eval.simps(2)) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>negate_sub</span><span> </span><span class="skolem"><span>e</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>stampx</span></span><span> </span><span class="skolem"><span>stampy</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (smt (verit) BinaryExprE Stamp.sel(1) UnaryExprE bin_eval.simps(3) evalDet stamp_implies_valid_value
        is_IntegerStamp_def negate_xsuby_helper unary_eval.simps(2)) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span> TODO: a better name for this? </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>experiment</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26962386.word_helper|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26962386.word_helper(4)|thm"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26962386.word_helper(3)|thm"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26962386.word_helper(2)|thm"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26962386.word_helper(1)|thm"><span class="entity_def" id="offset_12533..12544">word_helper</span></span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="numeral"><span>32</span></span><span> </span><span>word</span><span class="main"><span>.</span></span><span> </span><span class="main"><span>¬</span></span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>&lt;s</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>&lt;s</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>.</span></span><span> </span><span class="main"><span>¬</span></span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>&lt;s</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>&lt;s</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="numeral"><span>32</span></span><span> </span><span>word</span><span class="main"><span>.</span></span><span> </span><span class="main"><span>¬</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>&lt;s</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="main"><span>¬</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>&lt;s</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⋀</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>.</span></span><span> </span><span class="main"><span>¬</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>&lt;s</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="main"><span>¬</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>&lt;s</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>case_tac</span></span><span class="main"><span class="improper"><span>[</span></span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="improper"><span>]</span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="improper"><span class="improper"><span class="improper"><span class="improper"><span>x</span></span></span></span></span><span>"</span></span></span></span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span> abs(-x) = abs(x) </span><span>*</span><span>)</span></span><span>
</span><span class="comment1"><span>(</span><span>*</span><span> abs(abs(x)) = abs(x) 
lemma abs_rewrite_helper:
  assumes "valid_value (IntegerStamp b lox hix) x"
  shows "intval_abs (intval_negate x) = intval_abs x"
  and "intval_abs (intval_abs x) = intval_abs x"
  apply (case_tac[!] "x")
  using word_helper apply auto+
  done
</span><span>*</span><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26962386.abs_abs_is_abs|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26962386.abs_abs_is_abs|thm"><span>abs_abs_is_abs</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lox</span></span><span> </span><span class="free"><span>hix</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_abs|const"><span>intval_abs</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_abs|const"><span>intval_abs</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_abs|const"><span>intval_abs</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
</span><span class="comment1"><span>(</span><span>*</span><span> was:
  using word_helper
  by (metis assms intval_abs.simps(1) intval_abs.simps(2) valid32or64_both) 
</span><span>*</span><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26962386.abs_neg_is_neg|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26962386.abs_neg_is_neg|thm"><span>abs_neg_is_neg</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lox</span></span><span> </span><span class="free"><span>hix</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_abs|const"><span>intval_abs</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_negate|const"><span>intval_negate</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_abs|const"><span>intval_abs</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>case_tac</span></span><span class="main"><span class="improper"><span>[</span></span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="improper"><span>]</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_12533..12544"><span>word_helper</span></a><span> 
    </span><span class="comment1"><span>(</span><span>*</span><span> apply auto+
  done </span><span>*</span><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span>
lemma CanonicalizeAbsAbs:
  assumes vv: "is_IntegerStamp (stamp_expr e)"
  assumes "[m, p] ⊢ UnaryExpr UnaryAbs (UnaryExpr UnaryAbs e) ↦ v"
  shows "[m, p] ⊢ UnaryExpr UnaryAbs e ↦ v"
  by (metis UnaryExprE abs_abs_is_abs assms(2) stamp_implies_valid_value
      is_IntegerStamp_def unary_eval.simps(1) vv)

lemma CanonicalizeAbsNeg:
  assumes vv: "is_IntegerStamp (stamp_expr e)"
  assumes "[m, p] ⊢ UnaryExpr UnaryAbs (UnaryExpr UnaryNeg e) ↦ v"
  shows "[m, p] ⊢ UnaryExpr UnaryAbs e ↦ v"
  using UnaryExprE abs_neg_is_neg assms(2) stamp_implies_valid_value
      is_IntegerStamp_def unary_eval.simps(2) vv
  by (smt (verit, ccfv_threshold) evaltree.simps unary_eval.simps(1))
  
lemma CanonicalizeAbsProof:
  assumes "CanonicalizeAbs before after"
  assumes "[m, p] ⊢ before ↦ res"
  assumes "[m, p] ⊢ after ↦ res'"
  shows "res = res'"
  using assms
proof (induct rule: CanonicalizeAbs.induct)
  case (abs_abs ax x)
  then show ?case
    by (metis UnaryExprE abs_rewrite_helper(2) evalDet stamp_implies_valid_value is_IntegerStamp_def
        unary_eval.simps(1))
next
  case (abs_neg nx x)
  then show ?case
    by (metis UnaryExprE abs_rewrite_helper(1) evalDet stamp_implies_valid_value is_IntegerStamp_def
        unary_eval.simps(1) unary_eval.simps(2))
qed
</span><span>*</span><span>)</span></span><span>
</span><span class="comment1"><span>(</span><span>*</span><span> ~(~x) = x </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_14859..14864">lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.not_rewrite_helper|fact"><span class="entity_def" id="CanonicalizationTreeProofs.not_rewrite_helper|thm"><span>not_rewrite_helper</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lox</span></span><span> </span><span class="free"><span>hix</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_not|const"><span>intval_not</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_not|const"><span>intval_not</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_14859..14864"><span>assms</span></a><span> </span><a class="entity_ref" href="../Proofs/StampEvalThms.html#StampEvalThms.valid_int_stamp_gives|fact"><span>valid_int_stamp_gives</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>bit.double_compl</span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_not.simps|fact"><span>intval_not.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int.simps|fact"><span>new_int.simps</span></a><span> </span><span>take_bit_not_take_bit</span><span class="main"><span>)</span></span><span> 

</span><span class="keyword1"><span class="command"><span>experiment</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15117..15122">lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26962638.CanonicalizeNotProof|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26962638.CanonicalizeNotProof|thm"><span>CanonicalizeNotProof</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeNot|const"><span>CanonicalizeNot</span></a><span> </span><span class="free"><span>before</span></span><span> </span><span class="free"><span>after</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>before</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>after</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_15117..15122"><span>assms</span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeNot.induct|fact"><span>CanonicalizeNot.induct</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>not_not</span><span> </span><span class="skolem"><span>nx</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (metis UnaryExprE evalDet is_IntegerStamp_def not_rewrite_helper
        stamp_implies_valid_value unary_eval.simps(3)) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15521..15526">lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.demorgans_rewrites_helper|fact"><span class="entity_def" id="CanonicalizationTreeProofs.demorgans_rewrites_helper(4)|thm"><span class="entity_def" id="CanonicalizationTreeProofs.demorgans_rewrites_helper(3)|thm"><span class="entity_def" id="CanonicalizationTreeProofs.demorgans_rewrites_helper(2)|thm"><span class="entity_def" id="CanonicalizationTreeProofs.demorgans_rewrites_helper(1)|thm"><span>demorgans_rewrites_helper</span></span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lox</span></span><span> </span><span class="free"><span>hix</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>     </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>loy</span></span><span> </span><span class="free"><span>hiy</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_and|const"><span>intval_and</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_not|const"><span>intval_not</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_not|const"><span>intval_not</span></a><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_not|const"><span>intval_not</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_or|const"><span>intval_or</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_or|const"><span>intval_or</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_not|const"><span>intval_not</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_not|const"><span>intval_not</span></a><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_not|const"><span>intval_not</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_and|const"><span>intval_and</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_and|const"><span>intval_and</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_or|const"><span>intval_or</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_15521..15526"><span>assms</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#CanonicalizationTreeProofs.valid_int_stamp_both|fact"><span>valid_int_stamp_both</span></a><span> 
  </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span>  </span><span class="comment1"><span>(</span><span>*</span><span> was: fastforce+ </span><span>*</span><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>experiment</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15975..15980">lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26962854.CanonicalizeAndProof|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26962854.CanonicalizeAndProof|thm"><span>CanonicalizeAndProof</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeAnd|const"><span>CanonicalizeAnd</span></a><span> </span><span class="free"><span>before</span></span><span> </span><span class="free"><span>after</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>before</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>after</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_15975..15980"><span>assms</span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeAnd.induct|fact"><span>CanonicalizeAnd.induct</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>and_same</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (metis BinaryExprE bin_eval.simps(4) demorgans_rewrites_helper(3) evalDet
        stamp_implies_valid_value is_IntegerStamp_def) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>and_demorgans</span><span> </span><span class="skolem"><span>nx</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>ny</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>stampx</span></span><span> </span><span class="skolem"><span>stampy</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (smt (z3) BinaryExprE Stamp.sel(1) UnaryExprE bin_eval.simps(4) bin_eval.simps(5) 
        demorgans_rewrites_helper(1) evalDet stamp_implies_valid_value is_IntegerStamp_def unary_eval.simps(3)) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_16666..16671">lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26962854.CanonicalizeOrProof|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26962854.CanonicalizeOrProof|thm"><span>CanonicalizeOrProof</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeOr|const"><span>CanonicalizeOr</span></a><span> </span><span class="free"><span>before</span></span><span> </span><span class="free"><span>after</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>before</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>after</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_16666..16671"><span>assms</span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeOr.induct|fact"><span>CanonicalizeOr.induct</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>or_same</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (metis BinaryExprE bin_eval.simps(5) demorgans_rewrites_helper(4) evalDet
        stamp_implies_valid_value is_IntegerStamp_def) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>or_demorgans</span><span> </span><span class="skolem"><span>nx</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>ny</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>stampx</span></span><span> </span><span class="skolem"><span>stampy</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
    by (smt (z3) BinaryExprE Stamp.sel(1) UnaryExprE bin_eval.simps(4) bin_eval.simps(5) demorgans_rewrites_helper(2)
        evalDet stamp_implies_valid_value is_IntegerStamp_def unary_eval.simps(3)) </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>experiment</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26963060.stamps_touch_but_not_less_than_implies_equal|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26963060.stamps_touch_but_not_less_than_implies_equal|thm"><span>stamps_touch_but_not_less_than_implies_equal</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>stampx</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>stampy</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.is_IntegerStamp|const"><span>is_IntegerStamp</span></a><span> </span><span class="free"><span>stampx</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.is_IntegerStamp|const"><span>is_IntegerStamp</span></a><span> </span><span class="free"><span>stampy</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.stpi_upper|const"><span>stpi_upper</span></a><span> </span><span class="free"><span>stampx</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.stpi_lower|const"><span>stpi_lower</span></a><span> </span><span class="free"><span>stampy</span></span><span class="main"><span>;</span></span><span>
    </span><span class="main"><span>¬</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool|const"><span>val_to_bool</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_less_than|const"><span>intval_less_than</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>⟧</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#CanonicalizationTreeProofs.valid_int_stamp_both|fact"><span>valid_int_stamp_both</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_equals.simps|fact"><span>intval_equals.simps</span></a><span class="main"><span>(</span></span><span>1-2</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_less_than.simps|fact"><span>intval_less_than.simps</span></a><span class="main"><span>(</span></span><span>1-2</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool.simps|fact"><span>val_to_bool.simps</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26963060.disjoint_stamp_implies_less_than|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26963060.disjoint_stamp_implies_less_than|thm"><span>disjoint_stamp_implies_less_than</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>⟦</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>stampx</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>stampy</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.is_IntegerStamp|const"><span>is_IntegerStamp</span></a><span> </span><span class="free"><span>stampx</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.is_IntegerStamp|const"><span>is_IntegerStamp</span></a><span> </span><span class="free"><span>stampy</span></span><span class="main"><span>;</span></span><span>
    </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.stpi_upper|const"><span>stpi_upper</span></a><span> </span><span class="free"><span>stampx</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.stpi_lower|const"><span>stpi_lower</span></a><span> </span><span class="free"><span>stampy</span></span><span class="main"><span>⟧</span></span><span> 
  </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool|const"><span>val_to_bool</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_less_than|const"><span>intval_less_than</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_17973..17978">lemma</span></span></span><span> </span><span class="entity_def" id="CanonicalizationTreeProofs.experiment26963060.CanonicalizeConditionalProof|fact"><span class="entity_def" id="CanonicalizationTreeProofs.experiment26963060.CanonicalizeConditionalProof|thm"><span>CanonicalizeConditionalProof</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeConditional|const"><span>CanonicalizeConditional</span></a><span> </span><span class="free"><span>before</span></span><span> </span><span class="free"><span>after</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>before</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>after</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>res'</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_17973..17978"><span>assms</span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTree.html#CanonicalizationTree.CanonicalizeConditional.induct|fact"><span>CanonicalizeConditional.induct</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>eq_branches</span><span> </span><span class="skolem"><span>t</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>c</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_18293..18300">cond_eq</span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>stampx</span></span><span> </span><span class="skolem"><span>stampy</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xval</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_18342..18347">xeval</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>xval</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_18293..18300"><span>cond_eq.hyps</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_18293..18300"><span>cond_eq.prems</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>yval</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_18440..18445">yeval</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>yval</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_18293..18300"><span>cond_eq.prems</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>xval</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>yval</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_threshold</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.ConditionalExprE|fact"><span>ConditionalExprE</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_18293..18300"><span>cond_eq.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_18293..18300"><span>cond_eq.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_18342..18347"><span>xeval</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_18440..18445"><span>yeval</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>¬</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool|const"><span>val_to_bool</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_equals|const"><span>intval_equals</span></a><span> </span><span class="skolem"><span>xval</span></span><span> </span><span class="skolem"><span>yval</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree.ConstantExpr|fact"><span>ConstantExpr</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.distinct|fact"><span>Value.distinct</span></a><span class="main"><span>(</span></span><span>9</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value.simps|fact"><span>valid_value.simps</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_equals|const"><span>intval_equals</span></a><span> </span><span class="skolem"><span>xval</span></span><span> </span><span class="skolem"><span>yval</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool.simps|fact"><span>val_to_bool.simps</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>yval</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_threshold</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.BinaryExprE|fact"><span>BinaryExprE</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.ConditionalExprE|fact"><span>ConditionalExprE</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval.simps|fact"><span>bin_eval.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>11</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_18293..18300"><span>cond_eq.hyps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_18293..18300"><span>cond_eq.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_18342..18347"><span>xeval</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_18440..18445"><span>yeval</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_18293..18300"><span>cond_eq.prems</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_18293..18300"><span>cond_eq.prems</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_18342..18347"><span>xeval</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_18440..18445"><span>yeval</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_19194..19212">condition_bounds_x</span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>stampx</span></span><span> </span><span class="skolem"><span>stampy</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xval</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_19254..19259">xeval</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>xval</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_19194..19212"><span>condition_bounds_x.prems</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>yval</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_19346..19351">yeval</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>yval</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_19194..19212"><span>condition_bounds_x.hyps</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_19194..19212"><span>condition_bounds_x.prems</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool|const"><span>val_to_bool</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_less_than|const"><span>intval_less_than</span></a><span> </span><span class="skolem"><span>xval</span></span><span> </span><span class="skolem"><span>yval</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.BinaryExprE|fact"><span>BinaryExprE</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.ConditionalExprE|fact"><span>ConditionalExprE</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval.simps|fact"><span>bin_eval.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>12</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_19194..19212"><span>condition_bounds_x.hyps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_19194..19212"><span>condition_bounds_x.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_19194..19212"><span>condition_bounds_x.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_19254..19259"><span>xeval</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_19346..19351"><span>yeval</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.stpi_upper|const"><span>stpi_upper</span></a><span> </span><span class="skolem"><span>stampx</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.stpi_lower|const"><span>stpi_lower</span></a><span> </span><span class="skolem"><span>stampy</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
      by (metis False condition_bounds_x.hyps(4) order.not_eq_order_implies_strict
          disjoint_stamp_implies_less_than condition_bounds_x.hyps(2) condition_bounds_x.hyps(3) condition_bounds_x.hyps(6)
          stamp_implies_valid_value xeval yeval) </span><span>*</span><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>xval</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>yval</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
      by (metis False condition_bounds_x.hyps(2-3,6) stamp_implies_valid_value
          stamps_touch_but_not_less_than_implies_equal xeval yeval) </span><span>*</span><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>xval</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="free"><span>res'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>xval</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.ConditionalExprE|fact"><span>ConditionalExprE</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_19194..19212"><span>condition_bounds_x.prems</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res'</span></span><span>›</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_19254..19259"><span>xeval</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_19346..19351"><span>yeval</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_20482..20500">condition_bounds_y</span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>stampx</span></span><span> </span><span class="skolem"><span>stampy</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xval</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_20542..20547">xeval</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>xval</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_20482..20500"><span>condition_bounds_y.hyps</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_20482..20500"><span>condition_bounds_y.prems</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>yval</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_20661..20666">yeval</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>yval</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_20482..20500"><span>condition_bounds_y.hyps</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_20482..20500"><span>condition_bounds_y.prems</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool|const"><span>val_to_bool</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_less_than|const"><span>intval_less_than</span></a><span> </span><span class="skolem"><span>xval</span></span><span> </span><span class="skolem"><span>yval</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.BinaryExprE|fact"><span>BinaryExprE</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.ConditionalExprE|fact"><span>ConditionalExprE</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval.simps|fact"><span>bin_eval.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>12</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_20482..20500"><span>condition_bounds_y.hyps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_20482..20500"><span>condition_bounds_y.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_20482..20500"><span>condition_bounds_y.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_20542..20547"><span>xeval</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_20661..20666"><span>yeval</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.stpi_upper|const"><span>stpi_upper</span></a><span> </span><span class="skolem"><span>stampx</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.stpi_lower|const"><span>stpi_lower</span></a><span> </span><span class="skolem"><span>stampy</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
      by (metis False condition_bounds_y.hyps(4) order.not_eq_order_implies_strict
          disjoint_stamp_implies_less_than condition_bounds_y.hyps(2) condition_bounds_y.hyps(3)
          condition_bounds_y.hyps(6) stamp_implies_valid_value xeval yeval) </span><span>*</span><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>xval</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>yval</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
      by (metis False condition_bounds_y.hyps(2-3,6)
          stamp_implies_valid_value stamps_touch_but_not_less_than_implies_equal xeval yeval)
      </span><span>*</span><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>yval</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="free"><span>res'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>yval</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.ConditionalExprE|fact"><span>ConditionalExprE</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_20482..20500"><span>condition_bounds_y.prems</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>res'</span></span><span>›</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_20542..20547"><span>xeval</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_20661..20666"><span>yeval</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_21798..21814">negate_condition</span><span> </span><span class="skolem"><span>nc</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="skolem"><span>stampc</span></span><span> </span><span class="skolem"><span>lo</span></span><span> </span><span class="skolem"><span>hi</span></span><span> </span><span class="skolem"><span>stampx</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>stampy</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>cval</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_21872..21877">ceval</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>cval</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21798..21814"><span>negate_condition.prems</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>ncval</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_21963..21969">nceval</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>nc</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>ncval</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21798..21814"><span>negate_condition.prems</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21798..21814"><span>negate_condition.prems</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_17973..17978"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool|const"><span>val_to_bool</span></a><span> </span><span class="skolem"><span>ncval</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_22132..22136">True</span><span>
    </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xval</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_22159..22164">xeval</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>xval</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.ConditionalExprE|fact"><span>ConditionalExprE</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21963..21969"><span>nceval</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_22132..22136"><span>True</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21798..21814"><span>negate_condition.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>xval</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.ConditionalExprE|fact"><span>ConditionalExprE</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_22132..22136"><span>True</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21963..21969"><span>nceval</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21798..21814"><span>negate_condition.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>≠</span></span><span> </span><span class="skolem"><span>nc</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21798..21814"><span>negate_condition.hyps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>¬</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool|const"><span>val_to_bool</span></a><span> </span><span class="skolem"><span>cval</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
      by (metis True UnaryExprE ceval evalDet intval_logic_negation.simps(1) nceval negate_condition.hyps(1) negate_condition.hyps(2) negate_condition.hyps(3) stamp_implies_valid_value unary_eval.simps(4) val_to_bool.simps(1) valid_int32)
      </span><span>*</span><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>xval</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21963..21969"><span>nceval</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21872..21877"><span>ceval</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_22132..22136"><span>True</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21798..21814"><span>negate_condition</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21798..21814"><span>negate_condition</span></a><span class="main"><span>(</span></span><span>9</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.ConditionalExprE|fact"><span>ConditionalExprE</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_22159..22164"><span>xeval</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>xval</span></span><span>›</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_22992..22997">False</span><span>
    </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>yval</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_23020..23025">yeval</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>yval</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.ConditionalExprE|fact"><span>ConditionalExprE</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21963..21969"><span>nceval</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_22992..22997"><span>False</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21798..21814"><span>negate_condition.prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>yval</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_22992..22997"><span>False</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21963..21969"><span>nceval</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21798..21814"><span>negate_condition.prems</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree.ConditionalExpr|fact"><span>evaltree.ConditionalExpr</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_23020..23025"><span>yeval</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.ConditionalExprE|fact"><span>ConditionalExprE</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool|const"><span>val_to_bool</span></a><span class="main"><span>(</span></span><span class="skolem"><span>cval</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>sorry</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span>
      by (metis False UnaryExprE ceval evalDet intval_logic_negation.simps(1) nceval negate_condition.hyps(1) negate_condition.hyps(2) negate_condition.hyps(3) stamp_implies_valid_value unary_eval.simps(4) val_to_bool.simps(1) valid_int32 zero_neq_one)
      </span><span>*</span><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_23624..23632">moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>res'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>yval</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_23624..23632"><span>calculation</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21872..21877"><span>ceval</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_21798..21814"><span>negate_condition.prems</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree.ConditionalExpr|fact"><span>evaltree.ConditionalExpr</span></a><span> </span><a class="entity_ref" href="CanonicalizationTreeProofs.html#offset_23020..23025"><span>yeval</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span>  </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.unary_eval.simps|fact"><span>unary_eval.simps</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.ConditionalExprE|fact"><span>ConditionalExprE</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>const_true</span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="skolem"><span>val</span></span><span> </span><span class="skolem"><span>t</span></span><span> </span><span class="skolem"><span>f</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>const_false</span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="skolem"><span>val</span></span><span> </span><span class="skolem"><span>t</span></span><span> </span><span class="skolem"><span>f</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span></pre>
</body>

</html>