<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory NewAnd</title>
</head>


<body>
<div class="head">
<h1>Theory NewAnd</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Experimental AndNode Phase</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>NewAnd</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span>
    </span><a href="Common.html"><span>Common</span></a><span>
    </span><a href="../Graph/Long.html"><span>Graph.Long</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.bin_distribute_and_over_or|fact"><span class="entity_def" id="NewAnd.bin_distribute_and_over_or|thm"><span>bin_distribute_and_over_or</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>bin[</span></span><span class="free"><span>z</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>bin[</span></span><span class="main"><span>(</span></span><span class="free"><span>z</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>z</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>bit_and_iff</span><span> </span><span>bit_eqI</span><span> </span><span>bit_or_iff</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.intval_distribute_and_over_or|fact"><span class="entity_def" id="NewAnd.intval_distribute_and_over_or|thm"><span>intval_distribute_and_over_or</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="free"><span>z</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>val[</span></span><span class="main"><span>(</span></span><span class="free"><span>z</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>z</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>y</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>z</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.bin_distribute_and_over_or|fact"><span>bin_distribute_and_over_or</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.exp_distribute_and_over_or|fact"><span class="entity_def" id="NewAnd.exp_distribute_and_over_or|thm"><span>exp_distribute_and_over_or</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>exp[</span></span><span class="free"><span>z</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="main"><span>(</span></span><span class="free"><span>z</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>z</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.intval_distribute_and_over_or|fact"><span>intval_distribute_and_over_or</span></a><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree.BinaryExpr|fact"><span>BinaryExpr</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval.simps|fact"><span>bin_eval.simps</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>,</span></span><span>5</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_or.simps|fact"><span>intval_or.simps</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int_bin.simps|fact"><span>new_int_bin.simps</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int.simps|fact"><span>new_int.simps</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval.simps|fact"><span>bin_eval.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval.simps|fact"><span>bin_eval.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>5</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_or.simps|fact"><span>intval_or.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_or.simps|fact"><span>intval_or.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>5</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.intval_and_commute|fact"><span class="entity_def" id="NewAnd.intval_and_commute|thm"><span>intval_and_commute</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>val[</span></span><span class="free"><span>y</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>y</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>and.commute</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.intval_or_commute|fact"><span class="entity_def" id="NewAnd.intval_or_commute|thm"><span>intval_or_commute</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>val[</span></span><span class="free"><span>y</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>y</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>or.commute</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.intval_xor_commute|fact"><span class="entity_def" id="NewAnd.intval_xor_commute|thm"><span>intval_xor_commute</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ExclusiveOr|const"><span>⊕</span></a></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>val[</span></span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ExclusiveOr|const"><span>⊕</span></a></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>y</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>xor.commute</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.exp_and_commute|fact"><span class="entity_def" id="NewAnd.exp_and_commute|thm"><span>exp_and_commute</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>z</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.intval_and_commute|fact"><span>intval_and_commute</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.exp_or_commute|fact"><span class="entity_def" id="NewAnd.exp_or_commute|thm"><span>exp_or_commute</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>y</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.intval_or_commute|fact"><span>intval_or_commute</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.exp_xor_commute|fact"><span class="entity_def" id="NewAnd.exp_xor_commute|thm"><span>exp_xor_commute</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ExclusiveOr|const"><span>⊕</span></a></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ExclusiveOr|const"><span>⊕</span></a></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.intval_xor_commute|fact"><span>intval_xor_commute</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1344..1349">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.bin_eliminate_y|fact"><span class="entity_def" id="NewAnd.bin_eliminate_y|thm"><span>bin_eliminate_y</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>bin[</span></span><span class="free"><span>y</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>bin[</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>bin[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_1344..1349"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>and.commute</span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.bin_distribute_and_over_or|fact"><span>bin_distribute_and_over_or</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1505..1510">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.intval_eliminate_y|fact"><span class="entity_def" id="NewAnd.intval_eliminate_y|thm"><span>intval_eliminate_y</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="free"><span>y</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>val[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_1505..1510"><span>assms</span></a><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.bin_eliminate_y|fact"><span>bin_eliminate_y</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>y</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>z</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.intval_and_associative|fact"><span class="entity_def" id="NewAnd.intval_and_associative|thm"><span>intval_and_associative</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>val[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>y</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>y</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>z</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>and.assoc</span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.intval_or_associative|fact"><span class="entity_def" id="NewAnd.intval_or_associative|thm"><span>intval_or_associative</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>val[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>y</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>y</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>z</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>or.assoc</span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.intval_xor_associative|fact"><span class="entity_def" id="NewAnd.intval_xor_associative|thm"><span>intval_xor_associative</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ExclusiveOr|const"><span>⊕</span></a></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ExclusiveOr|const"><span>⊕</span></a></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>val[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ExclusiveOr|const"><span>⊕</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ExclusiveOr|const"><span>⊕</span></a></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>y</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>z</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>xor.assoc</span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.exp_and_associative|fact"><span class="entity_def" id="NewAnd.exp_and_associative|thm"><span>exp_and_associative</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>exp[</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>y</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.intval_and_associative|fact"><span>intval_and_associative</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.exp_or_associative|fact"><span class="entity_def" id="NewAnd.exp_or_associative|thm"><span>exp_or_associative</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>exp[</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>y</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.intval_or_associative|fact"><span>intval_or_associative</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.exp_xor_associative|fact"><span class="entity_def" id="NewAnd.exp_xor_associative|thm"><span>exp_xor_associative</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>exp[</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ExclusiveOr|const"><span>⊕</span></a></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ExclusiveOr|const"><span>⊕</span></a></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ExclusiveOr|const"><span>⊕</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ExclusiveOr|const"><span>⊕</span></a></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.intval_xor_associative|fact"><span>intval_xor_associative</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2464..2469">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.intval_and_absorb_or|fact"><span class="entity_def" id="NewAnd.intval_and_absorb_or|thm"><span>intval_and_absorb_or</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∃</span></span><span class="bound"><span>b</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int|const"><span>new_int</span></a><span> </span><span class="bound"><span>b</span></span><span> </span><span class="bound"><span>v</span></span><span>"</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span> TODO: required? </span><span>*</span><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>≠</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.UndefVal|const"><span>UndefVal</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>val[</span></span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_2464..2469"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>y</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>mono_tags</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_and.simps|fact"><span>intval_and.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>5</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2725..2730">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.intval_or_absorb_and|fact"><span class="entity_def" id="NewAnd.intval_or_absorb_and|thm"><span>intval_or_absorb_and</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∃</span></span><span class="bound"><span>b</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int|const"><span>new_int</span></a><span> </span><span class="bound"><span>b</span></span><span> </span><span class="bound"><span>v</span></span><span>"</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span> TODO: required? </span><span>*</span><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>≠</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.UndefVal|const"><span>UndefVal</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>val[</span></span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_2725..2730"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>y</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>mono_tags</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_or.simps|fact"><span>intval_or.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>5</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.exp_and_absorb_or|fact"><span class="entity_def" id="NewAnd.exp_and_absorb_or|thm"><span>exp_and_absorb_or</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.intval_and_absorb_or|fact"><span>intval_and_absorb_or</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.eval_unused_bits_zero|fact"><span>eval_unused_bits_zero</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_or.elims|fact"><span>intval_or.elims</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int.elims|fact"><span>new_int.elims</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.exp_or_absorb_and|fact"><span class="entity_def" id="NewAnd.exp_or_absorb_and|thm"><span>exp_or_absorb_and</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.intval_or_absorb_and|fact"><span>intval_or_absorb_and</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.eval_unused_bits_zero|fact"><span>eval_unused_bits_zero</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_or.elims|fact"><span>intval_or.elims</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int.elims|fact"><span>new_int.elims</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="NewAnd.IRExpr_up_def|fact"><span class="entity_def" id="NewAnd.IRExpr_up_def|thm"><span class="entity_def" id="NewAnd.IRExpr_up_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="NewAnd.IRExpr_up|const"><span>IRExpr_up</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr|type"><span>IRExpr</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.int64|type"><span>int64</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>IRExpr_up</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>not</span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="NewAnd.IRExpr_down_def|fact"><span class="entity_def" id="NewAnd.IRExpr_down_def|thm"><span class="entity_def" id="NewAnd.IRExpr_down_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="NewAnd.IRExpr_down|const"><span>IRExpr_down</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr|type"><span>IRExpr</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.int64|type"><span>int64</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>IRExpr_down</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3479..3484">lemma</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>or</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_3479..3484"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span>
lemma
  fixes x y :: "64 word"
  assumes "∃e. n = 2^e"
  assumes "and y n = 0"
  shows "x + y = (or (and x n) (and y n)) + ((x &gt;&gt; n) + (y &gt;&gt; n) &lt;&lt; n)"
</span><span>*</span><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3711..3716">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.no_overlap_or|fact"><span class="entity_def" id="NewAnd.no_overlap_or|thm"><span>no_overlap_or</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>and</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>or</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_3711..3716"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>bit_and_iff</span><span> </span><span>bit_xor_iff</span><span> </span><span>disjunctive_add</span><span> </span><span>xor_self_eq</span><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span>lemma no_carry_zero_bit:
  assumes "¬(bit y j)"
  assumes "¬(bit y (Suc j))"
  shows "bit (x + y) (Suc j) = bit x (Suc j)"
  using assms sorry</span><span>*</span><span>)</span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span>
lemma
  fixes x y :: "'a :: len word"
  assumes "(and y (mask (Suc j))) = 0"
  shows "bit (x + y) j = bit (or x y) j"
  using assms proof (induction j)
  case 0
  then show ?case
    by (metis Word.mask_Suc_0 bit_0 bit_1_iff bit_and_iff bit_mask_iff even_add even_or_iff less_numeral_extra(3) mask_0)
next
  case (Suc j)
  then show ?case sorry
qed

lemma packed_bottom_zeros_elim_add:
  fixes x y :: "'a :: len word"
  assumes "⋀n. n ≤ j ⟹ ¬(bit y n)"
  shows "bit (x + y) j = bit x j"
  using assms 
proof -
  have "(and y (mask j)) = 0"
    using assms
    by (metis (no_types, opaque_lifting) bit_and_iff bit_eq_iff bit_mask_iff order_le_less zero_and_eq)
  have "bit (x + y) j = bit (or x y) j"
    using assms
    proof (induction j)
      case 0
      then show ?case
        by (simp add: even_or_iff)
    next
      case (Suc j)
      then show ?case sorry
    qed
  then show ?thesis
    by (simp add: assms bit_or_iff)
qed
proof (induction j)
  case 0
  then show ?case
    by auto
next
  case (Suc j)
  have "(and y (2^(Suc j))) = 0"
    using Suc.prems and_exp_eq_0_iff_not_bit by blast
  
  then show ?case sorry
qed 
  
  using assms bit_and_iff bit_xor_iff disjunctive_add xor_self_eq sorry</span><span>*</span><span>)</span></span><span>
 </span><span class="comment1"><span>(</span><span>*</span><span>
using assms proof (induction j)
  case 0
  then show ?case
    by (metis assms bit_0 bot_nat_0.extremum even_add)
next
  case (Suc j)
  have j0: "¬(bit y j)"
    by (simp add: Suc.prems)
  have sj0: "¬(bit y (Suc j))"
    by (simp add: Suc.prems)
  show ?case using j0 sj0 no_overlap_or
    by blast
qed </span><span>*</span><span>)</span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span>
lemma packed_bits:
  fixes a :: "64 word"
  assumes "numberOfLeadingZeros a + bitCount a = 64"
  assumes "a ≠ 0"
  shows "n ≤ highestOneBit a ⟶ bit a n"
proof -
  obtain j where j: "j = highestOneBit a"
    by simp
  then have "∀i. i &lt; Nat.size a ∧ i &gt; j ⟶ ¬(bit a i)"
    unfolding highestOneBit_def
    by (simp add: j zerosAboveHighestOne)
  have "Nat.size a &gt; highestOneBit a"
    unfolding highestOneBit_def MaxOrNeg_def
    by (simp add: max_bit)
  then have jcard: "numberOfLeadingZeros a = card {i. j ≤ i ∧ i ≤ Nat.size a}"
    unfolding numberOfLeadingZeros_def using j card_of_range_bound leadingZerosAddHighestOne sorry
    by presburger
  obtain k where k: "k = Nat.size a - numberOfLeadingZeros a"
    by presburger
  then have "k = bitCount a"
    using assms
    using size64 by auto
  have union: "{i. j &lt; i ∧ i &lt; Nat.size a} ∪ {i. i ≤ j} = {i. i &lt; Nat.size a}"
    apply auto
    using ‹highestOneBit (a::64 word) &lt; int (size_class.size a)› j by linarith
  have intersect: "{i. j &lt; i ∧ i &lt; Nat.size a} ∩ {i. i ≤ j} = {}"
    by force
  have "card {i. j &lt; i ∧ i &lt; Nat.size a} + card {i. i ≤ j} = card {i. i &lt; Nat.size a}"
    using card_add intersect union sorry
    by (metis (no_types, lifting) Int_commute bounded_nat_set_is_finite finite_Un mem_Collect_eq)
  then have "numberOfLeadingZeros a + card {i. i ≤ j} = Nat.size a + 1"
    unfolding jcard card_of_range apply auto sorry
    by (metis j jcard leadingZerosAddHighestOne)
  then have "k = card {i. i &lt; j}"
    using assms k
    by (simp add: add.commute)
  have "{i. j &lt; i ∧ i &lt; Nat.size a} ∩ {i. i ≤ j} = {}"
    using intersect by blast
  have "∀i . i ∈ {i. j &lt; i ∧ i &lt; Nat.size a} ⟶ ¬(bit a i)"
    using ‹∀i::nat. i &lt; size_class.size (a::64 word) ∧ (j::nat) &lt; i ⟶ ¬ bit a i› by blast
  then have "∀i . i ∈ {i. i &lt; j} ⟶ bit a i"
    sorry
  then have less: "∀i. i &lt; j ⟶ bit a i"
    by blast
  have eq: "bit a j"
    using j unfolding highestOneBit_def MaxOrZero_def
    by (metis Max_in assms(2) disjunctive_diff eq_iff_diff_eq_0 equals0D finite_bit_word mem_Collect_eq zero_and_eq)
  then show ?thesis
    using j
    by (simp add: less order_le_less)
qed
</span><span>*</span><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>context</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.stamp_mask|locale"><span>stamp_mask</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_7704..7709">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.intval_up_and_zero_implies_zero|fact"><span class="entity_def" id="NewAnd.stamp_mask.intval_up_and_zero_implies_zero|thm"><span class="entity_def" id="offset_7710..7741">intval_up_and_zero_implies_zero</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>xv</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>yv</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="free"><span>xv</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>yv</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>≠</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.UndefVal|const"><span>UndefVal</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∃</span></span><span> </span><span class="bound"><span>b</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>val[</span></span><span class="free"><span>xv</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>yv</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int|const"><span>new_int</span></a><span> </span><span class="bound"><span>b</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_7704..7709"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>xv</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>yv</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>up_mask_and_zero_implies_zero</span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>take_bit_and</span><span> </span><span>take_bit_of_0</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>presburger</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.exp_eliminate_y|fact"><span class="entity_def" id="NewAnd.stamp_mask.exp_eliminate_y|thm"><span>exp_eliminate_y</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>⟶</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinAnd|const"><span>BinAnd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinOr|const"><span>BinOr</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinAnd|const"><span>BinAnd</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>z</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>impI</span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><span>allI</span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><span>allI</span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><span>allI</span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> </span><span class="entity_def" id="offset_8263..8264">p</span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> m p v</span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>impI</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> </span><span class="entity_def" id="offset_8310..8311">e</span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xv</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_8342..8344">xv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>xv</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_8310..8311"><span>e</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>yv</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_8405..8407">yv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>yv</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_8310..8311"><span>e</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>zv</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_8468..8470">zv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>zv</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_8310..8311"><span>e</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8520..8523">lhs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>val[</span></span><span class="main"><span>(</span></span><span class="skolem"><span>xv</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="skolem"><span>yv</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="skolem"><span>zv</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_8342..8344"><span>xv</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_8405..8407"><span>yv</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_8468..8470"><span>zv</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.BinaryExprE|fact"><span>BinaryExprE</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval.simps|fact"><span>bin_eval.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval.simps|fact"><span>bin_eval.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>5</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_8310..8311"><span>e</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>val[</span></span><span class="main"><span>(</span></span><span class="skolem"><span>xv</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="skolem"><span>zv</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>yv</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="skolem"><span>zv</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.intval_and_commute|fact"><span>intval_and_commute</span></a><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.intval_distribute_and_over_or|fact"><span>intval_distribute_and_over_or</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8780..8784">also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∃</span></span><span class="bound"><span>b</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>val[</span></span><span class="skolem"><span>yv</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="skolem"><span>zv</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int|const"><span>new_int</span></a><span> </span><span class="bound"><span>b</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_7710..7741"><span>intval_up_and_zero_implies_zero</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_8780..8784"><span>calculation</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_8310..8311"><span>e</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_or.simps|fact"><span>intval_or.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>5</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_8263..8264"><span>p</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.unfold_binary|fact"><span>unfold_binary</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_8405..8407"><span>yv</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_8468..8470"><span>zv</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8959..8962">rhs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>val[</span></span><span class="skolem"><span>xv</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="skolem"><span>zv</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.intval_eliminate_y|fact"><span>intval_eliminate_y</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_8520..8523"><span>lhs</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_8520..8523"><span>lhs</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_8959..8962"><span>rhs</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree.BinaryExpr|fact"><span>BinaryExpr</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.BinaryExprE|fact"><span>BinaryExprE</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval.simps|fact"><span>bin_eval.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_8310..8311"><span>e</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_8342..8344"><span>xv</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_8468..8470"><span>zv</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9144..9149">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.leadingZeroBounds|fact"><span class="entity_def" id="NewAnd.stamp_mask.leadingZeroBounds|thm"><span class="entity_def" id="offset_9150..9167">leadingZeroBounds</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span class="main"><span>::</span></span><span>len</span><span> </span><span>word</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfLeadingZeros|const"><span>numberOfLeadingZeros</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span>Nat.size</span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_9144..9149"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfLeadingZeros_def|fact"><span>numberOfLeadingZeros_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.MaxOrNeg_def|fact"><span>MaxOrNeg_def</span></a><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.highestOneBit_def|fact"><span>highestOneBit_def</span></a><span> </span><span>nat_le_iff</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9378..9383">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.above_nth_not_set|fact"><span class="entity_def" id="NewAnd.stamp_mask.above_nth_not_set|thm"><span class="entity_def" id="offset_9384..9401">above_nth_not_set</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../Graph/Values.html#Values.int64|type"><span>int64</span></a></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>64</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfLeadingZeros|const"><span>numberOfLeadingZeros</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>j</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>⟶</span></span><span> </span><span class="main"><span>¬</span></span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_9378..9383"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfLeadingZeros_def|fact"><span>numberOfLeadingZeros_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_SIG</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.highestOneBit_def|fact"><span>highestOneBit_def</span></a><span> </span><span>int_nat_eq</span><span> </span><span>int_ops</span><span class="main"><span class="main"><span>(</span></span></span><span>6</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>less_imp_of_nat_less</span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.max_set_bit|fact"><span>max_set_bit</span></a><span> </span><a class="entity_ref" href="../Graph/ValueThms.html#ValueThms.size64|fact"><span>size64</span></a><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.zerosAboveHighestOne|fact"><span>zerosAboveHighestOne</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>no_notation</span></span></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.LogicNegationNotation|const"><span>LogicNegationNotation</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>!</span></span><span>_</span><span>"</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.zero_horner|fact"><span class="entity_def" id="NewAnd.stamp_mask.zero_horner|thm"><span class="entity_def" id="offset_9723..9734">zero_horner</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>False</span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9832..9837">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.zero_map|fact"><span class="entity_def" id="NewAnd.stamp_mask.zero_map|thm"><span class="entity_def" id="offset_9838..9846">zero_map</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>j</span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>⟶</span></span><span> </span><span class="main"><span>¬</span></span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>j</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>@</span></span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>False</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="free"><span>j</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>insert</span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_9832..9837"><span>assms</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> del_insts</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>add_diff_inverse_nat</span><span> </span><span>atLeastLessThan_iff</span><span> </span><span>bot_nat_0.extremum</span><span> </span><span>leD</span><span> </span><span>map_append</span><span> </span><span>map_eq_conv</span><span> </span><span>set_upt</span><span> </span><span>upt_add_eq_append</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10130..10135">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.map_join_horner|fact"><span class="entity_def" id="NewAnd.stamp_mask.map_join_horner|thm"><span class="entity_def" id="offset_10136..10151">map_join_horner</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>j</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>@</span></span><span> </span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>False</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="free"><span>j</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'a</span></span><span class="main"><span>::</span></span><span>len</span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>j</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'a</span></span><span class="main"><span>::</span></span><span>len</span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>j</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>length</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>j</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="free"><span>j</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>horner_sum_append</span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_10130..10135"><span>assms</span></a><span> </span><span>diff_le_self</span><span> </span><span>diff_zero</span><span> </span><span>le_add_same_cancel2</span><span> </span><span>length_append</span><span> </span><span>length_map</span><span> </span><span>length_upt</span><span> </span><span>map_append</span><span> </span><span>upt_add_eq_append</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10657..10661">also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>j</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>length</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>j</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>False</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="free"><span>j</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_10130..10135"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_10657..10661"><span>calculation</span></a><span> </span><span>horner_sum_append</span><span> </span><span>length_map</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>j</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_9723..9734"><span>zero_horner</span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>mult_not_zero</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11001..11006">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.split_horner|fact"><span class="entity_def" id="NewAnd.stamp_mask.split_horner|thm"><span class="entity_def" id="offset_11007..11019">split_horner</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>j</span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>⟶</span></span><span> </span><span class="main"><span>¬</span></span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'a</span></span><span class="main"><span>::</span></span><span>len</span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>j</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_10136..10151"><span>map_join_horner</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_9838..9846"><span>zero_map</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_11001..11006"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11250..11255">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.transfer_map|fact"><span class="entity_def" id="NewAnd.stamp_mask.transfer_map|thm"><span class="entity_def" id="offset_11256..11268">transfer_map</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>⟶</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>i</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_11250..11255"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11373..11378">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.transfer_horner|fact"><span class="entity_def" id="NewAnd.stamp_mask.transfer_horner|thm"><span class="entity_def" id="offset_11379..11394">transfer_horner</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>⟶</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="bound"><span>i</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'a</span></span><span class="main"><span>::</span></span><span>len</span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span>f'</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_11373..11378"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_11256..11268"><span>transfer_map</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11593..11598">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.L1|fact"><span class="entity_def" id="NewAnd.stamp_mask.L1|thm"><span class="entity_def" id="offset_11599..11601">L1</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>64</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfLeadingZeros|const"><span>numberOfLeadingZeros</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>zv</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>and</span><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>zv</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>zv</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_11742..11745">nle</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span class="numeral"><span>64</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_11593..11598"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>diff_le_self</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>and</span><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>zv</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="main"><span>(</span></span><span>and</span><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>zv</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>64</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>horner_sum_bit_eq_take_bit</span><span> </span><a class="entity_ref" href="../Graph/ValueThms.html#ValueThms.size64|fact"><span>size64</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>size_word.rep_eq</span><span> </span><span>take_bit_length_eq</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span>bit</span><span> </span><span class="main"><span>(</span></span><span>and</span><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>zv</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>64</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="free"><span>v</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="free"><span>zv</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>64</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>bit_and_iff</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="free"><span>v</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="free"><span>zv</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>⟶</span></span><span> </span><span class="main"><span>¬</span></span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="free"><span>zv</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_9384..9401"><span>above_nth_not_set</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_11593..11598"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_11593..11598"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span>not_may_implies_false</span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_SIG</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>One_nat_def</span><span> </span><span>diff_less</span><span> </span><span>int_ops</span><span class="main"><span class="main"><span>(</span></span></span><span>6</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.leadingZerosAddHighestOne|fact"><span>leadingZerosAddHighestOne</span></a><span> </span><span>linorder_not_le</span><span> </span><span>nat_int_comparison</span><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>not_numeral_le_zero</span><span> </span><a class="entity_ref" href="../Graph/ValueThms.html#ValueThms.size64|fact"><span>size64</span></a><span> </span><span>zero_less_Suc</span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.zerosAboveHighestOne|fact"><span>zerosAboveHighestOne</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>⟶</span></span><span> </span><span class="main"><span>¬</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="free"><span>v</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="free"><span>zv</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_11742..11745"><span>nle</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_11007..11019"><span>split_horner</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="free"><span>zv</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>⟶</span></span><span> </span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>bit</span><span> </span><span class="free"><span>v</span></span><span> </span><span class="bound"><span>i</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>bit_take_bit_iff</span><span> </span><span>take_bit_eq_mod</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>⟶</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="free"><span>v</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="free"><span>zv</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="free"><span>zv</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_11379..11394"><span>transfer_horner</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="free"><span>zv</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>64</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>⟶</span></span><span> </span><span class="main"><span>¬</span></span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="free"><span>zv</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_9384..9401"><span>above_nth_not_set</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_11593..11598"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_11593..11598"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span>not_may_implies_false</span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_SIG</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>One_nat_def</span><span> </span><span>diff_less</span><span> </span><span>int_ops</span><span class="main"><span class="main"><span>(</span></span></span><span>6</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.leadingZerosAddHighestOne|fact"><span>leadingZerosAddHighestOne</span></a><span> </span><span>linorder_not_le</span><span> </span><span>nat_int_comparison</span><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>not_numeral_le_zero</span><span> </span><a class="entity_ref" href="../Graph/ValueThms.html#ValueThms.size64|fact"><span>size64</span></a><span> </span><span>zero_less_Suc</span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.zerosAboveHighestOne|fact"><span>zerosAboveHighestOne</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_11593..11598"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>diff_le_self</span><span> </span><a class="entity_ref" href="NewAnd.html#offset_11007..11019"><span>split_horner</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="main"><span>(</span></span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>zv</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>64</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><span>bit_and_iff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>zv</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>horner_sum_bit_eq_take_bit</span><span> </span><a class="entity_ref" href="../Graph/ValueThms.html#ValueThms.size64|fact"><span>size64</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>size_word.rep_eq</span><span> </span><span>take_bit_length_eq</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>zv</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="main"><span>(</span></span><span>and</span><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>zv</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>64</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>.</span></span><span> </span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>zv</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>64</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="main"><span>(</span></span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>zv</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>64</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>.</span></span><span> </span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>zv</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>.</span></span><span> </span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span>bit</span><span> </span><span class="free"><span>zv</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>64</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>.</span></span><span> </span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>zv</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>64</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>.</span></span><span> </span><span>bit</span><span> </span><span class="free"><span>v</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span>bit</span><span> </span><span class="free"><span>zv</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>.</span></span><span> </span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>zv</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>.</span></span><span> </span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span>bit</span><span> </span><span class="free"><span>zv</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="main"><span>(</span></span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>zv</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>64</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>zv</span></span><span>›</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="main"><span>(</span></span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>zv</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>64</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span class="numeral"><span>64</span></span><span> </span><span>word</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>i</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>.</span></span><span> </span><span>bit</span><span> </span><span class="free"><span>v</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span>bit</span><span> </span><span class="free"><span>zv</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>64</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>presburger</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15292..15297">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.up_mask_upper_bound|fact"><span class="entity_def" id="NewAnd.stamp_mask.up_mask_upper_bound|thm"><span class="entity_def" id="offset_15298..15317">up_mask_upper_bound</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>xv</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>xv</span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_15292..15297"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>and.idem</span><span> </span><span>and.right_neutral</span><span> </span><span>bit.conj_cancel_left</span><span> </span><span>bit.conj_disj_distribs</span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>bit.double_compl</span><span> </span><span>ucast_id</span><span> </span><span>up_spec</span><span> </span><span>word_and_le1</span><span> </span><span>word_not_dist</span><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15562..15567">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.L2|fact"><span class="entity_def" id="NewAnd.stamp_mask.L2|thm"><span class="entity_def" id="offset_15568..15570">L2</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfLeadingZeros|const"><span>numberOfLeadingZeros</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfTrailingZeros|const"><span>numberOfTrailingZeros</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="numeral"><span>64</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>64</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfLeadingZeros|const"><span>numberOfLeadingZeros</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>zv</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>yv</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>yv</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>yv</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="free"><span>yv</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>horner_sum_bit_eq_take_bit</span><span> </span><span>take_bit_eq_mod</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_15298..15317"><span>up_mask_upper_bound</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_15562..15567"><span>assms</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> opaque_lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>and.right_neutral</span><span> </span><span>bit.conj_cancel_right</span><span> </span><span>bit.conj_disj_distribs</span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>bit.double_compl</span><span> </span><span>horner_sum_bit_eq_take_bit</span><span> </span><span>take_bit_and</span><span> </span><span>ucast_id</span><span> </span><span>up_spec</span><span> </span><span>word_and_le1</span><span> </span><span>word_not_dist</span><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>False</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∀</span></span><span class="bound"><span class="bound"><span>i</span></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>¬</span></span><span class="main"><span>(</span></span><span>bit</span><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_15562..15567"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>,</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.zerosBelowLowestOne|fact"><span>zerosBelowLowestOne</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>add.commute</span><span> </span><span>add_diff_inverse_nat</span><span> </span><span>add_lessD1</span><span> </span><span>leD</span><span> </span><span>le_diff_conv</span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfTrailingZeros_def|fact"><span>numberOfTrailingZeros_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_11256..11268"><span>transfer_map</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>horner_sum</span><span> </span><span>of_bool</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>False</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_9723..9734"><span>zero_horner</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>thm_oracles</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_11599..11601"><span>L1</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_15568..15570"><span>L2</span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.unfold_binary_width_add|fact"><span class="entity_def" id="NewAnd.stamp_mask.unfold_binary_width_add|thm"><span class="entity_def" id="offset_16778..16801">unfold_binary_width_add</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinAdd|const"><span>BinAdd</span></a><span> </span><span class="free"><span>xe</span></span><span> </span><span class="free"><span>ye</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>val</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∃</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span>
          </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>xe</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∧</span></span><span>
           </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>ye</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∧</span></span><span>
           </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval|const"><span>bin_eval</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinAdd|const"><span>BinAdd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∧</span></span><span>
           </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>≠</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.UndefVal|const"><span>UndefVal</span></a><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?L</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?R</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>iffI</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_17113..17114">3</span><span class="main"><span>:</span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?L</span></span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?R</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree.cases|fact"><span>evaltree.cases</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_17113..17114"><span>3</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>force</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span class="keyword3"><span>[</span></span></span><span>1</span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_add.elims|fact"><span>intval_add.elims</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_bits.simps|fact"><span>intval_bits.simps</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_17280..17281">R</span><span class="main"><span>:</span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?R</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>xe</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>ye</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.new_int|const"><span>new_int</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval|const"><span>bin_eval</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinAdd|const"><span>BinAdd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.new_int|const"><span>new_int</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>≠</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.UndefVal|const"><span>UndefVal</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?L</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_17280..17281"><span>R</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
 </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.unfold_binary_width_and|fact"><span class="entity_def" id="NewAnd.stamp_mask.unfold_binary_width_and|thm"><span class="entity_def" id="offset_17545..17568">unfold_binary_width_and</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinAnd|const"><span>BinAnd</span></a><span> </span><span class="free"><span>xe</span></span><span> </span><span class="free"><span>ye</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>val</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∃</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span>
          </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>xe</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∧</span></span><span>
           </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>ye</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∧</span></span><span>
           </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval|const"><span>bin_eval</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinAnd|const"><span>BinAnd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∧</span></span><span>
           </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>≠</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.UndefVal|const"><span>UndefVal</span></a><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?L</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?R</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>iffI</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_17880..17881">3</span><span class="main"><span>:</span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?L</span></span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?R</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree.cases|fact"><span>evaltree.cases</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_17880..17881"><span>3</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>force</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span class="keyword3"><span>[</span></span></span><span>1</span><span class="main"><span class="keyword3"><span>]</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_and.elims|fact"><span>intval_and.elims</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_bits.simps|fact"><span>intval_bits.simps</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int.simps|fact"><span>new_int.simps</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int_bin.simps|fact"><span>new_int_bin.simps</span></a><span> </span><span>take_bit_and</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_18098..18099">R</span><span class="main"><span>:</span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?R</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>xe</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>ye</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.new_int|const"><span>new_int</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval|const"><span>bin_eval</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinAnd|const"><span>BinAnd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.new_int|const"><span>new_int</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>≠</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.UndefVal|const"><span>UndefVal</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?L</span></span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_18098..18099"><span>R</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.mod_dist_over_add_right|fact"><span class="entity_def" id="NewAnd.stamp_mask.mod_dist_over_add_right|thm"><span class="entity_def" id="offset_18363..18386">mod_dist_over_add_right</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../Graph/Values.html#Values.int64|type"><span>int64</span></a></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_18438..18439">1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_18459..18460">2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>64</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Graph/ValueThms.html#ValueThms.mod_dist_over_add|fact"><span>mod_dist_over_add</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="NewAnd.html#offset_18438..18439"><span>1</span></a><span>"</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="NewAnd.html#offset_18459..18460"><span>2</span></a><span>"</span></span><span> </span><span>add.commute</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.numberOfLeadingZeros_range|fact"><span class="entity_def" id="NewAnd.stamp_mask.numberOfLeadingZeros_range|thm"><span class="entity_def" id="offset_18593..18619">numberOfLeadingZeros_range</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>≤</span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfLeadingZeros|const"><span>numberOfLeadingZeros</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfLeadingZeros|const"><span>numberOfLeadingZeros</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span>Nat.size</span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfLeadingZeros_def|fact"><span>numberOfLeadingZeros_def</span></a><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.highestOneBit_def|fact"><span>highestOneBit_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.max_set_bit|fact"><span>max_set_bit</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.highestOneBit_def|fact"><span>highestOneBit_def</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_9150..9167"><span>leadingZeroBounds</span></a><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfLeadingZeros_def|fact"><span>numberOfLeadingZeros_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_18842..18847">lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.stamp_mask.improved_opt|fact"><span class="entity_def" id="NewAnd.stamp_mask.improved_opt|thm"><span class="entity_def" id="offset_18848..18860">improved_opt</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfLeadingZeros|const"><span>numberOfLeadingZeros</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfTrailingZeros|const"><span>numberOfTrailingZeros</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="numeral"><span>64</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>exp[</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>allI</span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><span>impI</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> </span><span class="entity_def" id="offset_19038..19042">eval</span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> m p v</span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>n</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_19078..19079">n</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>64</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfLeadingZeros|const"><span>numberOfLeadingZeros</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>b</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>val</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_19151..19154">val</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="skolem"><span>val</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.BinaryExprE|fact"><span>BinaryExprE</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.bin_eval_new_int|fact"><span>bin_eval_new_int</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_19038..19042"><span>eval</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int.simps|fact"><span>new_int.simps</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xv</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>yv</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_19288..19292">addv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xv</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>yv</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="quasi_keyword"><span>asm</span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_17545..17568"><span>unfold_binary_width_and</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>add.right_neutral</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>yv</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_19437..19439">yv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="skolem"><span>yv</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="quasi_keyword"><span>asm</span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_16778..16801"><span>unfold_binary_width_add</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_19288..19292"><span>addv</span></a><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xv</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_19553..19555">xv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="skolem"><span>xv</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="quasi_keyword"><span>asm</span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_16778..16801"><span>unfold_binary_width_add</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_19151..19154"><span>val</span></a><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>zv</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_19668..19670">zv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="skolem"><span>zv</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="quasi_keyword"><span>asm</span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_17545..17568"><span>unfold_binary_width_and</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_19763..19767">addv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int|const"><span>new_int</span></a><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xv</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>yv</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree.BinaryExpr|fact"><span>evaltree.BinaryExpr</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_19553..19555"><span>xv</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_19437..19439"><span>yv</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_19918..19921">lhs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int|const"><span>new_int</span></a><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xv</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>yv</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>zv</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree.BinaryExpr|fact"><span>evaltree.BinaryExpr</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_19763..19767"><span>addv</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_19668..19670"><span>zv</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_19763..19767"><span>addv</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span class="keyword3"><span>[</span></span></span><span>1</span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_20117..20120">rhs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.new_int|const"><span>new_int</span></a><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span>and</span><span> </span><span class="skolem"><span>xv</span></span><span> </span><span class="skolem"><span>zv</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree.BinaryExpr|fact"><span>evaltree.BinaryExpr</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_19553..19555"><span>xv</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_19668..19670"><span>zv</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>force</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfLeadingZeros|const"><span>numberOfLeadingZeros</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_20359..20363">True</span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_20373..20381">n_bounds</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>64</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>diff_le_self</span><span> </span><a class="entity_ref" href="NewAnd.html#offset_19078..19079"><span>n</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_18593..18619"><span>numberOfLeadingZeros_range</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_20359..20363"><span>True</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xv</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>yv</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>zv</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>xv</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>yv</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>zv</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_11599..11601"><span>L1</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_19078..19079"><span>n</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_19668..19670"><span>zv</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>xv</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>yv</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>zv</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_18363..18386"><span>mod_dist_over_add_right</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_20373..20381"><span>n_bounds</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>take_bit_0</span><span> </span><span>take_bit_eq_mod</span><span> </span><span>zero_less_iff_neq_zero</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>xv</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>yv</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>zv</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>bits_mod_by_1</span><span> </span><a class="entity_ref" href="../Graph/ValueThms.html#ValueThms.mod_dist_over_add|fact"><span>mod_dist_over_add</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_20373..20381"><span>n_bounds</span></a><span> </span><span>order_le_imp_less_or_eq</span><span> </span><span>power_0</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>xv</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>zv</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_15568..15570"><span>L2</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_19078..19079"><span>n</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_19668..19670"><span>zv</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_19437..19439"><span>yv</span></a><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_18842..18847"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>and</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xv</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>zv</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>mod_mod_trivial</span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>and.idem</span><span> </span><span>take_bit_eq_mask</span><span> </span><span>take_bit_eq_mod</span><span> </span><span>word_bw_assocs</span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>and</span><span> </span><span class="skolem"><span>xv</span></span><span> </span><span class="skolem"><span>zv</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_11599..11601"><span>L1</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_19078..19079"><span>n</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_19668..19670"><span>zv</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_19038..19042"><span>eval</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_19918..19921"><span>lhs</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_20117..20120"><span>rhs</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfLeadingZeros|const"><span>numberOfLeadingZeros</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Long.html#Long.numberOfTrailingZeros|const"><span>numberOfTrailingZeros</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span class="free"><span>↑</span></span></span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="numeral"><span>64</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_18842..18847"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>yv</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_19437..19439"><span>yv</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_11599..11601"><span>L1</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_15568..15570"><span>L2</span></a><span> </span><span>add_diff_cancel_left'</span><span> </span><span>and.comm_neutral</span><span> </span><span>and.idem</span><span> </span><span>bit.compl_zero</span><span> </span><span>bit.conj_cancel_right</span><span> </span><span>bit.conj_disj_distribs</span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>bit.double_compl</span><span> </span><span>less_imp_diff_less</span><span> </span><span>linorder_not_le</span><span> </span><span>word_not_dist</span><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>add.right_neutral</span><span> </span><a class="entity_ref" href="NewAnd.html#offset_19038..19042"><span>eval</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_19918..19921"><span>lhs</span></a><span> </span><a class="entity_ref" href="NewAnd.html#offset_20117..20120"><span>rhs</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span>thm_oracles</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#offset_18848..18860"><span>improved_opt</span></a><span>

</span><span class="comment1"><span>(</span><span>*</span><span>
lemma falseBelowN_nBelowLowest:
  assumes "n ≤ Nat.size a"
  assumes "∀ i &lt; n. ¬(bit a i)"
  shows "lowestOneBit a ≥ n"
proof (cases "{i. bit a i} = {}")
  case True
  then show ?thesis unfolding lowestOneBit_def MinOrHighest_def
    using assms(1) trans_le_add1 by presburger
next
  case False
  have "n ≤ Min (Collect (bit a))"
    by (metis False Min_ge_iff assms(2) finite_bit_word linorder_le_less_linear mem_Collect_eq)
  then show ?thesis unfolding lowestOneBit_def MinOrHighest_def
    using False by presburger
qed

lemma noZeros_Count:
  fixes a :: "64 word"
  assumes "zeroCount a = 0"
  shows "i &lt; Nat.size a ⟶ bit a i"
  using assms unfolding zeroCount_def size64
  using zeroCount_finite by auto

lemma allZeros_Count:
  fixes a :: "64 word"
  assumes "zeroCount a = 64"
  shows "¬(bit a i)"
  using assms unfolding zeroCount_def size64
  using zeroCount_finite apply auto sorry

lemma zeroBits:
  fixes a :: "'a::len word"
  shows "(∀i. ¬(bit a i)) ⟷ a = 0"
  apply auto
  by (simp add: bit_word_eqI)

lemma mask_bit_iff:
  fixes a :: "'a::len word"
  assumes "n ≤ Nat.size a"
  shows "a = mask n ⟹ bit a i ⟷ i &lt; n"
  apply auto
  using Word.bit_mask_iff
   apply auto[1] using assms
  by (simp add: Word.bit_mask_iff wsst_TYs(3))

lemma maskBitCount:
  fixes a :: "'a::len word"
  assumes "n ≤ Nat.size a"
  shows "a = mask n ⟹ card {i. bit a i} = n"
  using mask_bit_iff assms
  by fastforce

lemma packedMask:
  fixes a :: "64 word"
  assumes "numberOfLeadingZeros a = zeroCount a"
  shows "a = mask (64 - numberOfLeadingZeros a)"
  using assms
proof (induction "64 - numberOfLeadingZeros a")
  case 0
  have "numberOfLeadingZeros a = 64"
    by (metis "0.hyps" local.numberOfLeadingZeros_range nat_less_le size64 zero_less_diff)
  then have "zeroCount a = 64"
    using assms by fastforce
  then have "a = 0"
    using allZeros_Count zeroBits by blast
  then show ?case
    by (simp add: "0.hyps")
next
  case (Suc x)
  then have "numberOfLeadingZeros a = 64 - Suc x"
    by (metis add_diff_cancel_right' add_diff_inverse_nat less_numeral_extra(3) nat_diff_split zero_less_Suc)
  then have "zeroCount a = 64 - Suc x"
    using assms by presburger
  from Suc show ?case sorry
qed
(*
proof (induction a)
  case zero
  then show ?case
    by (simp add: MaxOrNeg_neg highestOneBit_def numberOfLeadingZeros_def size64)
next
  case (suc a)
  then show ?case unfolding MaxOrNeg_neg highestOneBit_def numberOfLeadingZeros_def zeroCount_def
    using size64 apply auto sorry
qed
*)

lemma zerosAboveOnly:
  fixes a :: "64 word"
  assumes "numberOfLeadingZeros a = zeroCount a"
  shows "¬(bit a i) ⟶ i ≥ (64 - numberOfLeadingZeros a)"
proof -
  obtain n where n: "n = 64 - numberOfLeadingZeros a"
    by simp
  then have n_range: "n ≤ Nat.size a"
    using size64
    by presburger
  then have "a = (mask n)"
    using packedMask
    using assms n by blast
  then have "¬ bit a i ⟶ i ≥ n"
    using Word.bit_mask_iff
    by (metis (mono_tags) le_antisym linorder_le_less_linear min_def n_range word_size)
  then show ?thesis using n
    by blast
qed
</span><span>*</span><span>)</span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span>
lemma consumes: 
  assumes "numberOfLeadingZeros (↑z) + bitCount (↑z) = 64"
  and "↑z ≠ 0"
  and "and (↑y) (↑z) = 0"
  shows "numberOfLeadingZeros (↑z) + numberOfTrailingZeros (↑y) ≥ 64"
proof -
  obtain n where "n = 64 - numberOfLeadingZeros (↑z)"
    by simp
  then have "n = bitCount (↑z)"
    by (metis add_diff_cancel_left' assms(1))
  have "numberOfLeadingZeros (↑z) = zeroCount (↑z)"
    using assms(1) size64 ones_zero_sum_to_width
    by (metis add.commute add_left_imp_eq)
  then have "∀i. ¬(bit (↑z) i) ⟶ i ≥ n"
    using assms(1) zerosAboveOnly
    using ‹(n::nat) = (64::nat) - numberOfLeadingZeros (↑ (z::IRExpr))› by blast
  then have "∀ i &lt; n. bit (↑z) i"
    using leD by blast
  then have "∀ i &lt; n. ¬(bit (↑y) i)"
    using assms(3)
    by (metis bit.conj_cancel_right bit_and_iff bit_not_iff)
  then have "lowestOneBit (↑y) ≥ n"
    by (simp add: ‹(n::nat) = (64::nat) - numberOfLeadingZeros (↑ (z::IRExpr))› falseBelowN_nBelowLowest size64)
  then have "n ≤ numberOfTrailingZeros (↑y)"
    unfolding numberOfTrailingZeros_def
    by simp
  have "card {i. i &lt; n} = bitCount (↑z)"
    by (simp add: ‹(n::nat) = bitCount (↑ (z::IRExpr))›)
  then have "bitCount (↑z) ≤ numberOfTrailingZeros (↑y)"
    using ‹(n::nat) ⊑ numberOfTrailingZeros (↑ (y::IRExpr))› by auto
  then show ?thesis using assms(1) by auto
qed

thm_oracles consumes

(*
lemma wrong:
  assumes "numberOfLeadingZeros (↓z) + highestOneBit (↓z) = 64"
  assumes "↓z ≠ 0"
  assumes "and (↑y) (↓z) = 0"
  shows "exp[(x + y) &amp; z] ≥ x"
  using assms apply auto sorry

lemma wrong2:
  (* assumes "numberOfLeadingZeros (↑z) + highestOneBit (↑z) = 64" see: leadingZerosAddHighestOne *)
  assumes "↑z ≠ 0"
  assumes "and (↑y) (↑z) = 0"
  shows "exp[(x + y) &amp; z] ≥ x"
  using assms apply simp apply (rule allI)+
  subgoal premises p for m p v apply (rule impI) subgoal premises e
    print_facts
  proof -
    obtain xv where xv: "[m,p] ⊢ x ↦ xv"
      using e by auto
    obtain yv where yv: "[m,p] ⊢ y ↦ yv"
      using e by auto
    obtain zv where zv: "[m,p] ⊢ z ↦ zv"
      using e by auto
    have lhs: "v = val[(xv + yv) &amp; zv]"
      using xv yv zv
      by (smt (verit, best) BinaryExprE bin_eval.simps(1) bin_eval.simps(4) e evalDet)
    have "val[yv &amp; zv] ≠ UndefVal"
      sorry
    also have "∃b. val[yv &amp; zv] = new_int b 0"
      using intval_up_and_zero_implies_zero yv zv p(2)
      using calculation by presburger
    ultimately have rhs: "v = val[xv &amp; zv]"
      using intval_eliminate_y lhs sorry
    from lhs rhs show ?thesis sorry
  qed
  done
  done*)

lemma right:
  assumes "numberOfLeadingZeros (↑z) + bitCount (↑z) = 64"
  assumes "↑z ≠ 0"
  assumes "and (↑y) (↑z) = 0"
  shows "exp[(x + y) &amp; z] ≥ exp[x &amp; z]"
apply simp apply (rule allI)+ 
  subgoal premises p for m p v apply (rule impI) subgoal premises e
proof -
  obtain j where j: "j = highestOneBit (↑z)"
    by simp
  obtain xv b where xv: "[m,p] ⊢ x ↦ IntVal b xv"
    using e
    by (metis EvalTreeE(5) bin_eval_inputs_are_ints bin_eval_new_int new_int.simps)
  obtain yv where yv: "[m,p] ⊢ y ↦ IntVal b yv"
    using e EvalTreeE(5) bin_eval_inputs_are_ints bin_eval_new_int new_int.simps
    by (smt (verit) Value.sel(1) bin_eval.simps(1) evalDet intval_add.elims xv)
  obtain xyv where xyv: "[m, p] ⊢ exp[x + y] ↦ IntVal b xyv"
    using e EvalTreeE(5) bin_eval_inputs_are_ints bin_eval_new_int new_int.simps
    xv yv
    by (metis BinaryExpr Value.distinct(1) bin_eval.simps(1) intval_add.simps(1))
  then obtain zv where zv: "[m,p] ⊢ z ↦ IntVal b zv"
    using e EvalTreeE(5) bin_eval_inputs_are_ints bin_eval_new_int new_int.simps
    Value.sel(1) bin_eval.simps(4) evalDet intval_and.elims
    by (smt (verit) new_int_bin.simps)
  have "xyv = take_bit b (xv + yv)"
    using xv yv xyv
    by (metis BinaryExprE Value.sel(2) bin_eval.simps(1) evalDet intval_add.simps(1))
  then have "v = IntVal b (take_bit b (and (take_bit b (xv + yv)) zv))"
    using zv
    by (smt (verit) EvalTreeE(5) Value.sel(1) Value.sel(2) bin_eval.simps(4) e evalDet intval_and.elims new_int.simps new_int_bin.simps xyv)
  then have veval: "v = IntVal b (and (xv + yv) zv)"
    by (metis (no_types, lifting) eval_unused_bits_zero take_bit_eq_mask word_bw_comms(1) word_bw_lcs(1) zv)
  have obligation: "(and (xv + yv) zv) = (and xv zv) ⟹ [m,p] ⊢ BinaryExpr BinAnd x z ↦ v"
    by (smt (verit) EvalTreeE(5) Value.inject(1) ‹(v::Value) = IntVal (b::nat) (take_bit b (and (take_bit b ((xv::64 word) + (yv::64 word))) (zv::64 word)))› ‹(xyv::64 word) = take_bit (b::nat) ((xv::64 word) + (yv::64 word))› bin_eval.simps(4) e evalDet eval_unused_bits_zero evaltree.simps intval_and.simps(1) take_bit_and xv xyv zv)
  have per_bit: "∀n . bit (and (xv + yv) zv) n = bit (and xv zv) n ⟹ (and (xv + yv) zv) = (and xv zv)"
    by (simp add: bit_eq_iff)
  show ?thesis
    apply (rule obligation)
    apply (rule per_bit)
    apply (rule allI)
    subgoal for n
  proof (cases "n ≤ j")
    case True
    (*
    then have "¬(bit yv n)"
      by (metis (no_types, opaque_lifting) assms(1) assms(2) assms(3) bit_and_iff bit_not_iff impossible_bit j packed_bits ucast_id up_spec yv)
    have "∀n' . n' ≤ n ⟶ ¬(bit yv n')"
      by (metis (no_types, lifting) True assms(1) assms(2) assms(3) bit_and_iff bit_not_iff down_spec dual_order.trans j not_may_implies_false packed_bits yv)
    then have "bit (xv + yv) n = bit xv n"
      sorry using packed_bottom_zeros_elim_add
      by blast*)
    then show ?thesis sorry
      (*by (simp add: bit_and_iff)*)
  next
    case False
    then have "¬(bit zv n)"
      by (metis j linorder_not_less not_may_implies_false zerosAboveHighestOne zv)
    then have v: "¬(bit (and (xv + yv) zv) n)"
      by (simp add: bit_and_iff)
    then have v': "¬(bit (and xv zv) n)"
      by (simp add: ‹¬ bit (zv::64 word) (n::nat)› bit_and_iff)
    from v v' show ?thesis
      by simp
  qed
  done
qed
  done
  done
</span><span>*</span><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.ucast_zero|fact"><span class="entity_def" id="NewAnd.ucast_zero|thm"><span>ucast_zero</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>ucast</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Graph/Values.html#Values.int64|type"><span>int64</span></a><span class="main"><span>)</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Graph/Values.html#Values.int32|type"><span>int32</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="NewAnd.ucast_minus_one|fact"><span class="entity_def" id="NewAnd.ucast_minus_one|thm"><span>ucast_minus_one</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>ucast</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Graph/Values.html#Values.int64|type"><span>int64</span></a><span class="main"><span>)</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Graph/Values.html#Values.int32|type"><span>int32</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>transfer</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="NewAnd.simple_mask.improved_opt|fact"><span class="entity_def" id="NewAnd.simple_mask.numberOfLeadingZeros_range|fact"><span class="entity_def" id="NewAnd.simple_mask.mod_dist_over_add_right|fact"><span class="entity_def" id="NewAnd.simple_mask.unfold_binary_width_and|fact"><span class="entity_def" id="NewAnd.simple_mask.unfold_binary_width_add|fact"><span class="entity_def" id="NewAnd.simple_mask.L2|fact"><span class="entity_def" id="NewAnd.simple_mask.up_mask_upper_bound|fact"><span class="entity_def" id="NewAnd.simple_mask.L1|fact"><span class="entity_def" id="NewAnd.simple_mask.transfer_horner|fact"><span class="entity_def" id="NewAnd.simple_mask.transfer_map|fact"><span class="entity_def" id="NewAnd.simple_mask.split_horner|fact"><span class="entity_def" id="NewAnd.simple_mask.map_join_horner|fact"><span class="entity_def" id="NewAnd.simple_mask.zero_map|fact"><span class="entity_def" id="NewAnd.simple_mask.zero_horner|fact"><span class="entity_def" id="NewAnd.simple_mask.above_nth_not_set|fact"><span class="entity_def" id="NewAnd.simple_mask.leadingZeroBounds|fact"><span class="entity_def" id="NewAnd.simple_mask.exp_eliminate_y|fact"><span class="entity_def" id="NewAnd.simple_mask.intval_up_and_zero_implies_zero|fact"><span class="entity_def" id="NewAnd.simple_mask.not_down_up_mask_and_zero_implies_zero|fact"><span class="entity_def" id="NewAnd.simple_mask.up_mask_and_zero_implies_zero|fact"><span class="entity_def" id="NewAnd.simple_mask.must_implies_may|fact"><span class="entity_def" id="NewAnd.simple_mask.not_must_implies_either|fact"><span class="entity_def" id="NewAnd.simple_mask.must_implies_true|fact"><span class="entity_def" id="NewAnd.simple_mask.not_may_implies_false|fact"><span class="entity_def" id="NewAnd.simple_mask.may_implies_either|fact"><span class="entity_def" id="NewAnd.simple_mask.down_spec|fact"><span class="entity_def" id="NewAnd.simple_mask.up_spec|fact"><span class="entity_def" id="NewAnd.simple_mask.stamp_mask_axioms|fact"><span class="entity_def" id="NewAnd.simple_mask.L1|thm"><span class="entity_def" id="NewAnd.simple_mask.L2|thm"><span class="entity_def" id="NewAnd.simple_mask.up_spec|thm"><span class="entity_def" id="NewAnd.simple_mask.zero_map|thm"><span class="entity_def" id="NewAnd.simple_mask.down_spec|thm"><span class="entity_def" id="NewAnd.simple_mask.zero_horner|thm"><span class="entity_def" id="NewAnd.simple_mask.improved_opt|thm"><span class="entity_def" id="NewAnd.simple_mask.split_horner|thm"><span class="entity_def" id="NewAnd.simple_mask.transfer_map|thm"><span class="entity_def" id="NewAnd.simple_mask.map_join_horner|thm"><span class="entity_def" id="NewAnd.simple_mask.transfer_horner|thm"><span class="entity_def" id="NewAnd.simple_mask.must_implies_may|thm"><span class="entity_def" id="NewAnd.simple_mask.above_nth_not_set|thm"><span class="entity_def" id="NewAnd.simple_mask.leadingZeroBounds|thm"><span class="entity_def" id="NewAnd.simple_mask.must_implies_true|thm"><span class="entity_def" id="NewAnd.simple_mask.may_implies_either|thm"><span class="entity_def" id="NewAnd.simple_mask.up_mask_upper_bound|thm"><span class="entity_def" id="NewAnd.simple_mask.not_may_implies_false|thm"><span class="entity_def" id="NewAnd.simple_mask.mod_dist_over_add_right|thm"><span class="entity_def" id="NewAnd.simple_mask.not_must_implies_either|thm"><span class="entity_def" id="NewAnd.simple_mask.unfold_binary_width_add|thm"><span class="entity_def" id="NewAnd.simple_mask.unfold_binary_width_and|thm"><span class="entity_def" id="NewAnd.simple_mask.numberOfLeadingZeros_range|thm"><span class="entity_def" id="NewAnd.simple_mask.up_mask_and_zero_implies_zero|thm"><span class="entity_def" id="NewAnd.simple_mask.intval_up_and_zero_implies_zero|thm"><span class="entity_def" id="NewAnd.simple_mask.not_down_up_mask_and_zero_implies_zero|thm"><span class="entity_def" id="NewAnd.simple_mask.exp_eliminate_y|thm"><span class="entity_def" id="NewAnd.simple_mask.stamp_mask_axioms|thm"><span>interpretation</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> simple_mask</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.stamp_mask|locale"><span>stamp_mask</span></a><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NewAnd.html#NewAnd.IRExpr_up|const"><span>IRExpr_up</span></a><span> </span><span class="main"><span>::</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr|type"><span>IRExpr</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.int64|type"><span>int64</span></a><span>"</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="NewAnd.html#NewAnd.IRExpr_down|const"><span>IRExpr_down</span></a><span> </span><span class="main"><span>::</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr|type"><span>IRExpr</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.int64|type"><span>int64</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.IRExpr_up_def|fact"><span>IRExpr_up_def</span></a><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.IRExpr_down_def|fact"><span>IRExpr_down_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>unfold_locales</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.ucast_minus_one|fact"><span>ucast_minus_one</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>



</span><span class="keyword1"><span class="command"><span>phase</span></span></span><span> NewAnd
  </span><span class="keyword2"><span class="keyword"><span>terminating</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.size|const"><span>size</span></a></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="NewAnd.redundant_lhs_y_or_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="NewAnd.redundant_lhs_y_or|fact"><span class="entity_def" id="NewAnd.redundant_lhs_y_or_code|fact"><span class="entity_def" id="NewAnd.redundant_lhs_y_or(2)|thm"><span class="entity_def" id="NewAnd.redundant_lhs_y_or(1)|thm"><span class="entity_def" id="NewAnd.redundant_lhs_y_or_code|thm"><span class="entity_def" id="NewAnd.redundant_lhs_y_or_code_raw|axiom"><span>redundant_lhs_y_or</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Conditional|const"><span>⟼</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span>
                                </span><span class="keyword1"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Conditional|const"><span>when</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>and</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NewAnd.html#NewAnd.IRExpr_up|const"><span>IRExpr_up</span></a><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NewAnd.html#NewAnd.IRExpr_up|const"><span>IRExpr_up</span></a><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.IRExpr_up_def|fact"><span>IRExpr_up_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.simple_mask.exp_eliminate_y|fact"><span>simple_mask.exp_eliminate_y</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="NewAnd.redundant_lhs_x_or_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="NewAnd.redundant_lhs_x_or|fact"><span class="entity_def" id="NewAnd.redundant_lhs_x_or_code|fact"><span class="entity_def" id="NewAnd.redundant_lhs_x_or(2)|thm"><span class="entity_def" id="NewAnd.redundant_lhs_x_or(1)|thm"><span class="entity_def" id="NewAnd.redundant_lhs_x_or_code|thm"><span class="entity_def" id="NewAnd.redundant_lhs_x_or_code_raw|axiom"><span>redundant_lhs_x_or</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Conditional|const"><span>⟼</span></a></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>z</span></span><span>
                                </span><span class="keyword1"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Conditional|const"><span>when</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>and</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NewAnd.html#NewAnd.IRExpr_up|const"><span>IRExpr_up</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NewAnd.html#NewAnd.IRExpr_up|const"><span>IRExpr_up</span></a><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.IRExpr_up_def|fact"><span>IRExpr_up_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.simple_mask.exp_eliminate_y|fact"><span>simple_mask.exp_eliminate_y</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.exp_or_commute|fact"><span>exp_or_commute</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.mono_binary|fact"><span>mono_binary</span></a><span> </span><span>order_refl</span><span> </span><span>order_trans</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="NewAnd.redundant_rhs_y_or_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="NewAnd.redundant_rhs_y_or|fact"><span class="entity_def" id="NewAnd.redundant_rhs_y_or_code|fact"><span class="entity_def" id="NewAnd.redundant_rhs_y_or(2)|thm"><span class="entity_def" id="NewAnd.redundant_rhs_y_or(1)|thm"><span class="entity_def" id="NewAnd.redundant_rhs_y_or_code|thm"><span class="entity_def" id="NewAnd.redundant_rhs_y_or_code_raw|axiom"><span>redundant_rhs_y_or</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>z</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Conditional|const"><span>⟼</span></a></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>x</span></span><span>
                                </span><span class="keyword1"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Conditional|const"><span>when</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>and</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NewAnd.html#NewAnd.IRExpr_up|const"><span>IRExpr_up</span></a><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NewAnd.html#NewAnd.IRExpr_up|const"><span>IRExpr_up</span></a><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.IRExpr_up_def|fact"><span>IRExpr_up_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.simple_mask.exp_eliminate_y|fact"><span>simple_mask.exp_eliminate_y</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.exp_and_commute|fact"><span>exp_and_commute</span></a><span> </span><span>order.trans</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="NewAnd.redundant_rhs_x_or_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="NewAnd.redundant_rhs_x_or|fact"><span class="entity_def" id="NewAnd.redundant_rhs_x_or_code|fact"><span class="entity_def" id="NewAnd.redundant_rhs_x_or(2)|thm"><span class="entity_def" id="NewAnd.redundant_rhs_x_or(1)|thm"><span class="entity_def" id="NewAnd.redundant_rhs_x_or_code|thm"><span class="entity_def" id="NewAnd.redundant_rhs_x_or_code_raw|axiom"><span>redundant_rhs_x_or</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>z</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Conditional|const"><span>⟼</span></a></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="main"><span>&amp;</span></span><span> </span><span class="free"><span>y</span></span><span>
                                </span><span class="keyword1"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Conditional|const"><span>when</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>and</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NewAnd.html#NewAnd.IRExpr_up|const"><span>IRExpr_up</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="NewAnd.html#NewAnd.IRExpr_up|const"><span>IRExpr_up</span></a><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.IRExpr_up_def|fact"><span>IRExpr_up_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.simple_mask.exp_eliminate_y|fact"><span>simple_mask.exp_eliminate_y</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><span>dual_order.trans</span><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.exp_and_commute|fact"><span>exp_and_commute</span></a><span> </span><a class="entity_ref" href="NewAnd.html#NewAnd.exp_or_commute|fact"><span>exp_or_commute</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.mono_binary|fact"><span>mono_binary</span></a><span> </span><span>order_refl</span><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span>
optimization redundant_lhs_add: "((x + y) &amp; z) ⟼ x &amp; z
                               when ((and (IRExpr_up y) (IRExpr_down z)) = 0)"
</span><span>*</span><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span></pre>
</body>

</html>