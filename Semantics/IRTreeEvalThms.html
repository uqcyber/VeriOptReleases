<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory IRTreeEvalThms</title>
</head>


<body>
<div class="head">
<h1>Theory IRTreeEvalThms</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Data-flow Tree Theorems</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>IRTreeEvalThms</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span>
    </span><a href="IRTreeEval.html"><span>IRTreeEval</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Deterministic Data-flow Evaluation</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.evalDet|fact"><span class="entity_def" id="IRTreeEvalThms.evalDet|thm"><span>evalDet</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>v<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span> 
   </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>v<span class="hidden">⇩</span><sub>2</sub></span></span><span> </span><span class="main"><span>⟹</span></span><span>
   </span><span class="free"><span>v<span class="hidden">⇩</span><sub>1</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>v<span class="hidden">⇩</span><sub>2</sub></span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>v<span class="hidden">⇩</span><sub>2</sub></span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree.induct|fact"><span>evaltree.induct</span></a><span>"</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>elim</span></span><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.EvalTreeE|fact"><span>EvalTreeE</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.evalAllDet|fact"><span class="entity_def" id="IRTreeEvalThms.evalAllDet|thm"><span>evalAllDet</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltrees|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltrees|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltrees|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltrees|const"><span>⊢</span></a></span><span> </span><span class="free"><span>e</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltrees|const"><span>↦<span class="hidden">⇩</span><sub>L</sub></span></a></span><span> </span><span class="free"><span>v1</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
   </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltrees|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltrees|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltrees|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltrees|const"><span>⊢</span></a></span><span> </span><span class="free"><span>e</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltrees|const"><span>↦<span class="hidden">⇩</span><sub>L</sub></span></a></span><span> </span><span class="free"><span>v2</span></span><span> </span><span class="main"><span>⟹</span></span><span>
   </span><span class="free"><span>v1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>v2</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>v2</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltrees.induct|fact"><span>evaltrees.induct</span></a><span>"</span></span><span class="main"><span>)</span></span><span>
   </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>elim</span></span><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.EvalTreeE|fact"><span>EvalTreeE</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Evaluation Results are Valid</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>A valid value cannot be $UndefVal$.</span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.valid_not_undef|fact"><span class="entity_def" id="IRTreeEvalThms.valid_not_undef|thm"><span>valid_not_undef</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_621..623">a1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>val</span></span><span> </span><span class="free"><span>s</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_655..657">a2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>s</span></span><span> </span><span class="main"><span>≠</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.VoidStamp|const"><span>VoidStamp</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>val</span></span><span> </span><span class="main"><span>≠</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.UndefVal|const"><span>UndefVal</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value.elims|fact"><span>valid_value.elims</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span>val</span></span></span></span></span><span> </span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span>s</span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>True</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_621..623"><span>a1</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_655..657"><span>a2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span> Elimination rules for valid_value, for each kind of stamp. </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.valid_VoidStamp|fact"><span class="entity_def" id="IRTreeEvalThms.valid_VoidStamp|thm"><span>valid_VoidStamp</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>elim</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>val</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.VoidStamp|const"><span>VoidStamp</span></a><span> </span><span class="main"><span>⟹</span></span><span>
      </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.UndefVal|const"><span>UndefVal</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value.simps|fact"><span>valid_value.simps</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.valid_ObjStamp|fact"><span class="entity_def" id="IRTreeEvalThms.valid_ObjStamp|thm"><span>valid_ObjStamp</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>elim</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.ObjectStamp|const"><span>ObjectStamp</span></a><span> </span><span class="free"><span>klass</span></span><span> </span><span class="free"><span>exact</span></span><span> </span><span class="free"><span>nonNull</span></span><span> </span><span class="free"><span>alwaysNull</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>∃</span></span><span class="bound"><span>v</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.ObjRef|const"><span>ObjRef</span></a><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value.simps|fact"><span>valid_value.simps</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool.cases|fact"><span>val_to_bool.cases</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.valid_int32|fact"><span class="entity_def" id="IRTreeEvalThms.valid_int32|thm"><span>valid_int32</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>elim</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>32</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>∃</span></span><span class="bound"><span>v</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal32|const"><span>IntVal32</span></a><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool.cases|fact"><span>val_to_bool.cases</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span>val</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.distinct|fact"><span>Value.distinct</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
                    
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.valid_int64|fact"><span class="entity_def" id="IRTreeEvalThms.valid_int64|thm"><span>valid_int64</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>elim</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>64</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>h</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>∃</span></span><span class="bound"><span>v</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal64|const"><span>IntVal64</span></a><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool.cases|fact"><span>val_to_bool.cases</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span>val</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.distinct|fact"><span>Value.distinct</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.valid_value_elims|fact"><span class="entity_def" id="IRTreeEvalThms.valid_value_elims(4)|thm"><span class="entity_def" id="IRTreeEvalThms.valid_value_elims(3)|thm"><span class="entity_def" id="IRTreeEvalThms.valid_value_elims(2)|thm"><span class="entity_def" id="IRTreeEvalThms.valid_value_elims(1)|thm"><span>valid_value_elims</span></span></span></span></span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.valid_VoidStamp|fact"><span>valid_VoidStamp</span></a><span>
  </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.valid_ObjStamp|fact"><span>valid_ObjStamp</span></a><span>
  </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.valid_int32|fact"><span>valid_int32</span></a><span>
  </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.valid_int64|fact"><span>valid_int64</span></a><span>


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.evaltree_not_undef|fact"><span class="entity_def" id="IRTreeEvalThms.evaltree_not_undef|thm"><span>evaltree_not_undef</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>e</span></span><span> </span><span class="free"><span>v</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><span>≠</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.UndefVal|const"><span>UndefVal</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree.induct|fact"><span>evaltree.induct</span></a><span>"</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.valid_not_undef|fact"><span>valid_not_undef</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.leafint32|fact"><span class="entity_def" id="IRTreeEvalThms.leafint32|thm"><span>leafint32</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_1803..1805">ev</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.LeafExpr|const"><span>LeafExpr</span></a><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>32</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>val</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∃</span></span><span class="bound"><span>v</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal32|const"><span>IntVal32</span></a><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="comment1"><span>(</span><span>*</span><span> Note: we could also add: ...∧ lo ≤ sint v ∧ sint v ≤ hi </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>32</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_1803..1805"><span>ev</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.LeafExprE|fact"><span>LeafExprE</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.leafint64|fact"><span class="entity_def" id="IRTreeEvalThms.leafint64|thm"><span>leafint64</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_2111..2113">ev</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.LeafExpr|const"><span>LeafExpr</span></a><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>64</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>val</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∃</span></span><span class="bound"><span>v</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal64|const"><span>IntVal64</span></a><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="comment1"><span>(</span><span>*</span><span> Note: we could also add: ...∧ lo ≤ sint v ∧ sint v ≤ hi </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>64</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_2111..2113"><span>ev</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.LeafExprE|fact"><span>LeafExprE</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.default_stamp|fact"><span class="entity_def" id="IRTreeEvalThms.default_stamp|thm"><span>default_stamp</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.default_stamp|const"><span>default_stamp</span></a><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>32</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="numeral"><span>2147483648</span></span><span class="main"><span>)</span></span><span> </span><span class="numeral"><span>2147483647</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.default_stamp_def|fact"><span>default_stamp_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2512..2517">lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.valid32|fact"><span class="entity_def" id="IRTreeEvalThms.valid32|thm"><span>valid32</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>32</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∃</span></span><span class="bound"><span>v</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>val</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal32|const"><span>IntVal32</span></a><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span>sint</span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span>sint</span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_2512..2517"><span>assms</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.valid_int32|fact"><span>valid_int32</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span> 

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2686..2691">lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.valid64|fact"><span class="entity_def" id="IRTreeEvalThms.valid64|thm"><span>valid64</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>val</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>64</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∃</span></span><span class="bound"><span>v</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>val</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal64|const"><span>IntVal64</span></a><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span>sint</span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span>sint</span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_2686..2691"><span>assms</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.valid_int64|fact"><span>valid_int64</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2859..2864">lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.valid32or64|fact"><span class="entity_def" id="IRTreeEvalThms.valid32or64|thm"><span>valid32or64</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>∃</span></span><span> </span><span class="bound"><span>v1</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal32|const"><span>IntVal32</span></a><span> </span><span class="bound"><span>v1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∨</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∃</span></span><span> </span><span class="bound"><span>v2</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal64|const"><span>IntVal64</span></a><span> </span><span class="bound"><span>v2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.valid32|fact"><span>valid32</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.valid64|fact"><span>valid64</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_2859..2864"><span>assms</span></a><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value.elims|fact"><span>valid_value.elims</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3052..3057">lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.valid32or64_both|fact"><span class="entity_def" id="IRTreeEvalThms.valid32or64_both|thm"><span>valid32or64_both</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lox</span></span><span> </span><span class="free"><span>hix</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>loy</span></span><span> </span><span class="free"><span>hiy</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>∃</span></span><span> </span><span class="bound"><span>v1</span></span><span> </span><span class="bound"><span>v2</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal32|const"><span>IntVal32</span></a><span> </span><span class="bound"><span>v1</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal32|const"><span>IntVal32</span></a><span> </span><span class="bound"><span>v2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∨</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∃</span></span><span> </span><span class="bound"><span>v3</span></span><span> </span><span class="bound"><span>v4</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal64|const"><span>IntVal64</span></a><span> </span><span class="bound"><span>v3</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal64|const"><span>IntVal64</span></a><span> </span><span class="bound"><span>v4</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_3052..3057"><span>assms</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.valid32or64|fact"><span>valid32or64</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.valid32|fact"><span>valid32</span></a><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value.elims|fact"><span>valid_value.elims</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value.simps|fact"><span>valid_value.simps</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Example Data-flow Optimisations</span><span>›</span></span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span> An example refinement: a + 0 = a </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.a0a_helper|fact"><span class="entity_def" id="IRTreeEvalThms.a0a_helper|thm"><span>a0a_helper</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_3486..3487">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>32</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_add|const"><span>intval_add</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal32|const"><span>IntVal32</span></a><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>v</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>v32</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../Graph/Values.html#Values.int32|type"><span>int32</span></a></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>v</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal32|const"><span>IntVal32</span></a><span> </span><span class="skolem"><span>v32</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_3486..3487"><span>a</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.valid32|fact"><span>valid32</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.a0a|fact"><span class="entity_def" id="IRTreeEvalThms.a0a|thm"><span>a0a</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRBinaryOp.BinAdd|const"><span>BinAdd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.LeafExpr|const"><span>LeafExpr</span></a><span> </span><span class="main"><span>1</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.default_stamp|const"><span>default_stamp</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.ConstantExpr|const"><span>ConstantExpr</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal32|const"><span>IntVal32</span></a><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
              </span><span class="main"><span>≥</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.LeafExpr|const"><span>LeafExpr</span></a><span> </span><span class="main"><span>1</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.default_stamp|const"><span>default_stamp</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree.LeafExpr|fact"><span>evaltree.LeafExpr</span></a><span class="main"><span>)</span></span><span>


</span><span class="comment1"><span>(</span><span>*</span><span> Another example refinement: x + (y - x) ≥ y </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3908..3913">lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.xyx_y_helper|fact"><span class="entity_def" id="IRTreeEvalThms.xyx_y_helper|thm"><span>xyx_y_helper</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>32</span></span><span> </span><span class="free"><span>lox</span></span><span> </span><span class="free"><span>hix</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>32</span></span><span> </span><span class="free"><span>loy</span></span><span> </span><span class="free"><span>hiy</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.intval_add|const"><span>intval_add</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub|const"><span>intval_sub</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x32</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../Graph/Values.html#Values.int32|type"><span>int32</span></a></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_4119..4120">x</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal32|const"><span>IntVal32</span></a><span> </span><span class="skolem"><span>x32</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_3908..3913"><span>assms</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.valid32|fact"><span>valid32</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y32</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../Graph/Values.html#Values.int32|type"><span>int32</span></a></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_4200..4201">y</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal32|const"><span>IntVal32</span></a><span> </span><span class="skolem"><span>y32</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_3908..3913"><span>assms</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.valid32|fact"><span>valid32</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_4119..4120"><span>x</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_4200..4201"><span>y</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.xyx_y|fact"><span class="entity_def" id="IRTreeEvalThms.xyx_y|thm"><span>xyx_y</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRBinaryOp.BinAdd|const"><span>BinAdd</span></a><span>
     </span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.LeafExpr|const"><span>LeafExpr</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>32</span></span><span> </span><span class="free"><span>lox</span></span><span> </span><span class="free"><span>hix</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRBinaryOp.BinSub|const"><span>BinSub</span></a><span>
       </span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.LeafExpr|const"><span>LeafExpr</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>32</span></span><span> </span><span class="free"><span>loy</span></span><span> </span><span class="free"><span>hiy</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.LeafExpr|const"><span>LeafExpr</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>32</span></span><span> </span><span class="free"><span>lox</span></span><span> </span><span class="free"><span>hix</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
   </span><span class="main"><span>≥</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.LeafExpr|const"><span>LeafExpr</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>32</span></span><span> </span><span class="free"><span>loy</span></span><span> </span><span class="free"><span>hiy</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree.LeafExpr|fact"><span>LeafExpr</span></a><span class="main"><span>)</span></span><span>



</span><span class="keyword1"><span class="command"><span>subsubsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Monotonicity of Expression Refinement</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>We prove that each subexpression position is monotonic.
</span><span>That is, optimizing a subexpression anywhere deep inside a top-level expression
</span><span>also optimizes that top-level expression.  
</span><span>
</span><span>Note that we might also be able to do
</span><span>this via reusing Isabelle's 'mono' operator (HOL.Orderings theory), proving instantiations
</span><span>like 'mono (UnaryExpr op)', but it is not obvious how to do this for both arguments
</span><span>of the binary expressions.</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5052..5057">lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.mono_unary|fact"><span class="entity_def" id="IRTreeEvalThms.mono_unary|thm"><span>mono_unary</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>e</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="free"><span>e'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.UnaryExpr|const"><span>UnaryExpr</span></a><span> </span><span class="free"><span>op</span></span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.UnaryExpr|const"><span>UnaryExpr</span></a><span> </span><span class="free"><span>op</span></span><span> </span><span class="free"><span>e'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree.UnaryExpr|fact"><span>UnaryExpr</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_5052..5057"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5170..5175">lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.mono_binary|fact"><span class="entity_def" id="IRTreeEvalThms.mono_binary|thm"><span>mono_binary</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="free"><span>x'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="free"><span>y'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><span class="free"><span>op</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><span class="free"><span>op</span></span><span> </span><span class="free"><span>x'</span></span><span> </span><span class="free"><span>y'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree.BinaryExpr|fact"><span>BinaryExpr</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_5170..5175"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5316..5321">lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.never_void|fact"><span class="entity_def" id="IRTreeEvalThms.never_void|thm"><span>never_void</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="free"><span>m</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="free"><span>p</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="free"><span>xv</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>xv</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.stamp_expr|const"><span>stamp_expr</span></a><span> </span><span class="free"><span>xe</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.stamp_expr|const"><span>stamp_expr</span></a><span> </span><span class="free"><span>xe</span></span><span> </span><span class="main"><span>≠</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.VoidStamp|const"><span>VoidStamp</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value.simps|fact"><span>valid_value.simps</span></a><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_5316..5321"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.stamp32|fact"><span class="entity_def" id="IRTreeEvalThms.stamp32|thm"><span>stamp32</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∃</span></span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xv</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal32|const"><span>IntVal32</span></a><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>⟷</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>xv</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>32</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.valid_int32|fact"><span>valid_int32</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.inject|fact"><span>Value.inject</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>zero_neq_one</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.stamp64|fact"><span class="entity_def" id="IRTreeEvalThms.stamp64|thm"><span>stamp64</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>∃</span></span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>xv</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal64|const"><span>IntVal64</span></a><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>⟷</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>xv</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="numeral"><span>64</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.valid_int64|fact"><span>valid_int64</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.inject|fact"><span>Value.inject</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>zero_neq_one</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.stamprange|fact"><span class="entity_def" id="IRTreeEvalThms.stamprange|thm"><span>stamprange</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>s</span></span><span> </span><span class="main"><span>⟶</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∃</span></span><span class="bound"><span>b</span></span><span> </span><span class="bound"><span>lo</span></span><span> </span><span class="bound"><span>hi</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>s</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="bound"><span>b</span></span><span> </span><span class="bound"><span>lo</span></span><span> </span><span class="bound"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>32</span></span><span> </span><span class="main"><span>∨</span></span><span> </span><span class="bound"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>64</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value.elims|fact"><span>valid_value.elims</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.stamp32|fact"><span>stamp32</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.stamp64|fact"><span>stamp64</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> del_insts</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.compatible_trans|fact"><span class="entity_def" id="IRTreeEvalThms.compatible_trans|thm"><span>compatible_trans</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.compatible|const"><span>compatible</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>∧</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.compatible|const"><span>compatible</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.compatible|const"><span>compatible</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>z</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.compatible.elims|fact"><span>compatible.elims</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.compatible.simps|fact"><span>compatible.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.compatible_refl|fact"><span class="entity_def" id="IRTreeEvalThms.compatible_refl|thm"><span>compatible_refl</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.compatible|const"><span>compatible</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.compatible|const"><span>compatible</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.compatible.elims|fact"><span>compatible.elims</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span>
lemma tmp:
  assumes "[m, p] ⊢ xe ↦ xv"
  shows "valid_value xv (stamp_expr xe)"
  sorry (* proved later *)

lemma helping:
  assumes "[m, p] ⊢ xe ↦ xv"
  assumes "∀m p v. ([m,p] ⊢ xe ↦ v) ⟶ [m,p] ⊢ ye ↦ v"
  shows "compatible (stamp_expr xe) (stamp_expr ye)"
proof -
  have "[m, p] ⊢ ye ↦ xv"
    using assms(1,2)
    by blast
  then have "valid_value xv (stamp_expr ye)"
    using tmp by simp
  then show ?thesis using stamprange
      apply (cases "∃v. xv = IntVal32 v")
    using assms(2) valid_value.elims(2)
    using assms(1) tmp apply fastforce
    by (smt (verit, del_insts) assms(1) compatible.simps(1) tmp valid_value.elims(2))
qed
</span><span>*</span><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6874..6879">lemma</span></span></span><span> </span><span class="entity_def" id="IRTreeEvalThms.mono_conditional|fact"><span class="entity_def" id="IRTreeEvalThms.mono_conditional|thm"><span>mono_conditional</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>ce</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="free"><span>ce'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>te</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="free"><span>te'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>fe</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="free"><span>fe'</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.ConditionalExpr|const"><span>ConditionalExpr</span></a><span> </span><span class="free"><span>ce</span></span><span> </span><span class="free"><span>te</span></span><span> </span><span class="free"><span>fe</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>≥</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.ConditionalExpr|const"><span>ConditionalExpr</span></a><span> </span><span class="free"><span>ce'</span></span><span> </span><span class="free"><span>te'</span></span><span> </span><span class="free"><span>fe'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.le_expr_def|fact"><span>le_expr_def</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>allI</span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><span>impI</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="skolem"><span>p</span></span><span> </span><span class="skolem"><span>v</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_7108..7109">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.ConditionalExpr|const"><span>ConditionalExpr</span></a><span> </span><span class="free"><span>ce</span></span><span> </span><span class="free"><span>te</span></span><span> </span><span class="free"><span>fe</span></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>v</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>cond</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_7175..7177">ce</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>ce</span></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>cond</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7219..7222">ce'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>ce'</span></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>cond</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_6874..6879"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="comment1"><span>(</span><span>*</span><span>have co: "compatible (stamp_expr te) (stamp_expr fe)"
    using a by auto</span><span>*</span><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>branch</span></span></span><span>  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_7368..7369">b</span><span class="main"><span>:</span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>branch</span></span><span>  </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool|const"><span>val_to_bool</span></a><span> </span><span class="skolem"><span>cond</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="free"><span>te</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="free"><span>fe</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>branch'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_7445..7447">b'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>branch'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool|const"><span>val_to_bool</span></a><span> </span><span class="skolem"><span>cond</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="free"><span>te'</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="free"><span>fe'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7513..7518">beval</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>branch</span></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>v</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_7108..7109"><span>a</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_7368..7369"><span>b</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_7175..7177"><span>ce</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span> 
  </span><span class="comment1"><span>(</span><span>*</span><span>then have "compatible (stamp_expr branch) (stamp_expr branch')"
      using helping
      using assms(2) assms(3) b b' by force
  then have compatible: "compatible (stamp_expr te') (stamp_expr fe')"
    using compatible_trans co compatible_refl
    proof (cases "val_to_bool cond")
      case True
      then have "branch = te"
        using b by simp
      from True have "branch' = te'"
        using b' by simp
      then have "compatible (stamp_expr te) (stamp_expr te')"
        using ‹branch = te› ‹compatible (stamp_expr branch) (stamp_expr branch')› by blast
      then have "compatible (stamp_expr fe) (stamp_expr fe')"
        using co compatible_trans compatible_refl sorry
      then show ?thesis
        using ‹compatible (stamp_expr te) (stamp_expr te')› co compatible_refl compatible_trans by blast
    next
      case False
      then show ?thesis sorry
    qed</span><span>*</span><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_7513..7518"><span>beval</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="skolem"><span>branch'</span></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>v</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_6874..6879"><span>assms</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_7368..7369"><span>b</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_7445..7447"><span>b'</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.IRExpr.ConditionalExpr|const"><span>ConditionalExpr</span></a><span> </span><span class="free"><span>ce'</span></span><span> </span><span class="free"><span>te'</span></span><span> </span><span class="free"><span>fe'</span></span><span> </span><span class="main"><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>v</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEval.html#IRTreeEval.evaltree.ConditionalExpr|fact"><span>ConditionalExpr</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_7219..7222"><span>ce'</span></a><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_7445..7447"><span>b'</span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="IRTreeEvalThms.html#offset_7108..7109"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span>
Step 3: if e1 isrefby e2 then g[e1] isREFby g[e2]
   Note: This needs to go after IRStepObj.thy.


lemma graph_refined:
  assumes "e1 ≥ e2"
  assumes "g ◃ e1 ↝ (g1, x1)"
  assumes "g ◃ e2 ↝ (g2, x2)"
  shows "∀ m m' h h'. (g ⊢ (x1, m, h) → (nid, m', h'))
                  ⟶ (g ⊢ (x2, m, h) → (nid, m', h'))"
</span><span>*</span><span>)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span></pre>
</body>

</html>