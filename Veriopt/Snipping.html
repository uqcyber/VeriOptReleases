<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Snipping</title>
</head>


<body>
<div class="head">
<h1>Theory Snipping</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command">section</span></span> <span class="plain_text">Snipping</span>

<span class="keyword1"><span class="command">theory</span></span> Snipping
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="../../HOL/HOL/Main.html">Main</a>
  <span class="keyword2"><span class="keyword">keywords</span></span>
    <span class="quoted">"snipbegin"</span> <span class="main">::</span> document_heading <span class="keyword2"><span class="keyword">and</span></span>
    <span class="quoted">"snipend"</span> <span class="main">::</span> document_heading
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Snippets allow specific components of the LaTeX document preparation to be included in other documents.›</span></span>

<span class="keyword1"><span class="command">ML</span></span> <span class="quoted">‹
<span class="comment1">(*
I thought the document_command was what generated the LaTeX output,
however, it appears to be hard-coded which makes this a bit of a hack.
*)</span>
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">wrapped_command</span> <span class="main">(</span><span class="entity">command</span><span class="main">:</span> string<span class="main">)</span> <span class="main">(</span><span class="entity">name</span><span class="main">:</span> string option<span class="main">)</span> <span class="main">=</span>
  <span class="keyword2"><span class="keyword">let</span></span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">command</span> <span class="main">=</span> <span class="inner_quoted">"\\"</span> ^ <span class="entity">command</span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">argument</span> <span class="main">=</span> <span class="keyword2"><span class="keyword">case</span></span> <span class="entity">name</span> <span class="keyword2"><span class="keyword">of</span></span>
      NONE <span class="main">=&gt;</span> <span class="inner_quoted">""</span> <span class="main">|</span>
      SOME <span class="entity">v</span> <span class="main">=&gt;</span> <span class="main">(</span><span class="inner_quoted">"{"</span> ^ <span class="entity">v</span> ^ <span class="inner_quoted">"}"</span><span class="main">)</span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">doc</span> <span class="main">=</span> Input.string <span class="main">(</span><span class="entity">command</span> ^ <span class="entity">argument</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">in</span></span>
    <span class="main">(</span><span class="entity">Pure_Syn.document_command</span> <span class="main">{</span>markdown <span class="main">=</span> false<span class="main">}</span> <span class="main">(</span>NONE<span class="main">,</span> <span class="entity">doc</span><span class="main">)</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="keyword">val</span></span> <span class="main">_</span> <span class="main">=</span>
  <span class="entity">Outer_Syntax.command</span> <span class="main">(</span><span class="inner_quoted">"snipbegin"</span><span class="main">,</span> <span class="antiquoted"><span class="operator"><span class="entity">⌂</span></span></span><span class="main">)</span> <span class="inner_quoted">"start a snippet"</span>
    <span class="main">(</span>Parse.document_source &gt;&gt; <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">n</span> <span class="main">=&gt;</span> <span class="entity">wrapped_command</span> <span class="inner_quoted">"isamarkupsnipbegin"</span> <span class="main">(</span>SOME <span class="main">(</span>Input.string_of <span class="entity">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">;</span>

<span class="keyword1"><span class="keyword">val</span></span> <span class="main">_</span> <span class="main">=</span>
  <span class="entity">Outer_Syntax.command</span> <span class="main">(</span><span class="inner_quoted">"snipend"</span><span class="main">,</span> <span class="antiquoted"><span class="operator"><span class="entity">⌂</span></span></span><span class="main">)</span> <span class="inner_quoted">"finish a snippet"</span>
    <span class="main">(</span>Parse.document_source &gt;&gt; <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="main">_</span> <span class="main">=&gt;</span> <span class="entity">wrapped_command</span> <span class="inner_quoted">"isamarkupsnipend"</span> <span class="main">(</span>NONE<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">;</span>
›</span>

<span class="comment1">(*
text ‹
To use snippets, in your LaTeX preamble,
replace the command \verb|\isamarkupsnipbegin| with the start of a snippet,
and replace \verb|\isamarkupsnipend| with the end of a snippet.

By default snippets are placed into tcolorboxes.
›

text_raw ‹
\verbatim
\newcommand{\isamarkupsnipbegin}[1]{\begin{tcolorbox}[title=#1]}
\newcommand{\isamarkupsnipend}[1]{\end{tcolorbox}}
\end{verbatim}
›
*)</span>

<span class="comment1">(*text_raw ‹
\newcommand{\isamarkupsnipbegin}[1]{\begin{tcolorbox}[title=#1]}
\newcommand{\isamarkupsnipend}[1]{\end{tcolorbox}}
›*)</span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Snippets should be enclosed within the <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">command</span></span> snipbegin<span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">command</span></span> snipend<span class="antiquote"><span class="antiquote">}</span></span></span></span> commands.

For example, the box below is produced by the following:
›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">command</span></span> snipbegin<span class="antiquote"><span class="antiquote">}</span></span></span></span> ``snip-example''

<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">command</span></span> text<span class="antiquote"><span class="antiquote">}</span></span></span></span> ``Hello world!''

<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">command</span></span> snipend<span class="antiquote"><span class="antiquote">}</span></span></span></span>
›</span></span>

<span class="keyword1"><span class="command">snipbegin</span></span> <span class="quoted">‹snip-example›</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Hello world!›</span></span>

<span class="keyword1"><span class="command">snipend</span></span> -

<span class="keyword2"><span class="keyword">end</span></span></pre>
</body>

</html>