<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory TreeSnippets</title>
</head>


<body>
<div class="head">
<h1>Theory TreeSnippets</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Verifying term graph optimizations using Isabelle/HOL›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="TreeSnippets.html"><span>TreeSnippets</span></a><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span>
    </span><a href="../Canonicalizations/BinaryNode.html"><span>Canonicalizations.BinaryNode</span></a><span>
    </span><a href="../Canonicalizations/ConditionalPhase.html"><span>Canonicalizations.ConditionalPhase</span></a><span>
    </span><a href="../Canonicalizations/AddPhase.html"><span>Canonicalizations.AddPhase</span></a><span>
    </span><a href="../Semantics/TreeToGraphThms.html"><span>Semantics.TreeToGraphThms</span></a><span>
    </span><a href="../Semantics/Snippets.Snipping.html"><span>Snippets.Snipping</span></a><span>
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Library/OptionalSugar.html"><span>HOL-Library.OptionalSugar</span></a><span>"</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="comment1"><span>― ‹First, we disable undesirable markup.›</span></span><span>
</span><span class="keyword1"><span class="command"><span>declare</span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>[</span></span><span class="operator"><span>show_types</span></span><span class="main"><span class="main"><span>=</span></span></span><span class="quasi_keyword"><span>false</span></span><span class="main"><span>,</span></span><span class="operator"><span>show_sorts</span></span><span class="main"><span class="main"><span>=</span></span></span><span class="quasi_keyword"><span>false</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>
</span><span class="keyword1"><span class="command"><span>no_notation</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.ConditionalExpr|const"><span>ConditionalExpr</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"_ </span><span class="keyword1"><span>?</span></span><span> _ </span><span class="keyword1"><span>:</span></span><span> _"</span></span><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>― ‹We want to disable and reduce how aggressive automated tactics are as obligations are generated in the paper›</span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.unfold_size.unfold_size|method"><span>method</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.unfold_size|method"><span>unfold_size</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="operator"><span>-</span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.unfold_optimization.unfold_optimization|method"><span>method</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.unfold_optimization|method"><span>unfold_optimization</span></span><span> </span><span class="main"><span>=</span></span><span> 
  </span><span class="main"><span>(</span></span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.rewrite_preservation.simps|fact"><span>rewrite_preservation.simps</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.rewrite_termination.simps|fact"><span>rewrite_termination.simps</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span>
    </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjE|fact"><span>conjE</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.le_expr_def|fact"><span>le_expr_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Markup syntax for common operations›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><span class="main"><span>(</span></span><span>latex</span><span class="main"><span>)</span></span><span>
  </span><a class="entity_ref" href="../Graph/IRGraph.html#IRGraph.kind|const"><span>kind</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"_</span><span class="keyword1"><span>⟪</span></span><span>_</span><span class="keyword1"><span>⟫</span></span><span>"</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><span class="main"><span>(</span></span><span>latex</span><span class="main"><span>)</span></span><span>
  </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.stamp_expr|const"><span>stamp_expr</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span><span class="hidden">\&lt;^</span><span class="control">latex</span><span class="hidden">&gt;</span>‹\\pitchfork›</span></span><span> _"</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><span class="main"><span>(</span></span><span>latex</span><span class="main"><span>)</span></span><span>
  </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"_ </span><span class="keyword1"><span>∈</span></span><span> _"</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><span class="main"><span>(</span></span><span>latex</span><span class="main"><span>)</span></span><span>
  </span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool|const"><span>val_to_bool</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"_</span><span class="keyword1"><span><span class="hidden">\&lt;^</span><span class="control">latex</span><span class="hidden">&gt;</span>‹\\ensuremath{_{\\mathit{›bool<span class="hidden">\&lt;^</span><span class="control">latex</span><span class="hidden">&gt;</span>‹}}}›</span></span><span>"</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><span class="main"><span>(</span></span><span>latex</span><span class="main"><span>)</span></span><span>
  </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.constantAsStamp|const"><span>constantAsStamp</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span><span class="hidden">\&lt;^</span><span class="control">latex</span><span class="hidden">&gt;</span>‹stamp-from-value›</span></span><span> _"</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><span class="main"><span>(</span></span><span>latex</span><span class="main"><span>)</span></span><span>
  </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.find_node_and_stamp|const"><span>find_node_and_stamp</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span><span class="hidden">\&lt;^</span><span class="control">latex</span><span class="hidden">&gt;</span>‹find-matching›</span></span><span> _"</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><span class="main"><span>(</span></span><span>latex</span><span class="main"><span>)</span></span><span>
  </span><a class="entity_ref" href="../Graph/IRGraph.html#IRGraph.add_node|const"><span>add_node</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span><span class="hidden">\&lt;^</span><span class="control">latex</span><span class="hidden">&gt;</span>‹insert›</span></span><span> _"</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><span class="main"><span>(</span></span><span>latex</span><span class="main"><span>)</span></span><span>
  </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.get_fresh_id|const"><span>get_fresh_id</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span><span class="hidden">\&lt;^</span><span class="control">latex</span><span class="hidden">&gt;</span>‹fresh-id›</span></span><span> _"</span></span><span class="main"><span>)</span></span><span>



</span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><span class="main"><span>(</span></span><span>latex</span><span class="main"><span>)</span></span><span>
  </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.size|const"><span>size</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span><span class="hidden">\&lt;^</span><span class="control">latex</span><span class="hidden">&gt;</span>‹trm(›</span></span><span>_</span><span class="keyword1"><span><span class="hidden">\&lt;^</span><span class="control">latex</span><span class="hidden">&gt;</span>‹)›</span></span><span>"</span></span><span class="main"><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Representing canonicalization optimizations›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
We wish to provide an example of the semantics layers 
at which optimizations can be expressed.
›</span></span></span><span>

</span><span class="comment1"><span>― ‹Algebraic laws›</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="TreeSnippets.diff_self|fact"><span class="entity_def" id="TreeSnippets.diff_self|thm"><span>diff_self</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|type"><span>int</span></a></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="TreeSnippets.diff_diff_cancel|fact"><span class="entity_def" id="TreeSnippets.diff_diff_cancel|thm"><span>diff_diff_cancel</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|type"><span>int</span></a></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>thm</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.diff_self|fact"><span>diff_self</span></a><span>
</span><span class="keyword1"><span class="command"><span>thm</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.diff_diff_cancel|fact"><span>diff_diff_cancel</span></a><span>
</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹algebraic-laws›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹\begin{align}
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.diff_self|fact"><span>diff_self</span></a><span class="main"><span>[</span></span><span class="operator"><span>show_types</span></span><span class="main"><span class="main"><span>=</span></span></span><span class="quasi_keyword"><span class="quasi_keyword"><span>false</span></span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>\\
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.diff_diff_cancel|fact"><span>diff_diff_cancel</span></a><span class="main"><span>[</span></span><span class="operator"><span>show_types</span></span><span class="main"><span class="main"><span>=</span></span></span><span class="quasi_keyword"><span class="quasi_keyword"><span>false</span></span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>
\end{align}›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="comment1"><span>― ‹Values›</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="TreeSnippets.diff_self_value|fact"><span class="entity_def" id="TreeSnippets.diff_self_value|thm"><span>diff_self_value</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>x</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'a</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Type_Length.html#Type_Length.len|class"><span>len</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Word.html#Word.word|type"><span>word</span></a><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="TreeSnippets.diff_diff_cancel_value|fact"><span class="entity_def" id="TreeSnippets.diff_diff_cancel_value|thm"><span>diff_diff_cancel_value</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>::</span></span><span class="tfree"><span>'a</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Type_Length.html#Type_Length.len|class"><span>len</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Word.html#Word.word|type"><span>word</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="bound"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹algebraic-laws-values›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text_raw</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹\begin{align}
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.diff_self_value|fact"><span>diff_self_value</span></a><span class="main"><span>[</span></span><span class="operator"><span>show_types</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span> \label{prop-v-minus-v}\\
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.diff_diff_cancel_value|fact"><span>diff_diff_cancel_value</span></a><span class="main"><span>[</span></span><span class="operator"><span>show_types</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span> \label{prop-redundant-sub}
\end{align}›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="comment1"><span>― ‹Expression›</span></span><span>
</span><span class="keyword1"><span class="command"><span>translations</span></span></span><span>
  </span><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span>"</span></span><span> </span><span class="main"><span>&lt;=</span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.ConstantExpr|const"><span>ConstantExpr</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
  </span><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>y</span></span><span>"</span></span><span> </span><span class="main"><span>&lt;=</span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinSub|const"><span>BinSub</span></a><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span><span>
</span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><span class="main"><span>(</span></span><span>ExprRule </span><span class="keyword2"><span class="keyword"><span>output</span></span></span><span class="main"><span>)</span></span><span>
  </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.Refines|const"><span>Refines</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"_ </span><span class="keyword1"><span>⟼</span></span><span> _"</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2278..2283">lemma</span></span></span><span> </span><span class="entity_def" id="TreeSnippets.diff_self_expr|fact"><span class="entity_def" id="TreeSnippets.diff_self_expr|thm"><span>diff_self_expr</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>m</span></span><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>v</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="bound"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>v</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="keyword1"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConstantNotation|const"><span>const</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_2278..2283"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.val_to_bool.simps|fact"><span>val_to_bool.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.zero_neq_one_class.zero_neq_one|fact"><span>zero_neq_one</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.open_eval.open_eval|method"><span>method</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.open_eval|method"><span>open_eval</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.impI|fact"><span>impI</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.allI|fact"><span>allI</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.impI|fact"><span>impI</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="TreeSnippets.diff_diff_cancel_expr|fact"><span class="entity_def" id="TreeSnippets.diff_diff_cancel_expr|thm"><span>diff_diff_cancel_expr</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>y</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.open_eval|method"><span class="operator"><span>open_eval</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> </span><span class="entity_def" id="offset_2660..2664">eval</span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> m p v
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>vx</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_2705..2707">vx</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>vx</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_2660..2664"><span>eval</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>vy</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_2773..2775">vy</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="skolem"><span>vy</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_2660..2664"><span>eval</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2835..2836">e</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="skolem"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="skolem"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="keyword1"><span>val[</span></span><span class="skolem"><span>vx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>vx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>vy</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_2705..2707"><span>vx</span></a><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_2773..2775"><span>vy</span></a><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_2660..2664"><span>eval</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/SMT/smt_systems.ML.html#SMT.smt|method"><span class="operator"><span>smt</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_SIG</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval.simps|fact"><span>bin_eval.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.unfold_binary|fact"><span>unfold_binary</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2998..3003">notUn</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="skolem"><span>vx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>vx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>vy</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.UndefVal|const"><span>UndefVal</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evaltree_not_undef|fact"><span>evaltree_not_undef</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="skolem"><span>vx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>vx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>vy</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>vy</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="skolem"><span>vx</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="skolem"><span>vy</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_2998..3003"><span>notUn</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.eval_unused_bits_zero|fact"><span>eval_unused_bits_zero</span></a><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_2773..2775"><span>vy</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.intval_sub.simps|fact"><span>intval_sub.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>6</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_2835..2836"><span>e</span></a><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_2660..2664"><span>eval</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_2773..2775"><span>vy</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span>thm_oracles</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.diff_diff_cancel_expr|fact"><span>diff_diff_cancel_expr</span></a><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹algebraic-laws-expressions›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text_raw</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹\begin{align}
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=ExprRule] </span><span class="main"><span>(</span></span><span class="operator"><span>concl</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.diff_self_expr|fact"><span>diff_self_expr</span></a><span class="antiquote"><span>}</span></span></span><span> \label{prop-MinusSame} \\
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=ExprRule] </span><span class="main"><span>(</span></span><span class="operator"><span>concl</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.diff_diff_cancel_expr|fact"><span>diff_diff_cancel_expr</span></a><span class="antiquote"><span>}</span></span></span><span>
\end{align}›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
</span><span class="keyword1"><span class="command"><span>no_translations</span></span></span><span>
  </span><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span>"</span></span><span> </span><span class="main"><span>&lt;=</span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.ConstantExpr|const"><span>ConstantExpr</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
  </span><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>y</span></span><span>"</span></span><span> </span><span class="main"><span>&lt;=</span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinSub|const"><span>BinSub</span></a><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.wf_stamp_def|fact"><span class="entity_def" id="TreeSnippets.wf_stamp_def|thm"><span class="entity_def" id="TreeSnippets.wf_stamp_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="TreeSnippets.wf_stamp|const"><span>wf_stamp</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr|type"><span>IRExpr</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>wf_stamp</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>m</span></span><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>v</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="bound"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value|const"><span>valid_value</span></a><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.stamp_expr|const"><span>stamp_expr</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3822..3827">lemma</span></span></span><span> </span><span class="entity_def" id="TreeSnippets.wf_stamp_eval|fact"><span class="entity_def" id="TreeSnippets.wf_stamp_eval|thm"><span>wf_stamp_eval</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.wf_stamp|const"><span>wf_stamp</span></a><span> </span><span class="free"><span>e</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.stamp_expr|const"><span>stamp_expr</span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>m</span></span><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>v</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="bound"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="free"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>vv</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>vv</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_3822..3827"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.wf_stamp_def|fact"><span>wf_stamp_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Proofs/StampEvalThms.html#StampEvalThms.valid_int_same_bits|fact"><span>valid_int_same_bits</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.valid_int|fact"><span>valid_int</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>phase</span></span></span><span> SnipPhase
  </span><span class="keyword2"><span class="keyword"><span>terminating</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.size|const"><span>size</span></a></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4102..4107">lemma</span></span></span><span> </span><span class="entity_def" id="TreeSnippets.sub_same_val|fact"><span class="entity_def" id="TreeSnippets.sub_same_val|thm"><span class="entity_def" id="offset_4108..4120">sub_same_val</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>v</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>val[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="keyword1"><span>val[</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_4102..4107"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹sub-same-32›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.SubIdentity_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.SubIdentity|fact"><span class="entity_def" id="TreeSnippets.SubIdentity_code|fact"><span class="entity_def" id="TreeSnippets.SubIdentity(2)|thm"><span class="entity_def" id="TreeSnippets.SubIdentity(1)|thm"><span class="entity_def" id="TreeSnippets.SubIdentity_code|thm"><span class="entity_def" id="TreeSnippets.SubIdentity_code_raw|axiom"><span class="entity_def" id="offset_4268..4279">SubIdentity</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Conditional|const"><span>⟼</span></a></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.ConstantExpr|const"><span>ConstantExpr</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span>
     </span><span class="keyword1"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Conditional|const"><span>when</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.stamp_expr|const"><span>stamp_expr</span></a><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.wf_stamp|const"><span>wf_stamp</span></a><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
   </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.disc|fact"><span>IRExpr.disc</span></a><span class="main"><span>(</span></span><span>42</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.size.simps|fact"><span>size.simps</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Canonicalizations/Common.html#Common.size_non_const|fact"><span>size_non_const</span></a><span>
   </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.impI|fact"><span>impI</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_4528..4533">assms</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.stamp_binary|const"><span>stamp_binary</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinSub|const"><span>BinSub</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.stamp_expr|const"><span>stamp_expr</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.stamp_expr|const"><span>stamp_expr</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp.IntegerStamp|const"><span>IntegerStamp</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>lo</span></span><span> </span><span class="free"><span>hi</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.wf_stamp|const"><span>wf_stamp</span></a><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>m</span></span><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span> </span><span class="bound"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><span class="keyword1"><span>exp[</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>vv</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>vv</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_4528..4533"><span>assms</span></a><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.wf_stamp_eval|fact"><span>wf_stamp_eval</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.stamp_expr.simps|fact"><span>stamp_expr.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>m</span></span><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>v</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="bound"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinSub|const"><span>BinSub</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>[</span></a></span><span class="bound"><span>m</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>,</span></a></span><span class="bound"><span>p</span></span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>⊢</span></a></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.ConstantExpr|const"><span>ConstantExpr</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree|const"><span>↦</span></a></span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.wf_value_def|fact"><span>wf_value_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/SMT/smt_systems.ML.html#SMT.smt|method"><span class="operator"><span>smt</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.BinaryExprE|fact"><span>BinaryExprE</span></a><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.wf_stamp_def|fact"><span>TreeSnippets.wf_stamp_def</span></a><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_4528..4533"><span>assms</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval.simps|fact"><span>bin_eval.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.constantAsStamp.simps|fact"><span>constantAsStamp.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.stamp_expr.simps|fact"><span>stamp_expr.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_4108..4120"><span>sub_same_val</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.unfold_const|fact"><span>unfold_const</span></a><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_stamp.simps|fact"><span>valid_stamp.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.valid_value.simps|fact"><span>valid_value.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>thm_oracles</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#offset_4268..4279"><span>SubIdentity</span></a><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹RedundantSubtract›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.RedundantSubtract_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.RedundantSubtract|fact"><span class="entity_def" id="TreeSnippets.RedundantSubtract_code|fact"><span class="entity_def" id="TreeSnippets.RedundantSubtract(2)|thm"><span class="entity_def" id="TreeSnippets.RedundantSubtract(1)|thm"><span class="entity_def" id="TreeSnippets.RedundantSubtract_code|thm"><span class="entity_def" id="TreeSnippets.RedundantSubtract_code_raw|axiom"><span>RedundantSubtract</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Transform|const"><span>⟼</span></a></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.size_simps|fact"><span class="dynamic"><span class="dynamic"><span>size_simps</span></span></span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.diff_diff_cancel_expr|fact"><span>diff_diff_cancel_expr</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Presburger.html#Presburger.presburger|method"><span class="operator"><span>presburger</span></span></a><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Representing terms›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
We wish to show a simple example of expressions represented as terms.
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹ast-example›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>"</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>value</span></span><span>[</span><span>display</span><span>,</span><span>margin</span><span>=40] </span><span class="quoted"><span>‹</span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinAdd|const"><span>BinAdd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinMul|const"><span>BinMul</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinMul|const"><span>BinMul</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>›</span></span><span class="antiquote"><span>}</span></span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
Then we need to show the datatypes that compose the example expression.
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹abstract-syntax-tree›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>datatype</span></span><span>[</span><span>display</span><span>,</span><span>margin</span><span>=40] </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr|type"><span>IRExpr</span></a><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹value›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>datatype</span></span><span>[</span><span>display</span><span>,</span><span>margin</span><span>=40,</span><span>show_abbrevs</span><span>] </span><a class="entity_ref" href="../Graph/Values.html#Values.Value|type"><span>Value</span></a><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Term semantics›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
The core expression evaluation functions need to be introduced.
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹eval›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term_type</span></span><span>[</span><span>mode</span><span>=type_def] </span><span class="quoted"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.unary_eval|const"><span>unary_eval</span></a></span><span class="antiquote"><span>}</span></span></span><span>\\
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term_type</span></span><span>[</span><span>mode</span><span>=type_def] </span><span class="quoted"><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval|const"><span>bin_eval</span></a></span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
We then provide the full semantics of IR expressions.
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>no_translations</span></span></span><span>
  </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span><span> </span><span class="main"><span>&lt;=</span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span><span>
</span><span class="keyword1"><span class="command"><span>translations</span></span></span><span>
  </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span><span> </span><span class="main"><span>&lt;=</span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span><span>
</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹tree-semantics›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree.UnaryExpr|fact"><span>evaltree.UnaryExpr</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{semantics:unary}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree.BinaryExpr|fact"><span>evaltree.BinaryExpr</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{semantics:binary}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree.ConditionalExpr|fact"><span>evaltree.ConditionalExpr</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{semantics:conditional}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree.ConstantExpr|fact"><span>evaltree.ConstantExpr</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{semantics:constant}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree.ParameterExpr|fact"><span>evaltree.ParameterExpr</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{semantics:parameter}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.evaltree.LeafExpr|fact"><span>evaltree.LeafExpr</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{semantics:leaf}
›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
</span><span class="keyword1"><span class="command"><span>no_translations</span></span></span><span>
  </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span><span> </span><span class="main"><span>&lt;=</span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span><span>
</span><span class="keyword1"><span class="command"><span>translations</span></span></span><span>
  </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span><span> </span><span class="main"><span>&lt;=</span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span><span>


</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹And show that expression evaluation is deterministic.›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹tree-evaluation-deterministic›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>] </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.evalDet|fact"><span>evalDet</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>


</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
We then want to start demonstrating the obligations for optimizations.
For this we define refinement over terms.
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹expression-refinement›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.le_expr_def|fact"><span>le_expr_def</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span> ›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
To motivate this definition we show the obligations generated
by optimization definitions.
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>phase</span></span></span><span> SnipPhase
  </span><span class="keyword2"><span class="keyword"><span>terminating</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.size|const"><span>size</span></a></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹InverseLeftSub›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.InverseLeftSub_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.InverseLeftSub|fact"><span class="entity_def" id="TreeSnippets.InverseLeftSub_code|fact"><span class="entity_def" id="TreeSnippets.InverseLeftSub(2)|thm"><span class="entity_def" id="TreeSnippets.InverseLeftSub(1)|thm"><span class="entity_def" id="TreeSnippets.InverseLeftSub_code|thm"><span class="entity_def" id="TreeSnippets.InverseLeftSub_code_raw|axiom"><span>InverseLeftSub</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Transform|const"><span>⟼</span></a></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹InverseLeftSubObligation›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>subgoals</span></span><span>[</span><span>display</span><span>]</span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Canonicalizations/AddPhase.html#AddPhase.RedundantSubAdd|fact"><span>RedundantSubAdd</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹InverseRightSub›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.InverseRightSub_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.InverseRightSub|fact"><span class="entity_def" id="TreeSnippets.InverseRightSub_code|fact"><span class="entity_def" id="TreeSnippets.InverseRightSub(2)|thm"><span class="entity_def" id="TreeSnippets.InverseRightSub(1)|thm"><span class="entity_def" id="TreeSnippets.InverseRightSub_code|thm"><span class="entity_def" id="TreeSnippets.InverseRightSub_code_raw|axiom"><span>InverseRightSub</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Transform|const"><span>⟼</span></a></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹InverseRightSubObligation›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>subgoals</span></span><span>[</span><span>display</span><span>]</span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Canonicalizations/AddPhase.html#AddPhase.RedundantSubAdd2|fact"><span>RedundantSubAdd2</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.rewrite_termination.simps|fact"><span>rewrite_termination.simps</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Canonicalizations/AddPhase.html#AddPhase.RedundantSubAdd2|fact"><span>RedundantSubAdd2</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.rewrite_preservation.simps|fact"><span>rewrite_preservation.simps</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹expression-refinement-monotone›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>,</span><span>margin</span><span>=60] </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.mono_unary|fact"><span>mono_unary</span></a><span class="antiquote"><span>}</span></span></span><span>
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>,</span><span>margin</span><span>=60] </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.mono_binary|fact"><span>mono_binary</span></a><span class="antiquote"><span>}</span></span></span><span>
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>,</span><span>margin</span><span>=60] </span><a class="entity_ref" href="../Semantics/IRTreeEvalThms.html#IRTreeEvalThms.mono_conditional|fact"><span>mono_conditional</span></a><span class="antiquote"><span>}</span></span></span><span>
›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>phase</span></span></span><span> SnipPhase 
  </span><span class="keyword2"><span class="keyword"><span>terminating</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.size|const"><span>size</span></a></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹BinaryFoldConstant›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.BinaryFoldConstant_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.BinaryFoldConstant|fact"><span class="entity_def" id="TreeSnippets.BinaryFoldConstant_code|fact"><span class="entity_def" id="TreeSnippets.BinaryFoldConstant(2)|thm"><span class="entity_def" id="TreeSnippets.BinaryFoldConstant(1)|thm"><span class="entity_def" id="TreeSnippets.BinaryFoldConstant_code|thm"><span class="entity_def" id="TreeSnippets.BinaryFoldConstant_code_raw|axiom"><span>BinaryFoldConstant</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><span class="free"><span>op</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConstantNotation|const"><span>const</span></a></span><span> </span><span class="free"><span>v1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConstantNotation|const"><span>const</span></a></span><span> </span><span class="free"><span>v2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Transform|const"><span>⟼</span></a></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.ConstantExpr|const"><span>ConstantExpr</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval|const"><span>bin_eval</span></a><span> </span><span class="free"><span>op</span></span><span> </span><span class="free"><span>v1</span></span><span> </span><span class="free"><span>v2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹BinaryFoldConstantObligation›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>subgoals</span></span><span>[</span><span>display</span><span>]</span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Canonicalizations/BinaryNode.html#BinaryNode.BinaryFoldConstant|fact"><span>BinaryFoldConstant</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹AddCommuteConstantRight›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.AddCommuteConstantRight_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.AddCommuteConstantRight|fact"><span class="entity_def" id="TreeSnippets.AddCommuteConstantRight_code|fact"><span class="entity_def" id="TreeSnippets.AddCommuteConstantRight(2)|thm"><span class="entity_def" id="TreeSnippets.AddCommuteConstantRight(1)|thm"><span class="entity_def" id="TreeSnippets.AddCommuteConstantRight_code|thm"><span class="entity_def" id="TreeSnippets.AddCommuteConstantRight_code_raw|axiom"><span>AddCommuteConstantRight</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConstantNotation|const"><span>const</span></a></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Conditional|const"><span>⟼</span></a></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConstantNotation|const"><span>const</span></a></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Conditional|const"><span>when</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.is_ConstantExpr|const"><span>is_ConstantExpr</span></a><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹AddCommuteConstantRightObligation›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>subgoals</span></span><span>[</span><span>display</span><span>,</span><span>margin</span><span>=50]</span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Canonicalizations/AddPhase.html#AddPhase.AddShiftConstantRight|fact"><span>AddShiftConstantRight</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹AddNeutral›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.AddNeutral_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.AddNeutral|fact"><span class="entity_def" id="TreeSnippets.AddNeutral_code|fact"><span class="entity_def" id="TreeSnippets.AddNeutral(2)|thm"><span class="entity_def" id="TreeSnippets.AddNeutral(1)|thm"><span class="entity_def" id="TreeSnippets.AddNeutral_code|thm"><span class="entity_def" id="TreeSnippets.AddNeutral_code_raw|axiom"><span>AddNeutral</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConstantNotation|const"><span>const</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Values.html#Values.Value.IntVal|const"><span>IntVal</span></a><span> </span><span class="numeral"><span>32</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Transform|const"><span>⟼</span></a></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹AddNeutralObligation›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>subgoals</span></span><span>[</span><span>display</span><span>]</span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Canonicalizations/AddPhase.html#AddPhase.AddNeutral|fact"><span>AddNeutral</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.rewrite_preservation.simps|fact"><span>rewrite_preservation.simps</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹AddToSub›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.AddToSub_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.AddToSub|fact"><span class="entity_def" id="TreeSnippets.AddToSub_code|fact"><span class="entity_def" id="TreeSnippets.AddToSub(2)|thm"><span class="entity_def" id="TreeSnippets.AddToSub(1)|thm"><span class="entity_def" id="TreeSnippets.AddToSub_code|thm"><span class="entity_def" id="TreeSnippets.AddToSub_code_raw|axiom"><span>AddToSub</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Transform|const"><span>⟼</span></a></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹AddToSubObligation›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>subgoals</span></span><span>[</span><span>display</span><span>]</span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Canonicalizations/AddPhase.html#AddPhase.AddLeftNegateToSub|fact"><span>AddLeftNegateToSub</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.trm_def|fact"><span class="entity_def" id="TreeSnippets.trm_def|thm"><span class="entity_def" id="TreeSnippets.trm_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="TreeSnippets.trm|const"><span>trm</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>trm</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.size|const"><span>size</span></a><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="TreeSnippets.trm_defn|fact"><span class="entity_def" id="TreeSnippets.trm_defn|thm"><span>trm_defn</span></span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.size_simps|attribute"><span class="operator"><span>size_simps</span></span></a><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.trm|const"><span>trm</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.size|const"><span>size</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.trm_def|fact"><span>trm_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹phase›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>phase</span></span></span><span> AddCanonicalizations
  </span><span class="keyword2"><span class="keyword"><span>terminating</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.trm|const"><span>trm</span></a></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>text_raw</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>"\\dots"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>hide_const</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>open</span></span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../Semantics/Form.html#Form.wf_stamp|const"><span>Form.wf_stamp</span></a><span>"</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹phase-example›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>phase</span></span></span><span> Conditional
  </span><span class="keyword2"><span class="keyword"><span>terminating</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.trm|const"><span>trm</span></a></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹phase-example-1›</span></span></span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.NegateCond_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.NegateCond|fact"><span class="entity_def" id="TreeSnippets.NegateCond_code|fact"><span class="entity_def" id="TreeSnippets.NegateCond(2)|thm"><span class="entity_def" id="TreeSnippets.NegateCond(1)|thm"><span class="entity_def" id="TreeSnippets.NegateCond_code|thm"><span class="entity_def" id="TreeSnippets.NegateCond_code_raw|axiom"><span>NegateCond</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.LogicNegationNotation|const"><span>!</span></a></span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConditionalNotation|const"><span>?</span></a></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConditionalNotation|const"><span>:</span></a></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Transform|const"><span>⟼</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConditionalNotation|const"><span>?</span></a></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConditionalNotation|const"><span>:</span></a></span><span> </span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.size_simps|fact"><span class="dynamic"><span class="dynamic"><span>size_simps</span></span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Canonicalizations/ConditionalPhase.html#ConditionalPhase.NegateConditionFlipBranches|fact"><span>ConditionalPhase.NegateConditionFlipBranches</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹phase-example-2›</span></span></span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.TrueCond_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.TrueCond|fact"><span class="entity_def" id="TreeSnippets.TrueCond_code|fact"><span class="entity_def" id="TreeSnippets.TrueCond(2)|thm"><span class="entity_def" id="TreeSnippets.TrueCond(1)|thm"><span class="entity_def" id="TreeSnippets.TrueCond_code|thm"><span class="entity_def" id="TreeSnippets.TrueCond_code_raw|axiom"><span>TrueCond</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.TrueNotation|const"><span>true</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConditionalNotation|const"><span>?</span></a></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConditionalNotation|const"><span>:</span></a></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Transform|const"><span>⟼</span></a></span><span> </span><span class="free"><span>t</span></span><span>"</span></span></span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.trm_def|fact"><span>trm_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹phase-example-3›</span></span></span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.FalseCond_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.FalseCond|fact"><span class="entity_def" id="TreeSnippets.FalseCond_code|fact"><span class="entity_def" id="TreeSnippets.FalseCond(2)|thm"><span class="entity_def" id="TreeSnippets.FalseCond(1)|thm"><span class="entity_def" id="TreeSnippets.FalseCond_code|thm"><span class="entity_def" id="TreeSnippets.FalseCond_code_raw|axiom"><span>FalseCond</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.FalseNotation|const"><span>false</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConditionalNotation|const"><span>?</span></a></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConditionalNotation|const"><span>:</span></a></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Transform|const"><span>⟼</span></a></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.trm_def|fact"><span>trm_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹phase-example-4›</span></span></span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.BranchEqual_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.BranchEqual|fact"><span class="entity_def" id="TreeSnippets.BranchEqual_code|fact"><span class="entity_def" id="TreeSnippets.BranchEqual(2)|thm"><span class="entity_def" id="TreeSnippets.BranchEqual(1)|thm"><span class="entity_def" id="TreeSnippets.BranchEqual_code|thm"><span class="entity_def" id="TreeSnippets.BranchEqual_code_raw|axiom"><span>BranchEqual</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConditionalNotation|const"><span>?</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConditionalNotation|const"><span>:</span></a></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Transform|const"><span>⟼</span></a></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.trm_def|fact"><span>trm_def</span></a><span class="main"><span>)</span></span><span>
 
</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹phase-example-5›</span></span></span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.LessCond_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.LessCond|fact"><span class="entity_def" id="TreeSnippets.LessCond_code|fact"><span class="entity_def" id="TreeSnippets.LessCond(2)|thm"><span class="entity_def" id="TreeSnippets.LessCond(1)|thm"><span class="entity_def" id="TreeSnippets.LessCond_code|thm"><span class="entity_def" id="TreeSnippets.LessCond_code_raw|axiom"><span>LessCond</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConditionalNotation|const"><span>?</span></a></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConditionalNotation|const"><span>:</span></a></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Conditional|const"><span>⟼</span></a></span><span> </span><span class="free"><span>t</span></span><span>
                   </span><span class="keyword1"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Conditional|const"><span>when</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.stamp_under|const"><span>stamp_under</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.stamp_expr|const"><span>stamp_expr</span></a><span> </span><span class="free"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.stamp_expr|const"><span>stamp_expr</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> 
                            </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.wf_stamp|const"><span>wf_stamp</span></a><span> </span><span class="free"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.wf_stamp|const"><span>wf_stamp</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.trm_def|fact"><span>trm_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Canonicalizations/ConditionalPhase.html#ConditionalPhase.condition_bounds_x|fact"><span>ConditionalPhase.condition_bounds_x</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Proofs/StampEvalThms.html#StampEvalThms.wf_stamp_def|fact"><span>StampEvalThms.wf_stamp_def</span></a><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.wf_stamp_def|fact"><span>TreeSnippets.wf_stamp_def</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval.simps|fact"><span>bin_eval.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>14</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Proofs/StampEvalThms.html#StampEvalThms.stamp_under_defn|fact"><span>stamp_under_defn</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹phase-example-6›</span></span></span><span class="keyword1"><span class="command"><span class="entity_def" id="TreeSnippets.condition_bounds_y_code|const"><span>optimization</span></span></span></span><span> </span><span class="entity_def" id="TreeSnippets.condition_bounds_y|fact"><span class="entity_def" id="TreeSnippets.condition_bounds_y_code|fact"><span class="entity_def" id="TreeSnippets.condition_bounds_y(2)|thm"><span class="entity_def" id="TreeSnippets.condition_bounds_y(1)|thm"><span class="entity_def" id="TreeSnippets.condition_bounds_y_code|thm"><span class="entity_def" id="TreeSnippets.condition_bounds_y_code_raw|axiom"><span>condition_bounds_y</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConditionalNotation|const"><span>?</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.ExtraNotation.ConditionalNotation|const"><span>:</span></a></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Conditional|const"><span>⟼</span></a></span><span> </span><span class="free"><span>y</span></span><span>
                   </span><span class="keyword1"><a class="entity_ref" href="../OptimizationDSL/Markup.html#Markup.Rewrite.Conditional|const"><span>when</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.stamp_under|const"><span>stamp_under</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.stamp_expr|const"><span>stamp_expr</span></a><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.stamp_expr|const"><span>stamp_expr</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.wf_stamp|const"><span>wf_stamp</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.wf_stamp|const"><span>wf_stamp</span></a><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.trm_def|fact"><span>trm_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Canonicalizations/ConditionalPhase.html#ConditionalPhase.condition_bounds_y|fact"><span>ConditionalPhase.condition_bounds_y</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Proofs/StampEvalThms.html#StampEvalThms.wf_stamp_def|fact"><span>StampEvalThms.wf_stamp_def</span></a><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.wf_stamp_def|fact"><span>TreeSnippets.wf_stamp_def</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.bin_eval.simps|fact"><span>bin_eval.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>14</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Proofs/StampEvalThms.html#StampEvalThms.stamp_under_defn_inverse|fact"><span>stamp_under_defn_inverse</span></a><span class="main"><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹phase-example-7›</span></span></span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span> </span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="TreeSnippets.simplified_binary|fact"><span class="entity_def" id="TreeSnippets.simplified_binary|thm"><span>simplified_binary</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.is_ConstantExpr|const"><span>is_ConstantExpr</span></a><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.size|const"><span>size</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><span class="free"><span>op</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.size|const"><span>size</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.size|const"><span>size</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induction.ML.html#HOL.induction|method"><span class="operator"><span>induction</span></span></a><span> </span><span class="quoted"><span class="free"><span>b</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induction.ML.html#HOL.induction|method"><span class="operator"><span>induction</span></span></a><span> </span><span class="quoted"><span class="free"><span>op</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.is_ConstantExpr_def|fact"><span>is_ConstantExpr_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>thm</span></span></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.bin_size|fact"><span>bin_size</span></a><span>
</span><span class="keyword1"><span class="command"><span>thm</span></span></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.bin_const_size|fact"><span>bin_const_size</span></a><span>
</span><span class="keyword1"><span class="command"><span>thm</span></span></span><span> </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.unary_size|fact"><span>unary_size</span></a><span>
</span><span class="keyword1"><span class="command"><span>thm</span></span></span><span> </span><a class="entity_ref" href="../Canonicalizations/Common.html#Common.size_non_add|fact"><span>size_non_add</span></a><span>
</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹termination›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>,</span><span>margin</span><span>=80] </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.unary_size|fact"><span>unary_size</span></a><span class="antiquote"><span>}</span></span></span><span>
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>,</span><span>margin</span><span>=80] </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.bin_const_size|fact"><span>bin_const_size</span></a><span class="antiquote"><span>}</span></span></span><span>
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>,</span><span>margin</span><span>=80] </span><span class="main"><span>(</span></span><span class="operator"><span>concl</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="TreeSnippets.html#TreeSnippets.simplified_binary|fact"><span>simplified_binary</span></a><span class="antiquote"><span>}</span></span></span><span>
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>,</span><span>margin</span><span>=80] </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.cond_size|fact"><span>cond_size</span></a><span class="antiquote"><span>}</span></span></span><span>
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>,</span><span>margin</span><span>=80] </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.const_size|fact"><span>const_size</span></a><span class="antiquote"><span>}</span></span></span><span>
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>,</span><span>margin</span><span>=80] </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.param_size|fact"><span>param_size</span></a><span class="antiquote"><span>}</span></span></span><span>
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>,</span><span>margin</span><span>=80] </span><a class="entity_ref" href="../OptimizationDSL/Canonicalization.html#Canonicalization.leaf_size|fact"><span>leaf_size</span></a><span class="antiquote"><span>}</span></span></span><span>
›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>


</span><span class="comment1"><span>(* definition 5 (semantics-preserving) is there a distinction in Isabelle? *)</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹graph-representation›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>bold</span></span><span> </span><span class="plain_text"><span>‹typedef›</span></span><span class="antiquote"><span>}</span></span></span><span> IRGraph = 

</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span>[</span><span>source</span><span>] </span><span class="quoted"><span>‹</span><span class="main"><span>{</span></span><span class="bound"><span>g</span></span><span> </span><span class="main"><span>::</span></span><span> </span><a class="entity_ref" href="../Graph/IRNodes.html#IRNodes.ID|type"><span>ID</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.map|type"><span>⇀</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Graph/IRNodes.html#IRNodes.IRNode|type"><span>IRNode</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><a class="entity_ref" href="../Graph/Stamp.html#Stamp.Stamp|type"><span>Stamp</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="bound"><span>g</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>›</span></span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>no_translations</span></span></span><span>
  </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span><span> </span><span class="main"><span>&lt;=</span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span><span>
</span><span class="keyword1"><span class="command"><span>translations</span></span></span><span>
  </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span><span> </span><span class="main"><span>&lt;=</span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span><span>
</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹graph2tree›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.rep.ConstantNode|fact"><span>rep.ConstantNode</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{rep:constant}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.rep.ParameterNode|fact"><span>rep.ParameterNode</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{rep:parameter}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.rep.ConditionalNode|fact"><span>rep.ConditionalNode</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{rep:conditional}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.rep.AbsNode|fact"><span>rep.AbsNode</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{rep:unary}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.rep.SignExtendNode|fact"><span>rep.SignExtendNode</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{rep:convert}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.rep.AddNode|fact"><span>rep.AddNode</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{rep:binary}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.rep.LeafNode|fact"><span>rep.LeafNode</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{rep:leaf}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.rep.RefNode|fact"><span>rep.RefNode</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{rep:ref}
›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹unique›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.unique.Exists|fact"><span>unique.Exists</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{unique:exists}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.unique.New|fact"><span>unique.New</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{unique:new}
›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹tree2graph›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.unrep.UnrepConstantNode|fact"><span>unrep.UnrepConstantNode</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{unrep:constantnew}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.unrep.UnrepParameterNode|fact"><span>unrep.UnrepParameterNode</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{unrep:parameternew}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.unrep.UnrepUnaryNode|fact"><span>unrep.UnrepUnaryNode</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{unrep:unarynew}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.unrep.UnrepBinaryNode|fact"><span>unrep.UnrepBinaryNode</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{unrep:binarynew}
\induct{</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>mode</span><span>=Rule] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.unrep.AllLeafNodes|fact"><span>unrep.AllLeafNodes</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>}{unrep:leaf}
›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
</span><span class="keyword1"><span class="command"><span>no_translations</span></span></span><span>
  </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span><span> </span><span class="main"><span>&lt;=</span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span><span>
</span><span class="keyword1"><span class="command"><span>translations</span></span></span><span>
  </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span><span> </span><span class="main"><span>&lt;=</span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span>prop</span><span>"</span></span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span><span>


</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹preeval›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.is_preevaluated.simps|fact"><span>is_preevaluated.simps</span></a><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹deterministic-representation›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>] </span><a class="entity_ref" href="../Semantics/TreeToGraphThms.html#TreeToGraphThms.repDet|fact"><span>repDet</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
</span><span class="keyword1"><span class="command"><span>thm_oracles</span></span></span><span> </span><a class="entity_ref" href="../Semantics/TreeToGraphThms.html#TreeToGraphThms.repDet|fact"><span>repDet</span></a><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹well-formed-term-graph›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>"</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rhs</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.wf_term_graph_def|fact"><span>wf_term_graph_def</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="comment1"><span>(* definition 9 (well-formed graph) no? *)</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹graph-semantics›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.encodeeval.intros|fact"><span>encodeeval.intros</span></a><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹graph-semantics-deterministic›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> </span><a class="entity_ref" href="../Semantics/TreeToGraphThms.html#TreeToGraphThms.graphDet|fact"><span>graphDet</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
</span><span class="keyword1"><span class="command"><span>thm_oracles</span></span></span><span> </span><a class="entity_ref" href="../Semantics/TreeToGraphThms.html#TreeToGraphThms.graphDet|fact"><span>graphDet</span></a><span>

</span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><span class="main"><span>(</span></span><span>latex</span><span class="main"><span>)</span></span><span>
  </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.graph_refinement|const"><span>graph_refinement</span></a><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span><span class="hidden">\&lt;^</span><span class="control">latex</span><span class="hidden">&gt;</span>‹term-graph-refinement›</span></span><span> _"</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹graph-refinement›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>, </span><span>margin</span><span>=60] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.graph_refinement_def|fact"><span>graph_refinement_def</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="comment1"><span>(* hide as_set, should treat IRGraph as a set of pairs in paper *)</span></span><span>
</span><span class="keyword1"><span class="command"><span>translations</span></span></span><span>
  </span><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span>"</span></span><span> </span><span class="main"><span>&lt;=</span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="../Graph/IRGraph.html#IRGraph.as_set|const"><span>as_set</span></a><span> </span><span class="free"><span>n</span></span><span>"</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹graph-semantics-preservation›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>, </span><span>margin</span><span>=30] </span><a class="entity_ref" href="../Semantics/TreeToGraphThms.html#TreeToGraphThms.graph_semantics_preservation_subscript|fact"><span>graph_semantics_preservation_subscript</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
</span><span class="keyword1"><span class="command"><span>thm_oracles</span></span></span><span> </span><a class="entity_ref" href="../Semantics/TreeToGraphThms.html#TreeToGraphThms.graph_semantics_preservation_subscript|fact"><span>graph_semantics_preservation_subscript</span></a><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹maximal-sharing›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>, </span><span>margin</span><span>=50] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.maximal_sharing|fact"><span>maximal_sharing</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹tree-to-graph-rewriting›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>, </span><span>margin</span><span>=30] </span><a class="entity_ref" href="../Semantics/TreeToGraphThms.html#TreeToGraphThms.tree_to_graph_rewriting|fact"><span>tree_to_graph_rewriting</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
</span><span class="keyword1"><span class="command"><span>thm_oracles</span></span></span><span> </span><a class="entity_ref" href="../Semantics/TreeToGraphThms.html#TreeToGraphThms.tree_to_graph_rewriting|fact"><span>tree_to_graph_rewriting</span></a><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹term-graph-refines-term›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>] </span><a class="entity_ref" href="../Semantics/TreeToGraph.html#TreeToGraph.graph_represents_expression_def|fact"><span>graph_represents_expression_def</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹term-graph-evaluation›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>] </span><a class="entity_ref" href="../Semantics/TreeToGraphThms.html#TreeToGraphThms.term_graph_evaluation|fact"><span>term_graph_evaluation</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹graph-construction›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>, </span><span>margin</span><span>=40] </span><a class="entity_ref" href="../Semantics/TreeToGraphThms.html#TreeToGraphThms.graph_construction|fact"><span>graph_construction</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>
</span><span class="keyword1"><span class="command"><span>thm_oracles</span></span></span><span> </span><a class="entity_ref" href="../Semantics/TreeToGraphThms.html#TreeToGraphThms.graph_construction|fact"><span>graph_construction</span></a><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹term-graph-reconstruction›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>] </span><a class="entity_ref" href="../Semantics/TreeToGraphThms.html#TreeToGraphThms.term_graph_reconstruction|fact"><span>term_graph_reconstruction</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword1"><span class="command"><span>snipbegin</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹refined-insert›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span>[</span><span>display</span><span>, </span><span>margin</span><span>=40] </span><a class="entity_ref" href="../Semantics/TreeToGraphThms.html#TreeToGraphThms.refined_insert|fact"><span>refined_insert</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>no_vars</span></span><span class="main"><span>]</span></span><span class="antiquote"><span>}</span></span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>snipend</span></span></span><span> </span><span class="plain_text"><span>-</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>