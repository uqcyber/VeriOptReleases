<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Canonicalization</title>
</head>


<body>
<div class="head">
<h1>Theory Canonicalization</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹</span><span>Canonicalization DSL</span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Canonicalization</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span>
    </span><a href="Markup.html"><span>Markup</span></a><span>
    </span><a href="Phase.html"><span>Phase</span></a><span>
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Eisbach/Eisbach.html"><span>HOL-Eisbach.Eisbach</span></a><span>"</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>keywords</span></span></span><span>
    </span><span class="quoted"><span>"</span><span>phase</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> 
    </span><span class="quoted"><span>"</span><span>terminating</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> quasi_command </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>
    </span><span class="quoted"><span>"</span><span>print_phases</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> diag </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>
    </span><span class="quoted"><span>"</span><span>export_phases</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_decl </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>
    </span><span class="quoted"><span>"</span><span>optimization</span><span>"</span></span><span> </span><span class="main"><span>::</span></span><span> thy_goal_defn
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>print_methods</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword1"><span class="keyword"><span>datatype</span></span></span><span> </span><span>'a</span><span> </span><span class="entity"><span>Rewrite</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Transform</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> </span><span>'a</span><span> * </span><span>'a</span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="entity"><span>Conditional</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> </span><span>'a</span><span> * </span><span>'a</span><span> * term </span><span class="main"><span>|</span></span><span>
  </span><span class="entity"><span>Sequential</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> </span><span>'a</span><span> Rewrite * </span><span>'a</span><span> Rewrite </span><span class="main"><span>|</span></span><span>
  </span><span class="entity"><span>Transitive</span></span><span> </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> </span><span>'a</span><span> Rewrite

</span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>rewrite</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span>
  </span><span>name</span><span class="main"><span>:</span></span><span> </span><span>binding</span><span class="main"><span>,</span></span><span>
  </span><span>rewrite</span><span class="main"><span>:</span></span><span> </span><span>term</span><span> </span><span class="entity"><span>Rewrite</span></span><span class="main"><span>,</span></span><span>
  </span><span>proofs</span><span class="main"><span>:</span></span><span> </span><span>thm</span><span> </span><span>list</span><span class="main"><span>,</span></span><span>
  </span><span>code</span><span class="main"><span>:</span></span><span> </span><span>thm</span><span> </span><span>list</span><span class="main"><span>,</span></span><span>
  </span><span>source</span><span class="main"><span>:</span></span><span> </span><span>term</span><span>
</span><span class="main"><span>}</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>RewriteRule</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>Rule</span></span><span> </span><span class="main"><span>=</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>struct</span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>type</span></span></span><span> </span><span class="entity"><span>T</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>rewrite</span></span><span class="main"><span>;</span></span><span>

</span><span class="comment1"><span>(*
fun pretty_rewrite ctxt (Transform (from, to)) = 
      Pretty.block [
        Syntax.pretty_term ctxt from,
        Pretty.str " ↦ ",
        Syntax.pretty_term ctxt to
      ]
  | pretty_rewrite ctxt (Conditional (from, to, cond)) = 
      Pretty.block [
        Syntax.pretty_term ctxt from,
        Pretty.str " ↦ ",
        Syntax.pretty_term ctxt to,
        Pretty.str " when ",
        Syntax.pretty_term ctxt cond
      ]
  | pretty_rewrite _ _ = Pretty.str "not implemented"*)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>pretty_thm</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>thm</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>(</span></span><span>Proof_Context.pretty_fact</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>""</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>thm</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>pretty</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="entity"><span>obligations</span></span><span> </span><span class="entity"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>is_skipped</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Thm_Deps.has_skip_proof</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>#</span></span><span>proofs</span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>warning</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>is_skipped</span></span><span> 
      </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="main"><span>[</span></span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>"(proof skipped)"</span></span><span class="main"><span>,</span></span><span> </span><span>Pretty.brk</span><span> </span><span class="inner_numeral"><span>0</span></span><span class="main"><span>]</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>obligations</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>obligations</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span class="main"><span>[</span></span><span>Pretty.big_list</span><span> 
              </span><span class="inner_quoted"><span>"obligations:"</span></span><span>
              </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>pretty_thm</span></span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>#</span></span><span>proofs</span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
            </span><span>Pretty.brk</span><span> </span><span class="inner_numeral"><span>0</span></span><span class="main"><span>]</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>      

    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>pretty_bind</span></span><span> </span><span class="entity"><span>binding</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span>Pretty.markup</span><span> 
        </span><span class="main"><span>(</span></span><span>Position.markup</span><span> </span><span class="main"><span>(</span></span><span>Binding.pos_of</span><span> </span><span class="entity"><span>binding</span></span><span class="main"><span>)</span></span><span> </span><span>Markup.position</span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>[</span></span><span>Pretty.str</span><span> </span><span class="main"><span>(</span></span><span>Binding.name_of</span><span> </span><span class="entity"><span>binding</span></span><span class="main"><span>)</span></span><span class="main"><span>]</span></span><span class="main"><span>;</span></span><span>

  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
  </span><span>Pretty.block</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>[</span></span><span>
    </span><span class="entity"><span>pretty_bind</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>#</span></span><span>name</span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span>Pretty.str</span><span> </span><span class="inner_quoted"><span>": "</span></span><span class="main"><span>,</span></span><span>
    </span><span>Syntax.pretty_term</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>#</span></span><span>source</span><span> </span><span class="entity"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span>Pretty.fbrk</span><span>
  </span><span class="main"><span>]</span></span><span> </span><span>@</span><span> </span><span class="entity"><span>obligations</span></span><span> </span><span>@</span><span> </span><span class="entity"><span>warning</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>RewritePhase</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>DSL_Phase</span></span><span class="main"><span>(</span></span><span class="entity"><span>RewriteRule</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>phase</span></span><span>›</span></span></span><span> </span><span class="inner_quoted"><span>"enter an optimization phase"</span></span><span>
   </span><span class="main"><span>(</span></span><span>Parse.binding</span><span> </span><span>--|</span><span> </span><span>Parse.$$$</span><span> </span><span class="inner_quoted"><span>"terminating"</span></span><span> </span><span>--</span><span> </span><span>Parse.const</span><span> </span><span>--|</span><span> </span><span>Parse.begin</span><span>
     </span><span>&gt;&gt;</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Toplevel.begin_main_target</span></span><span> </span><span>true</span><span> </span><span>o</span><span> </span><span class="entity"><span>RewritePhase.setup</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>print_phases</span></span><span> </span><span class="entity"><span>print_obligations</span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Proof_Context.theory_of</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>print</span></span><span> </span><span class="entity"><span>phase</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>RewritePhase.pretty</span></span><span> </span><span class="entity"><span>print_obligations</span></span><span> </span><span class="entity"><span>phase</span></span><span> </span><span class="entity"><span>ctxt</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> 
    </span><span>map</span><span> </span><span class="entity"><span>print</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>RewritePhase.phases</span></span><span> </span><span class="entity"><span>thy</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>print_optimizations</span></span><span> </span><span class="entity"><span>print_obligations</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>print_phases</span></span><span> </span><span class="entity"><span>print_obligations</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span>|&gt;</span><span> </span><span>Pretty.writeln_chunks</span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>print_phases</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"print debug information for optimizations"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.opt_bang</span><span> </span><span>&gt;&gt;</span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>b</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.keep</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="entity"><span>print_optimizations</span></span><span> </span><span class="entity"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span>o</span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>export_phases</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>state</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Toplevel.theory_toplevel</span></span><span> </span><span class="entity"><span>thy</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Toplevel.context_of</span></span><span> </span><span class="entity"><span>state</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>content</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Pretty.string_of</span><span> </span><span class="main"><span>(</span></span><span>Pretty.chunks</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>print_phases</span></span><span> </span><span>false</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>cleaned</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>YXML.content_of</span><span> </span><span class="entity"><span>content</span></span><span class="main"><span>;</span></span><span>    


    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>filename</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Path.explode</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>name</span></span><span>^</span><span class="inner_quoted"><span>".rules"</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>directory</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Path.explode</span><span> </span><span class="inner_quoted"><span>"optimizations"</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>path</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Path.binding</span><span> </span><span class="main"><span>(</span></span><span>
                </span><span>Path.append</span><span> </span><span class="entity"><span>directory</span></span><span> </span><span class="entity"><span>filename</span></span><span class="main"><span>,</span></span><span>
                </span><span>Position.none</span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>thy'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>thy</span></span><span> </span><span>|&gt;</span><span> </span><span class="entity"><span>Generated_Files.add_files</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>path</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>content</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Export.export</span><span> </span><span class="entity"><span>thy'</span></span><span> </span><span class="entity"><span>path</span></span><span> </span><span class="main"><span>[</span></span><span>YXML.parse</span><span> </span><span class="entity"><span>cleaned</span></span><span class="main"><span>]</span></span><span class="main"><span>;</span></span><span>

    </span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>writeln</span><span> </span><span class="main"><span>(</span></span><span>Export.message</span><span> </span><span class="entity"><span>thy'</span></span><span> </span><span class="main"><span>(</span></span><span>Path.basic</span><span> </span><span class="inner_quoted"><span>"optimizations"</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span>
    </span><span class="entity"><span>thy'</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.command</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>export_phases</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"export information about encoded optimizations"</span></span><span>
    </span><span class="main"><span>(</span></span><span>Parse.text</span><span> </span><span>&gt;&gt;</span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>name</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Toplevel.theory</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>state</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>export_phases</span></span><span> </span><span class="entity"><span>state</span></span><span> </span><span class="entity"><span>name</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
</span><span>›</span></span><span>

</span><span class="keyword1"><span class="command"><span>ML_file</span></span></span><span> </span><span class="quoted"><span>"</span><span>rewrites.ML</span><span>"</span></span><span>

</span><span class="keyword1"><span class="command"><span>phase</span></span></span><span> </span><span>Opt</span><span>
  </span><span class="keyword2"><span class="keyword"><span>terminating</span></span></span><span> </span><span class="quoted"><span>size</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>print_phases</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>export_phases</span></span></span><span> </span><span class="quoted"><span>‹</span><span>MyPhases</span><span>›</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Canonicalization.rewrite_preservation.elims|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation.induct|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation.simps|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation.pelims|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation.cases|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation.termination|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation.pinduct|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation.psimps|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation_rel.inducts|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation_rel.simps|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation_rel.induct|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation_rel.cases|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation_rel.intros|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation_graph.inducts|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation_graph.simps|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation_graph.induct|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation_graph.cases|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation_graph.intros|fact"><span class="entity_def" id="Canonicalization.rewrite_preservation.elims(3)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.elims(2)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.elims(1)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.induct|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.simps(4)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.simps(3)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.simps(2)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.simps(1)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.pelims(3)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.pelims(2)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.pelims(1)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.cases|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.termination|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.pinduct|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.psimps(4)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.psimps(3)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.psimps(2)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation.psimps(1)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation_rel.inducts|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation_rel.simps|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation_rel.induct|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation_rel.cases|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation_rel.intros(3)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation_rel.intros(2)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation_rel.intros(1)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation_graph.inducts|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation_graph.simps|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation_graph.induct|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation_graph.cases|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation_graph.intros(4)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation_graph.intros(3)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation_graph.intros(2)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation_graph.intros(1)|thm"><span class="entity_def" id="Canonicalization.rewrite_preservation_def|axiom"><span class="entity_def" id="Canonicalization.rewrite_preservation_rel_def|axiom"><span class="entity_def" id="Canonicalization.rewrite_preservation_sumC_def|axiom"><span class="entity_def" id="Canonicalization.rewrite_preservation_graph_def|axiom"><span class="entity_def" id="Canonicalization.rewrite_preservation_dom|const"><span class="entity_def" id="Canonicalization.rewrite_preservation_rel|const"><span class="entity_def" id="Canonicalization.rewrite_preservation_sumC|const"><span class="entity_def" id="Canonicalization.rewrite_preservation_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Canonicalization.rewrite_preservation|const"><span>rewrite_preservation</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr|type"><span>IRExpr</span></a><span> </span><a class="entity_ref" href="Markup.html#Markup.Rewrite|type"><span>Rewrite</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span>bool</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>rewrite_preservation</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Markup.html#Markup.Rewrite.Transform|const"><span>Transform</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>rewrite_preservation</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Markup.html#Markup.Rewrite.Conditional|const"><span>Conditional</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="main"><span>⟶</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span> </span><span class="main"><span>≤</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>rewrite_preservation</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Markup.html#Markup.Rewrite.Sequential|const"><span>Sequential</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>rewrite_preservation</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="free"><span>rewrite_preservation</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>rewrite_preservation</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Markup.html#Markup.Rewrite.Transitive|const"><span>Transitive</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>rewrite_preservation</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Canonicalization.rewrite_termination.elims|fact"><span class="entity_def" id="Canonicalization.rewrite_termination.induct|fact"><span class="entity_def" id="Canonicalization.rewrite_termination.simps|fact"><span class="entity_def" id="Canonicalization.rewrite_termination.pelims|fact"><span class="entity_def" id="Canonicalization.rewrite_termination.cases|fact"><span class="entity_def" id="Canonicalization.rewrite_termination.termination|fact"><span class="entity_def" id="Canonicalization.rewrite_termination.pinduct|fact"><span class="entity_def" id="Canonicalization.rewrite_termination.psimps|fact"><span class="entity_def" id="Canonicalization.rewrite_termination_rel.inducts|fact"><span class="entity_def" id="Canonicalization.rewrite_termination_rel.simps|fact"><span class="entity_def" id="Canonicalization.rewrite_termination_rel.induct|fact"><span class="entity_def" id="Canonicalization.rewrite_termination_rel.cases|fact"><span class="entity_def" id="Canonicalization.rewrite_termination_rel.intros|fact"><span class="entity_def" id="Canonicalization.rewrite_termination_graph.inducts|fact"><span class="entity_def" id="Canonicalization.rewrite_termination_graph.simps|fact"><span class="entity_def" id="Canonicalization.rewrite_termination_graph.induct|fact"><span class="entity_def" id="Canonicalization.rewrite_termination_graph.cases|fact"><span class="entity_def" id="Canonicalization.rewrite_termination_graph.intros|fact"><span class="entity_def" id="Canonicalization.rewrite_termination.elims(3)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.elims(2)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.elims(1)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.induct|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.simps(4)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.simps(3)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.simps(2)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.simps(1)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.pelims(3)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.pelims(2)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.pelims(1)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.cases|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.termination|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.pinduct|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.psimps(4)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.psimps(3)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.psimps(2)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination.psimps(1)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination_rel.inducts|thm"><span class="entity_def" id="Canonicalization.rewrite_termination_rel.simps|thm"><span class="entity_def" id="Canonicalization.rewrite_termination_rel.induct|thm"><span class="entity_def" id="Canonicalization.rewrite_termination_rel.cases|thm"><span class="entity_def" id="Canonicalization.rewrite_termination_rel.intros(3)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination_rel.intros(2)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination_rel.intros(1)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination_graph.inducts|thm"><span class="entity_def" id="Canonicalization.rewrite_termination_graph.simps|thm"><span class="entity_def" id="Canonicalization.rewrite_termination_graph.induct|thm"><span class="entity_def" id="Canonicalization.rewrite_termination_graph.cases|thm"><span class="entity_def" id="Canonicalization.rewrite_termination_graph.intros(4)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination_graph.intros(3)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination_graph.intros(2)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination_graph.intros(1)|thm"><span class="entity_def" id="Canonicalization.rewrite_termination_def|axiom"><span class="entity_def" id="Canonicalization.rewrite_termination_rel_def|axiom"><span class="entity_def" id="Canonicalization.rewrite_termination_sumC_def|axiom"><span class="entity_def" id="Canonicalization.rewrite_termination_graph_def|axiom"><span class="entity_def" id="Canonicalization.rewrite_termination_dom|const"><span class="entity_def" id="Canonicalization.rewrite_termination_rel|const"><span class="entity_def" id="Canonicalization.rewrite_termination_sumC|const"><span class="entity_def" id="Canonicalization.rewrite_termination_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Canonicalization.rewrite_termination|const"><span>rewrite_termination</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr|type"><span>IRExpr</span></a><span> </span><a class="entity_ref" href="Markup.html#Markup.Rewrite|type"><span>Rewrite</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr|type"><span>IRExpr</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span>nat</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span>bool</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>rewrite_termination</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Markup.html#Markup.Rewrite.Transform|const"><span>Transform</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>trm</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>trm</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>trm</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>rewrite_termination</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Markup.html#Markup.Rewrite.Conditional|const"><span>Conditional</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>trm</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="main"><span>⟶</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>trm</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>trm</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>rewrite_termination</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Markup.html#Markup.Rewrite.Sequential|const"><span>Sequential</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>trm</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>rewrite_termination</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>trm</span></span></span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="free"><span>rewrite_termination</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>trm</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>rewrite_termination</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Markup.html#Markup.Rewrite.Transitive|const"><span>Transitive</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>trm</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>rewrite_termination</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>trm</span></span></span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Canonicalization.intval.elims|fact"><span class="entity_def" id="Canonicalization.intval.induct|fact"><span class="entity_def" id="Canonicalization.intval.simps|fact"><span class="entity_def" id="Canonicalization.intval.pelims|fact"><span class="entity_def" id="Canonicalization.intval.cases|fact"><span class="entity_def" id="Canonicalization.intval.termination|fact"><span class="entity_def" id="Canonicalization.intval.pinduct|fact"><span class="entity_def" id="Canonicalization.intval.psimps|fact"><span class="entity_def" id="Canonicalization.intval_rel.inducts|fact"><span class="entity_def" id="Canonicalization.intval_rel.simps|fact"><span class="entity_def" id="Canonicalization.intval_rel.induct|fact"><span class="entity_def" id="Canonicalization.intval_rel.cases|fact"><span class="entity_def" id="Canonicalization.intval_rel.intros|fact"><span class="entity_def" id="Canonicalization.intval_graph.inducts|fact"><span class="entity_def" id="Canonicalization.intval_graph.simps|fact"><span class="entity_def" id="Canonicalization.intval_graph.induct|fact"><span class="entity_def" id="Canonicalization.intval_graph.cases|fact"><span class="entity_def" id="Canonicalization.intval_graph.intros|fact"><span class="entity_def" id="Canonicalization.intval.elims(3)|thm"><span class="entity_def" id="Canonicalization.intval.elims(2)|thm"><span class="entity_def" id="Canonicalization.intval.elims(1)|thm"><span class="entity_def" id="Canonicalization.intval.induct|thm"><span class="entity_def" id="Canonicalization.intval.simps(4)|thm"><span class="entity_def" id="Canonicalization.intval.simps(3)|thm"><span class="entity_def" id="Canonicalization.intval.simps(2)|thm"><span class="entity_def" id="Canonicalization.intval.simps(1)|thm"><span class="entity_def" id="Canonicalization.intval.pelims(3)|thm"><span class="entity_def" id="Canonicalization.intval.pelims(2)|thm"><span class="entity_def" id="Canonicalization.intval.pelims(1)|thm"><span class="entity_def" id="Canonicalization.intval.cases|thm"><span class="entity_def" id="Canonicalization.intval.termination|thm"><span class="entity_def" id="Canonicalization.intval.pinduct|thm"><span class="entity_def" id="Canonicalization.intval.psimps(4)|thm"><span class="entity_def" id="Canonicalization.intval.psimps(3)|thm"><span class="entity_def" id="Canonicalization.intval.psimps(2)|thm"><span class="entity_def" id="Canonicalization.intval.psimps(1)|thm"><span class="entity_def" id="Canonicalization.intval_rel.inducts|thm"><span class="entity_def" id="Canonicalization.intval_rel.simps|thm"><span class="entity_def" id="Canonicalization.intval_rel.induct|thm"><span class="entity_def" id="Canonicalization.intval_rel.cases|thm"><span class="entity_def" id="Canonicalization.intval_rel.intros(3)|thm"><span class="entity_def" id="Canonicalization.intval_rel.intros(2)|thm"><span class="entity_def" id="Canonicalization.intval_rel.intros(1)|thm"><span class="entity_def" id="Canonicalization.intval_graph.inducts|thm"><span class="entity_def" id="Canonicalization.intval_graph.simps|thm"><span class="entity_def" id="Canonicalization.intval_graph.induct|thm"><span class="entity_def" id="Canonicalization.intval_graph.cases|thm"><span class="entity_def" id="Canonicalization.intval_graph.intros(4)|thm"><span class="entity_def" id="Canonicalization.intval_graph.intros(3)|thm"><span class="entity_def" id="Canonicalization.intval_graph.intros(2)|thm"><span class="entity_def" id="Canonicalization.intval_graph.intros(1)|thm"><span class="entity_def" id="Canonicalization.intval_def|axiom"><span class="entity_def" id="Canonicalization.intval_rel_def|axiom"><span class="entity_def" id="Canonicalization.intval_sumC_def|axiom"><span class="entity_def" id="Canonicalization.intval_graph_def|axiom"><span class="entity_def" id="Canonicalization.intval_dom|const"><span class="entity_def" id="Canonicalization.intval_rel|const"><span class="entity_def" id="Canonicalization.intval_sumC|const"><span class="entity_def" id="Canonicalization.intval_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Canonicalization.intval|const"><span>intval</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Graph/Values.html#Values.Value|type"><span>Value</span></a><span> </span><a class="entity_ref" href="Markup.html#Markup.Rewrite|type"><span>Rewrite</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span>bool</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>intval</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Markup.html#Markup.Rewrite.Transform|const"><span>Transform</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>≠</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.UndefVal|const"><span>UndefVal</span></a><span> </span><span class="main"><span>∧</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span> </span><span class="main"><span>≠</span></span><span> </span><a class="entity_ref" href="../Graph/Values.html#Values.Value.UndefVal|const"><span>UndefVal</span></a><span> </span><span class="main"><span>⟶</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>intval</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Markup.html#Markup.Rewrite.Conditional|const"><span>Conditional</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="main"><span>⟶</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>intval</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Markup.html#Markup.Rewrite.Sequential|const"><span>Sequential</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>intval</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>∧</span></span><span> </span><span class="free"><span>intval</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>intval</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Markup.html#Markup.Rewrite.Transitive|const"><span>Transitive</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>intval</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Canonicalization.size.elims|fact"><span class="entity_def" id="Canonicalization.size.induct|fact"><span class="entity_def" id="Canonicalization.size.simps|fact"><span class="entity_def" id="Canonicalization.size.pelims|fact"><span class="entity_def" id="Canonicalization.size.cases|fact"><span class="entity_def" id="Canonicalization.size.termination|fact"><span class="entity_def" id="Canonicalization.size.pinduct|fact"><span class="entity_def" id="Canonicalization.size.psimps|fact"><span class="entity_def" id="Canonicalization.size_rel.inducts|fact"><span class="entity_def" id="Canonicalization.size_rel.simps|fact"><span class="entity_def" id="Canonicalization.size_rel.induct|fact"><span class="entity_def" id="Canonicalization.size_rel.cases|fact"><span class="entity_def" id="Canonicalization.size_rel.intros|fact"><span class="entity_def" id="Canonicalization.size_graph.inducts|fact"><span class="entity_def" id="Canonicalization.size_graph.simps|fact"><span class="entity_def" id="Canonicalization.size_graph.induct|fact"><span class="entity_def" id="Canonicalization.size_graph.cases|fact"><span class="entity_def" id="Canonicalization.size_graph.intros|fact"><span class="entity_def" id="Canonicalization.size.elims|thm"><span class="entity_def" id="Canonicalization.size.induct|thm"><span class="entity_def" id="Canonicalization.size.simps(20)|thm"><span class="entity_def" id="Canonicalization.size.simps(19)|thm"><span class="entity_def" id="Canonicalization.size.simps(18)|thm"><span class="entity_def" id="Canonicalization.size.simps(17)|thm"><span class="entity_def" id="Canonicalization.size.simps(16)|thm"><span class="entity_def" id="Canonicalization.size.simps(15)|thm"><span class="entity_def" id="Canonicalization.size.simps(14)|thm"><span class="entity_def" id="Canonicalization.size.simps(13)|thm"><span class="entity_def" id="Canonicalization.size.simps(12)|thm"><span class="entity_def" id="Canonicalization.size.simps(11)|thm"><span class="entity_def" id="Canonicalization.size.simps(10)|thm"><span class="entity_def" id="Canonicalization.size.simps(9)|thm"><span class="entity_def" id="Canonicalization.size.simps(8)|thm"><span class="entity_def" id="Canonicalization.size.simps(7)|thm"><span class="entity_def" id="Canonicalization.size.simps(6)|thm"><span class="entity_def" id="Canonicalization.size.simps(5)|thm"><span class="entity_def" id="Canonicalization.size.simps(4)|thm"><span class="entity_def" id="Canonicalization.size.simps(3)|thm"><span class="entity_def" id="Canonicalization.size.simps(2)|thm"><span class="entity_def" id="Canonicalization.size.simps(1)|thm"><span class="entity_def" id="Canonicalization.size.pelims|thm"><span class="entity_def" id="Canonicalization.size.cases|thm"><span class="entity_def" id="Canonicalization.size.termination|thm"><span class="entity_def" id="Canonicalization.size.pinduct|thm"><span class="entity_def" id="Canonicalization.size.psimps(20)|thm"><span class="entity_def" id="Canonicalization.size.psimps(19)|thm"><span class="entity_def" id="Canonicalization.size.psimps(18)|thm"><span class="entity_def" id="Canonicalization.size.psimps(17)|thm"><span class="entity_def" id="Canonicalization.size.psimps(16)|thm"><span class="entity_def" id="Canonicalization.size.psimps(15)|thm"><span class="entity_def" id="Canonicalization.size.psimps(14)|thm"><span class="entity_def" id="Canonicalization.size.psimps(13)|thm"><span class="entity_def" id="Canonicalization.size.psimps(12)|thm"><span class="entity_def" id="Canonicalization.size.psimps(11)|thm"><span class="entity_def" id="Canonicalization.size.psimps(10)|thm"><span class="entity_def" id="Canonicalization.size.psimps(9)|thm"><span class="entity_def" id="Canonicalization.size.psimps(8)|thm"><span class="entity_def" id="Canonicalization.size.psimps(7)|thm"><span class="entity_def" id="Canonicalization.size.psimps(6)|thm"><span class="entity_def" id="Canonicalization.size.psimps(5)|thm"><span class="entity_def" id="Canonicalization.size.psimps(4)|thm"><span class="entity_def" id="Canonicalization.size.psimps(3)|thm"><span class="entity_def" id="Canonicalization.size.psimps(2)|thm"><span class="entity_def" id="Canonicalization.size.psimps(1)|thm"><span class="entity_def" id="Canonicalization.size_rel.inducts|thm"><span class="entity_def" id="Canonicalization.size_rel.simps|thm"><span class="entity_def" id="Canonicalization.size_rel.induct|thm"><span class="entity_def" id="Canonicalization.size_rel.cases|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(30)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(29)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(28)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(27)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(26)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(25)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(24)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(23)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(22)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(21)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(20)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(19)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(18)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(17)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(16)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(15)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(14)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(13)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(12)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(11)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(10)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(9)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(8)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(7)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(6)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(5)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(4)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(3)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(2)|thm"><span class="entity_def" id="Canonicalization.size_rel.intros(1)|thm"><span class="entity_def" id="Canonicalization.size_graph.inducts|thm"><span class="entity_def" id="Canonicalization.size_graph.simps|thm"><span class="entity_def" id="Canonicalization.size_graph.induct|thm"><span class="entity_def" id="Canonicalization.size_graph.cases|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(20)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(19)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(18)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(17)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(16)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(15)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(14)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(13)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(12)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(11)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(10)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(9)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(8)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(7)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(6)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(5)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(4)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(3)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(2)|thm"><span class="entity_def" id="Canonicalization.size_graph.intros(1)|thm"><span class="entity_def" id="Canonicalization.size_def|axiom"><span class="entity_def" id="Canonicalization.size_rel_def|axiom"><span class="entity_def" id="Canonicalization.size_sumC_def|axiom"><span class="entity_def" id="Canonicalization.size_graph_def|axiom"><span class="entity_def" id="Canonicalization.size_dom|const"><span class="entity_def" id="Canonicalization.size_rel|const"><span class="entity_def" id="Canonicalization.size_sumC|const"><span class="entity_def" id="Canonicalization.size_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Canonicalization.size|const"><span>size</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr|type"><span>IRExpr</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span>nat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>size</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.UnaryExpr|const"><span>UnaryExpr</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>op</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>size</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>size</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRBinaryOp.BinAdd|const"><span>BinAdd</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>size</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>size</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>size</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.BinaryExpr|const"><span>BinaryExpr</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>op</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>size</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>size</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>size</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.ConditionalExpr|const"><span>ConditionalExpr</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>t</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>size</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>cond</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>size</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>t</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>size</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>size</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.ConstantExpr|const"><span>ConstantExpr</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>c</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>size</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.ParameterExpr|const"><span>ParameterExpr</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>ind</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>size</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.LeafExpr|const"><span>LeafExpr</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>nid</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>size</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.ConstantVar|const"><span>ConstantVar</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>c</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>size</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.IRExpr.VariableExpr|const"><span>VariableExpr</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Canonicalization.unfold_optimization.unfold_optimization|method"><span>method</span></span></span></span><span> </span><span class="entity_def" id="Canonicalization.unfold_optimization|method"><span>unfold_optimization</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>(</span></span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="Canonicalization.html#Canonicalization.rewrite_preservation.simps|fact"><span>rewrite_preservation.simps</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="Canonicalization.html#Canonicalization.rewrite_termination.simps|fact"><span>rewrite_termination.simps</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span>
    </span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="Canonicalization.html#Canonicalization.intval.simps|fact"><span>intval.simps</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span>
    </span><span class="operator"><span>rule</span></span><span> </span><span>conjE</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.le_expr_def|fact"><span>le_expr_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>force</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><span class="keyword3"><span>|</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="Canonicalization.html#Canonicalization.rewrite_preservation.simps|fact"><span>rewrite_preservation.simps</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="Canonicalization.html#Canonicalization.rewrite_termination.simps|fact"><span>rewrite_termination.simps</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span>
    </span><span class="operator"><span>rule</span></span><span> </span><span>conjE</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.le_expr_def|fact"><span>le_expr_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>force</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Canonicalization.unfold_size.unfold_size|method"><span>method</span></span></span></span><span> </span><span class="entity_def" id="Canonicalization.unfold_size|method"><span>unfold_size</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="main"><span>(</span></span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="Canonicalization.html#Canonicalization.size.simps|fact"><span>size.simps</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Semantics/IRTreeEval.html#IRTreeEval.le_expr_def|fact"><span>le_expr_def</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>
  </span><span class="main"><span class="keyword3"><span>|</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="Canonicalization.html#Canonicalization.size.simps|fact"><span>size.simps</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>print_methods</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>
</span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>System</span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="entity"><span>RewriteSystem</span></span><span> </span><span class="main"><span>=</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>struct</span></span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>preservation</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>const</span></span><span> </span><a class="entity_ref" href="Canonicalization.html#Canonicalization.rewrite_preservation|const"><span>rewrite_preservation</span></a><span class="antiquote"><span>}</span></span></span><span class="main"><span>;</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>termination</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>const</span></span><span> </span><a class="entity_ref" href="Canonicalization.html#Canonicalization.rewrite_termination|const"><span>rewrite_termination</span></a><span class="antiquote"><span>}</span></span></span><span class="main"><span>;</span></span><span>
</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="entity"><span>intval</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>const</span></span><span> </span><a class="entity_ref" href="Canonicalization.html#Canonicalization.intval|const"><span>intval</span></a><span class="antiquote"><span>}</span></span></span><span class="main"><span>;</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>DSL</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>DSL_Rewrites</span></span><span class="main"><span>(</span></span><span class="entity"><span>System</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>val</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="entity"><span>Outer_Syntax.local_theory_to_proof</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span></span><span>‹</span><span class="keyword1"><span>optimization</span></span><span>›</span></span></span><span>
    </span><span class="inner_quoted"><span>"define an optimization and open proof obligation"</span></span><span>
    </span><span class="main"><span>(</span></span><span class="entity"><span>Parse_Spec.thm_name</span></span><span> </span><span class="inner_quoted"><span>":"</span></span><span> </span><span>--</span><span> </span><span>Parse.term</span><span>
        </span><span>&gt;&gt;</span><span> </span><span class="entity"><span>DSL.rewrite_cmd</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
</span><span>›</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span></pre>
</body>

</html>